./ ADD NAME=@AMODE   0100-01324-01324-1756-00057-00057-00000-DERU-S
*
*                     +--------+
*     Macro Name   -  ¦ @AMODE ¦
*                     +--------+
*
*     Function -
*              Switch AMODE from 24 to 31 or elseways
*
*     Syntax -
*              @AMODE {24/31}
*
*     Operation -
*
*     Author -
*          Name     :  Deru Sudibyo
*                      Technical Consultant
*                      Computer Associates
*                      Indonesia Office
*                      Wisma BNI-46 34th floor, BNI-46 City
*                      Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
*          Copyright:  (C)1998 Deru Sudibyo
*
*     Disclaimer -
*         This macro is developed as a personal support, and is
*         not a part of CA support matterials.  The purpose is as
*         a temporary solution or even just a sample.  Therefor,
*         further modifications and maintenance are client's
*         responsibilities.
*
*     Modification Log -
*     +--------+------------+--------+---------------------------+
*     ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
*     +--------+------------+--------+---------------------------+
*     ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     +--------+------------+--------+---------------------------+
*
         MACRO
&LABEL   @AMODE &BIT
         AIF   ('&BIT' EQ '31').AMODE31
         AIF   ('&BIT' EQ '24').AMODE24
         MNOTE 8,'DERAMD001E Invalid AMODE,.. Use 24 or 31'
         MEXIT
.AMODE24 ANOP
&LABEL   LA    15,*+6              Turn AMODE to 24 bit ...
         BSM   0,15                  due to GET macro restiction
         MEXIT
.AMODE31 ANOP
&LABEL   LA    15,*+10             Trun AMODE back ...
         O     15,=X'80000000'       to 31 bit ...
         BSM   0,15                  to void inconsistency
         MEND
./ ADD NAME=@DYNAMIC 0100-01324-01324-1756-00187-00187-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @DYNAMIC ¦
.*                    +----------+
.*
.*
.*    Function -
.*           Define data structure, map or memory content of SVC 99
.*           parameters, or update the existing one.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/16¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*********************************************************************
         MACRO
&NAME    @DYNAMIC &OP,             OPERATION - MODIFY, ALLOC, FREE ETC +
               &FUNCT=,            Function (ALLOC, DEALLOC ect)       +
               &LOC=,              Memory location (using label)       +
               &DSN=,              THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &GETDD=,            DDNAME returned after dynalloc      +
               &CLASS=,            (For sysout only)                   +
               &NOHOLD=,           (For sysout only)                   +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &DISP=,             DISP IF NORMAL EOJ, DISP=(OLD,KEEP) +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &SPACE=,            SPACE, I.E SPACE=(TRK,(2,1,80),RLSE)+
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &PREFIX=,           UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &RECFM=,            SPECIFY RECORD FORMAT               +
               &DSORG=,            SPECIFY DATASET ORGANIZATION        +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &DYNALLC=,          SPECIFY REQUEST TO execute SVC 99   +
               &EXTRB=,            SPECIFY REQUEST S99RBX              +
               &RECBUF=,           SPECIFY Record buffer               +
               &TOLFAIL=,          Specify tolairable error            +
               &ERRMSG=,           Display error msg                   +
               &TYPE=              SPECIFY TYPE OF MAP
         COPY  DERGBLVR
         LCLC  &S99
&S99     SETC  'NO'
         AIF   (T'&OP EQ 'O').UPDATE
         AIF   ('&OP' EQ 'ALLOC').EXEC
         AIF   ('&OP' EQ 'ALLOCATE').EXEC
         AIF   ('&OP' EQ 'DEALLOC').EXEC
         AIF   ('&OP' EQ 'DEALLOCATE').EXEC
         AIF   ('&OP' EQ 'FREE').EXEC
         AIF   ('&OP' EQ 'EXEC').EXEC
         AIF   ('&OP' EQ 'UPDATE').UPDATE
         AIF   ('&OP' EQ 'MODIFY').UPDATE
         AIF   ('&OP' EQ 'PARM').PARM
         AIF   ('&OP' EQ 'PARAMETER').PARM
         MNOTE 12,'DER008E Unknown operand &OP.'
         MEXIT
.PARM    ANOP
         AIF   (T'&FUNCT EQ 'O').ALLOC
         AIF   ('&FUNCT' EQ 'ALLOC').ALLOC
         AIF   ('&FUNCT' EQ 'ALLOCATE').ALLOC
         AIF   ('&FUNCT' EQ 'FREE').DEALLOC
         AIF   ('&FUNCT' EQ 'DEALLOC').DEALLOC
         AIF   ('&FUNCT' EQ 'DEALLOCATE').DEALLOC
         MNOTE 12,'DER008E Unknown operand FUNCTion=&FUNCT'
         MEXIT
.ALLOC   ANOP
&NAME    DERS99AL DSN=&DSN,                                            +
               DD=&DD,                                                 +
               GETDD=&GETDD,                                           +
               MEMBER=&MEMBER,                                         +
               DISP=&DISP,                                             +
               CDISP=&CDISP,                                           +
               SPACE=&SPACE,                                           +
               VOLSER=&VOLSER,                                         +
               UNIT=&UNIT,                                             +
               SYSOUT=&SYSOUT,                                         +
               FREE=&FREE,                                             +
               COPIES=&COPIES,                                         +
               LABEL=&LABEL,                                           +
               EXPDT=&EXPDT,                                           +
               RETPD=&RETPD,                                           +
               DUMMY=&DUMMY,                                           +
               BLKSIZE=&BLKSIZE,                                       +
               LRECL=&LRECL,                                           +
               RECFM=&RECFM,                                           +
               DSORG=&DSORG,                                           +
               FUNC=&FUNC,                                             +
               FORM=&FORM,                                             +
               PREFIX=&PREFIX,                                         +
               DCB=&DCB,                                               +
               SSREQ=&SSREQ,                                           +
               EXTRB=&EXTRB,                                           +
               RECBUF=&RECBUF,                                         +
               TYPE=&TYPE
         MEXIT
.DEALLOC ANOP
&NAME    DERS99FR DSN=&DSN,                                            +
               DD=&DD,                                                 +
               NOHOLD=&NOHOLD,            (For sysout only)            +
               CLASS=&CLASS,              (For sysout only)            +
               MEMBER=&MEMBER,                                         +
               DISP=&DISP,                                             +
               EXTRB=&EXTRB,                                           +
               PREFIX=&PREFIX,                                         +
               TYPE=&TYPE
         MEXIT
.EXEC    ANOP
&S99     SETC  'YES'
         AGO   .CALLS99
.UPDATE  AIF   (T'&DYNALLC EQ 'O').CALLS99
&S99     SETC  '&DYNALLC'
.CALLS99 ANOP
&NAME    DERS99MD LOC=&LOC,                                            +
               DSN=&DSN,                                               +
               DD=&DD,                                                 +
               GETDD=&GETDD,                                           +
               CLASS=&CLASS,              (For sysout only)            +
               MEMBER=&MEMBER,                                         +
               DISP=&DISP,                                             +
               CDISP=&CDISP,                                           +
               SPACE=&SPACE,                                           +
               VOLSER=&VOLSER,                                         +
               UNIT=&UNIT,                                             +
               SYSOUT=&SYSOUT,                                         +
               FREE=&FREE,                                             +
               COPIES=&COPIES,                                         +
               LABEL=&LABEL,                                           +
               EXPDT=&EXPDT,                                           +
               RETPD=&RETPD,                                           +
               DUMMY=&DUMMY,                                           +
               BLKSIZE=&BLKSIZE,                                       +
               LRECL=&LRECL,                                           +
               RECFM=&RECFM,                                           +
               DSORG=&DSORG,                                           +
               FUNC=&FUNC,                                             +
               FORM=&FORM,                                             +
               PREFIX=&PREFIX,                                         +
               DCB=&DCB,                                               +
               SVC99=&S99,                                             +
               TOLFAIL=&TOLFAIL,   Specify tolairable error            +
               ERRMSG=&ERRMSG,                                         +
               SSREQ=&SSREQ
         MEND
./ ADD NAME=@EDITDSN 0100-01324-01324-1756-00169-00169-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @EDITDSN ¦
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @EDITDSN &DSN=,                                               +
               &RCPID=,                                                +
               &RPTNAME=,                                              +
               &DSHLQ=CADS.XCOM,                                       +
               &DATE=,                                                 +
               &TIME=
         COPY  DERGBLVR
         LCLA  &LHQ,&LDATE,&LTIME
         LCLC  &GR,&Q,&X
&X       SETC  '&SYSNDX'
&LHQ     SETA  K'&DSHLQ
         AIF   (&LHQ LE 9).OKEY
&LHQ     SETA  9
.OKEY    ANOP
&Q       SETC  ''''
&LDATE   SETA  8
&LTIME   SETA  8
         STM   R0,R15,&DERSVGR
         MVI   &DERDSN,C' '
         MVC   &DERDSN+1(L'&DERDSN-1),&DERDSN
         MVC   &DERDSN.(&LHQ),=C'&DSHLQ'
         LA    R1,&DERDSN+&LHQ
         MVI   0(R1),C'.'
         LA    R1,1(,R1)
.*
.A       AIF   (T'&RCPID EQ 'O').ERRRCP
         AIF   ('&RCPID'(1,1) NE '(').A1
         MVC   0(8,R1),0&RCPID
         AGO   .B
.A1      AIF   ('&RCPID'(1,1) NE '&Q').A2
         MVC   0(8,R1),=CL8&RCPID
         AGO   .B
.A2      ANOP
         MVC   0(L'&RCPID,R1),&RCPID
.B       LA    R2,8
DER&X.A  LA    R1,1(,R1)
         CLI   0(R1),C' '
         BE    DER&X.B
         BCT   R2,DER&X.A
DER&X.B  MVI   0(R1),C'.'
         LA    R1,1(,R1)
.*
.C       AIF   (T'&RPTNAME EQ 'O').ERRRPT
         AIF   ('&RPTNAME'(1,1) NE '(').C1
         MVC   0(8,R1),0&RPTNAME
         AGO   .D
.C1      AIF   ('&RPTNAME'(1,1) NE '&Q').C2
         MVC   0(8,R1),=CL8&RPTNAME
         AGO   .D
.C2      ANOP
         MVC   0(L'&RPTNAME,R1),&RPTNAME
.D       LA    R2,8
DER&X.C  LA    R1,1(,R1)
         CLI   0(R1),C' '
         BE    DER&X.D
         BCT   R2,DER&X.C
DER&X.D  MVI   0(R1),C'.'
         LA    R1,1(,R1)
         AIF   (T'&DATE NE 'O').D1
&LDATE   SETA  6
         MVC   0(&LDATE,R1),&DERYDAT+2
         AGO   .E
.D1      ANOP
         AIF   ('&DATE'(1,1) NE '(').D2
         MVC   0(&LDATE,R1),0&DATE
         AGO   .E
.D2      AIF   ('&DATE'(1,1) NE '&Q').D3
         MVC   0(&LDATE,R1),=CL8&DATE
         AGO   .E
.D3      MVC   0(&LDATE,R1),&DATE
.E       ANOP
         MVI   0(R1),C'D'
         LA    R1,&LDATE.(,R1)
         MVI   0(R1),C'.'
         LA    R1,1(,R1)
.*
         AIF   (T'&TIME NE 'O').E1
         MVC   0(&LTIME,R1),&DERYTIM
         AGO   .F
.E1      AIF   ('&TIME'(1,1) NE '(').E2
         MVC   0(&LTIME,R1),0&TIME
         AGO   .F
.E2      AIF   ('&TIME'(1,1) NE '&Q').E3
         MVC   0(&LTIME,R1),=CL8&TIME
         AGO   .F
.E3      MVC   0(&LTIME,R1),&TIME
.F       ANOP
         MVI   0(R1),C'T'
         LA    R1,&LTIME.(,R1)
         AIF   (&LDATE NE 6).DSN
         MVI   0(R1),C'.'
         LA    R1,1(,R1)
         MVI   0(R1),C'C'
         LA    R1,1(,R1)
         L     R2,&DERDSNC                Dataset counter
         LA    R2,1(,R2)                  Incremented
         CH    R2,=H'999'                 Is ctr > 999 ?
         BNH   *+8                        No, skip resetting
         LH    R2,=H'1'                   Reset to 1
         ST    R2,&DERDSNC                Save again
         CVD   R2,&DERDBWD                Convert to decimal
         OI    &DERDBWD+7,X'0F'           Normalize sign
         UNPK  0(3,R1),&DERDBWD           Unpack
         LA    R1,3(,R1)
.DSN     ANOP
         AIF   (T'&DSN NE 'O').DS1
         LA    R1,&DERDSN
         L     R2,&DERSVGR+8
         AGO   .FINAL
.DS1     AIF   ('&DSN'(1,1) NE '(').DS2
&GR      SETC  '&DSN(1)'
         LM    R1,R2,&DERSVGR+4
         LA    &GR,&DERDSN
         AGO   .FINAL
.DS2     MVI   &DSN,C' '
         MVC   &DSN+1(43),&DSN
         MVC   &DSN,&DERDSN
.FINAL   ANOP
         MEXIT
.ERRRPT  MNOTE 8,'DER005E Required parameter RPTNAME is missing'
         MEXIT
.ERRRCP  MNOTE 8,'DER005E Required parameter RCPID is missing'
         MEND
./ ADD NAME=@EDITHDR 0100-01324-01324-1756-00196-00196-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  | @EDITHDR |
.*                    +----------+
.*
.*    Function -
.*        Build header of 1st and subsequent pages of Dispatch/PC
.*        format reports.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/20| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @EDITHDR &OP,                                                 +
               &LOC=*,                                                 +
               &BREG=2,                                                +
               &TYPE=,                                                 +
               &CODE=,                                                 +
               &DATE=,                                                 +
               &TIME=,                                                 +
               &RCPID=,                                                +
               &RPTNAME=,                                              +
               &PAGENUM=,                                              +
               &PAGECNT=,                                              +
               &LRECL=,                                                +
               &PREFIX=PH
         COPY  DERGBLVR
         LCLB  &USING,&NOTYPE,&NOP
         LCLC  &BASE,&PBASE,&P,&OPER,&Q,&NPG
&P       SETC  '&PREFIX'
&Q       SETC  ''''
&PBASE   SETC  '&P.DR'
&BASE    SETC  '&BREG'
         AIF   (T'&OP NE 'O').A1
&NOP     SETB  1
.A1      AIF   (T'&TYPE NE 'O').A2
&NOTYPE  SETB  1
.A2      AIF   (&NOP AND &NOTYPE).EXEC
         AIF   (&NOP).T001
&OPER    SETC  '&OP'
.T001    AIF   (&NOTYPE).T002
&OPER    SETC  '&TYPE'
.T002    AIF   ((NOT &NOP) AND                                         +
               (('&OP' EQ 'EXEC') OR                                   +
               ('&OP' EQ 'UPDATE') OR                                  +
               ('&OP' EQ 'MODIFY'))).EXEC
         AIF   (&NOP AND                                               +
               (('&TYPE' EQ 'EXEC') OR                                 +
               ('&TYPE' EQ 'UPDATE') OR                                +
               ('&TYPE' EQ 'MODIFY'))).EXEC
&NAME    DERDSPHD TYPE=&OPER,                                          +
               CODE=&CODE,                                             +
               PREFIX=&PREFIX,                                         +
               LRECL=&LRECL
         MEXIT
.EXEC    ANOP
&NAME    DS    0H
         STM   R0,R3,&DERSVGR
         AIF   ('&LOC' EQ '0').START
         AIF   ('&LOC' EQ '*').START
         AIF   ('&LOC'(1,1) EQ '(').LOCREG
&PBASE   SETC  '&LOC'
         AGO   .USING
.LOCREG  ANOP
&BASE    SETC  '&LOC'
.USING   ANOP
         LA    &BASE,&PBASE
         USING &PBASE,&BASE
&USING   SETB  1
.START   ANOP
.A       AIF   (T'&CODE EQ 'O').B
         AIF   ('&CODE'(1,1) EQ '&Q').A01
         MVC   &P.1CODE,=CL9'&CODE'
         AGO   .B
         MVC   &P.1CODE,=CL9&CODE
.B       AIF   (T'&DATE EQ 'O').C
         AIF   ('&DATE' NE 'INTERNAL').B00
         MVC   &P.2DATE,&DERDATE
         AGO   .C
.B00     AIF   ('&DATE'(1,1) EQ '(').B01
         AIF   ('&DATE'(1,1) EQ '&Q').B02
         MVC   &P.2DATE,&DATE
         AGO   .C
.B01     MVC   &P.2DATE,0&DATE
         AGO   .C
.B02     MVC   &P.2DATE,=C&DATE
.C       AIF   (T'&TIME EQ 'O').D
         AIF   ('&TIME' NE 'INTERNAL').C00
         MVC   &P.2TIME,&DERTIME
         AGO   .D
.C00     AIF   ('&TIME'(1,1) EQ '(').C01
         AIF   ('&TIME'(1,1) EQ '&Q').C02
         MVC   &P.2TIME,&TIME
         AGO   .D
.C01     MVC   &P.2TIME,0&TIME
         AGO   .D
.C02     MVC   &P.2TIME,=C&TIME
.D       AIF   (T'&RCPID EQ 'O').E
         AIF   ('&RCPID'(1,1) EQ '(').D01
         AIF   ('&RCPID'(1,1) EQ '&Q').D02
         MVC   &P.2RECP,&RCPID
         AGO   .E
.D01     MVC   &P.2RECP,0&RCPID
         AGO   .E
.D02     MVC   &P.2RECP,=C&RCPID
.E       AIF   (T'&RPTNAME EQ 'O').F
         AIF   ('&RPTNAME'(1,1) EQ '(').E01
         AIF   ('&RPTNAME'(1,1) EQ '&Q').E02
         MVC   &P.2RPTN,&RPTNAME
         AGO   .F
.E01     MVC   &P.2RPTN,0&RPTNAME
         AGO   .F
.E02     MVC   &P.2RPTN,=C&RPTNAME
.F       AIF   (T'&PAGENUM EQ 'O').G
         AIF   (N'&PAGENUM GE 2).F03
         AIF   ('&PAGENUM'(1,1) EQ '(').F01
         AIF   ('&PAGENUM'(1,1) EQ '&Q').F02
         MVC   &P.3PGN,&PAGENUM
         AGO   .G
.F01     MVC   &P.3PGN,0&PAGENUM
         AGO   .G
.F02     MVC   &P.3PGN,=C&PAGENUM
         AGO   .G
.F03     ANOP
&NPG     SETC  '&PAGENUM(2)'
         AIF   ('&PAGENUM(1)' EQ 'DEC').F04
         AIF   ('&PAGENUM(1)' EQ 'BIN').F05
         MNOTE 8,'DER010E &PAGENUM(1) invalid format. Use DEC or BIN.'
         AGO   .FINISH
.F04     OI    &NPG+L'&NPG-1,X'0F'
         UNPK  &P.3PGN,&NPG
         AGO   .G
.F05     L     R1,&NPG
         CVD   R1,&DERDBWD
         OI    &DERDBWD+7,X'0F'
         UNPK  &P.3PGN,&DERDBW
.G       AIF   (T'&PAGECNT EQ 'O').FINISH
         AIF   (N'&PAGECNT GE 2).G03
         AIF   ('&PAGECNT'(1,1) EQ '(').G01
         AIF   ('&PAGECNT'(1,1) EQ '&Q').G02
         MVC   &P.2PCNT,&PAGECNT
         AGO   .FINISH
.G01     MVC   &P.2PCNT,0&PAGECNT
         AGO   .FINISH
.G02     MVC   &P.2PCNT,=C&PAGECNT
         AGO   .FINISH
.G03     ANOP
&NPG     SETC  '&PAGECNT(2)'
         AIF   ('&PAGECNT(1)' EQ 'DEC').G04
         AIF   ('&PAGECNT(1)' EQ 'BIN').G05
         MNOTE 8,'DER010E &PAGECNT(1) invalid format. Use DEC or BIN.'
         AGO   .FINISH
.G04     OI    &NPG+L'&NPG-1,X'0F'
         UNPK  &P.2PCNT,&NPG
         AGO   .FINISH
.G05     L     R1,&NPG
         CVD   R1,&DERDBWD
         OI    &DERDBWD+7,X'0F'
         UNPK  &P.2PCNT,&DERDBW
.FINISH  AIF   (NOT &USING).EXIT
         DROP  &BASE
.EXIT    LM    R0,R3,&DERSVGR
         MEND
./ ADD NAME=@EDITTOD 0100-01324-01324-1756-00070-00070-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @EDITTOD ¦
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @EDITTOD &FORMAT=U
         COPY  DERGBLVR
         AIF   ('&FORMAT' EQ 'U').U
         AIF   ('&FORMAT' EQ 'UNIVERSAL').U
         AIF   ('&FORMAT' EQ 'J').J
         AIF   ('&FORMAT' EQ 'JULIAN').J
         AIF   ('&FORMAT' EQ 'B').B
         AIF   ('&FORMAT' EQ 'BOTH').B
         MNOTE 8,'DER001E &FORMAT invalid FORMAT parameter.'
         MEXIT
.U       ANOP
&NAME    DERTODUF
         LA    R1,&DERDATE
         MEXIT
.J       ANOP
&NAME    DERTODYF
         LA    R1,&DERYDAT
         MEXIT
.B       ANOP
&NAME    DERTODUF
         DERTODYF
         LA    R0,&DERYDAT
         LA    R1,&DERDATE
         MEND
./ ADD NAME=@EPILOG  0100-01324-01324-1756-00049-00049-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @EPILOG  ¦
.*                    +----------+
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @EPILOG &GLOBALV=YES,
               &MACLIST=,
               &COPLIST=
         COPY  DERGBLVR
./ ADD NAME=@EXIT    0100-01324-01324-1756-00088-00088-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @EXIT    ¦
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @EXIT &KEEPRC=YES
         COPY  DERGBLVR
         LCLB  &KRC
&NAME    DS    0H
         AIF   ('&KEEPRC' NE 'YES').SKIP
&KRC     SETB  1
         ST    R15,&DERWORD        Save RC
.SKIP    ANOP
         AIF   (NOT &DER390).ESA
         AIF   (NOT &DERSTOR).S390X
         LR    R2,R13
         STORAGE RELEASE,ADDR=(R2),LENGTH=&DERSVSZ
.S390X   AIF   (&KRC).S390RC
         LA    R15,0               Set RC=0
         PR                        Unstack states and return to MVS
         MEXIT
.S390RC  L     R15,&DERWORD
         PR                        Unstack states and return to MVS
         MEXIT
.ESA     AIF   (NOT &DERESA).S370
         LR    R2,R13
         L     R13,4(,R13)         OLD SA PTR
         AIF   (NOT &DERSTOR).ESAX
         STORAGE RELEASE,ADDR=(R2),LENGTH=&DERSVSZ
.ESAX    AIF   (NOT &KRC).ESAZ
         L     R15,&DERWORD
.ESAZ    LM    R0,R12,20(R13)      Restore REGs
         L     R14,12(,R13)
         BSM   0,R14
         MEXIT
.S370    ANOP
         LR    R2,R13
         L     R13,4(,R13)         OLD SA PTR
         AIF   (NOT &DERSTOR).S370X
         FREEMAIN R,A=(R2),LV=&DERSVSZ
.S370X   AIF   (&KRC).S370RC
         RETURN (14,12),RC=0       BACK TO MVS
         MEXIT
.S370RC  ANOP
         L     R15,&DERWORD
         RETURN (14,12),RC=(15)   BACK TO MVS
         MEND
./ ADD NAME=@FLATDS  0100-01324-01324-1756-00069-00069-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @FLATDS  ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Flat dataset file definition
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   @FLATDS &BLKSIZE=6233,&LRECL=150,&SPACE=(CYL,(50,5),RLSE),    +
               &VOLUNIT=3390,&DDNAME=LCLDS01,&ABNDISP=KEEP
         COPY  DERGBLVR
ALFLATDS @S99PARM ALLOC,                  Define Flat file alloc parm  +
               TYPE=DATA,                 Map type is memory data      +
               PREFIX=F,                  Use prefix F --> FRBxxxx     +
               EXTRB=YES,                 Request S99RBX               +
               DD=&DDNAME,                DD name is LCLDS01           +
               DSN='CADS.XCOM.SAMPLE.DATA',  Predefine DSN             +
               DSORG=PS,RECFM=VB,            DCB:                      +
               BLKSIZE=&BLKSIZE,LRECL=&LRECL,                          +
               SPACE=&SPACE,                 Specify space for new     +
               UNIT=&VOLUNIT,                 dataset in this unit of  +
               DISP=(NEW,CATLG),          Use this disposition and     +
               RECBUF=YES,                Generate record buffer       +
               FREE=CLOSE,                Deallocate at close          +
               CDISP=&ABNDISP             What to do if job abend
UNFLATDS @S99PARM FREE,                   Define Flatfile dealloc parm +
               TYPE=DATA,                 Map type is memory data      +
               EXTRB=YES,                 Request S99RBX               +
               PREFIX=U,                  Use prefix U --> URBxxxx     +
               DD=&DDNAME                 DD name is LCLDS01
         MEND
./ ADD NAME=@MESSAGE 0100-01324-01324-1756-00160-00160-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  | @MESSAGE |
.*                    +----------+
.*
.*    Function -
.*           Routes any error, warning or informational messages
.*           to operator consoles.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/20| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @MESSAGE &MSG,                                                +
               &OPER=,                                                 +
               &TYPE=,                                                 +
               &OBJECT=,                                               +
               &OPCODE=B,                                              +
               &ROUTCDE=,                                              +
               &TEXT=,                                                 +
               &RC=,                                                   +
               &MF=,                                                   +
               &EXIT=
         COPY  DERGBLVR
         LCLC  &P,&PFX,&S,&X
&P       SETC  '&DERMID'
&X       SETC  'DER&SYSNDX'
&S       SETC  'I'
         AIF   (T'&MSG EQ 'O').OPER
         AIF   ('&MSG' EQ 'INFO').OPER
         AIF   ('&MSG' NE 'WARNING').MSG1
&S       SETC  'W'
         AGO   .OPER
.MSG1    AIF   ('&MSG' NE 'ERROR').MSG2
&S       SETC  'E'
         AGO   .OPER
.MSG2    MNOTE 4,'DER026W &MSG ignored for NOP operation.'
         AGO   .EXIT
.OPER    ANOP
&NAME    &OPCODE &X.A
         B     &X.Z
&X.A     EQU   *
         AIF   (T'&OPER EQ 'O').NOP
         AIF   ('&OPER' EQ 'DYNALLOC').SVC99
         AIF   ('&OPER' EQ 'SVC99').SVC99
         AIF   ('&OPER' EQ 'FIND').FIND
         AIF   ('&OPER' EQ 'IO').IO
         AIF   ('&OPER' EQ 'SSREQ').SSREQ
         AIF   ('&OPER' EQ 'SHOW').SHOW
         AIF   ('&OPER' EQ 'LIST').LIST
         MNOTE 8,'DER025E &OPER invalid parameter.'
         AGO   .EXIT
.NOP     ANOP
.*
.* DERWTR001I &OBJECT completed
.* DERWTR002W &OBJECT was not completed, RC=cccc
.* DERWTR003E &OBJECT error, RC=cccc
.*
&PFX     SETC   '&P.00'
         DEREDTMS &PFX,&S,OBJECT=&OBJECT,RC=&RC,ROUTCDE=&ROUTCDE,      +
               TYPE=&TYPE
         AGO   .FINISH
.SVC99   ANOP
.*
.* DERWTR011I SVC 99 &TYPE of &OBJECT completed
.* DERWTR012W SVC 99 &TYPE of &OBJECT was not completed, EC=cc, IC=ii
.* DERWTR013E SVC 99 &TYPE of &OBJECT error, RC=cccc, IC=iiii
.*
&PFX     SETC   '&P.01'
         AGO    .EDIT
.FIND    ANOP
.*
.* DERWTR021I &OBJECT found
.* DERWTR022W &OBJECT can not be found, RC=cccc
.* DERWTR023E &OBJECT error, RC=cccc
.*
&PFX     SETC   '&P.02'
         AGO    .EDIT
.IO      ANOP
.*
.* DERWTR031I &TYPE of file &OBJECT completed
.* DERWTR032W Unable to &TYPE file &OBJECT, RC=cccc
.* DERWTR033E Error encountered during &TYPE file &OBJECT, RC=cccc
.*
&PFX     SETC   '&P.03'
         AGO    .EDIT
.SSREQ   ANOP
.*
.* DERWTR041I &OBJECT found. &TYPE subsystem request completed
.* DERWTR042W &OBJECT was not found. &TYPE subsystem returned RC=cccc
.* DERWTR043E Request rejected. &TYPE subsystem returned RC=cccc
.*
&PFX     SETC   '&P.04'
         AGO    .EDIT
.SHOW    ANOP
.*
.* DERWTR051I &TYPE is &OBJECT and it is &TEXT
.*
&PFX     SETC   '&P.05'
         AGO    .EDIT
.LIST    ANOP
.*
.* DERWTR061I &TYPE &OBJECT &TEXT
.*
&PFX     SETC   '&P.06'
         AGO    .EDIT
.EDIT    ANOP
&NAME    DEREDTMS &PFX,&S,                                             +
               TYPE=&TYPE,                                             +
               OBJECT=&OBJECT,                                         +
               ROUTCDE=&ROUTCDE,                                       +
               TEXT=&TEXT,                                             +
               RC=&RC
         AGO   .FINISH
.FINISH  ANOP
         AIF   (T'&EXIT EQ 'O').END
         AIF   ('&EXIT' EQ '*').END
         AIF   ('&EXIT'(1,1) EQ '(').ENDR
         L     15,=A(&EXIT)
         BR    15
         AGO   .END
.ENDR    BR    &EXIT(1)
.END     ANOP
         DS    0H
&X.Z     EQU   *
.EXIT    ANOP
         MEND
./ ADD NAME=@PROLOG  0100-01324-01324-1756-00172-00172-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @PROLOG  ¦
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @PROLOG &ESA=390,         390, 370 or NO (means S/370)        ++
               &AMODE=ANY,                                             ++
               &RMODE=ANY,                                             ++
               &RENT=YES,                                              ++
               &EXECUTE=YES,                                           ++
               &EP=,                                                   ++
               &SVASIZE=90,                                            ++
               &BREG=R12
         COPY  DERGBLVR
         LCLA  &NBR,&I
         LCLC  &BR1,&BR2,&BR3,&ENTRY,&BRLINK,&IX
&BRLINK  SETC  'BASR'
&IX      SETC  '&SYSNDX'
&DERSVSZ SETA  &SVASIZE
&NBR     SETA  N'&BREG
&BR1     SETC  '&BREG(1)'
         AIF   (('&RENT' NE 'Y') AND ('&RENT' NE 'YES')).BEGIN
&DERRENT SETB  1
.BEGIN   AIF   (T'&NAME NE 'O').A
         MNOTE 8,'DER041E Label missing. Unable to define module name.'
         MEXIT
.A       AIF   (K'&NAME LE 8).B
         MNOTE 8,'DER042E Module name exceeded (max 8 bytes).'
         MEXIT
.B       AIF   (&NBR LE 3).C
         MNOTE 8,'DER043E Number of base registers exceeded (max 3).'
         MEXIT
.C       AIF   (&DEREQU).D
&I       SETA  0
.LOOPEQU ANOP
A&I      EQU   &I
C&I      EQU   &I
R&I      EQU   &I
&I       SETA  &I+1
         AIF   (&I LE 15).LOOPEQU
F0       EQU   0
F2       EQU   2
F4       EQU   4
F6       EQU   6
.D       AIF   (K'&NAME LT 6).D1
&DERMID  SETC  '&NAME'(1,6)
         AGO   .D2
.D1      ANOP
&DERMID  SETC  '&NAME'
.D2      ANOP
&ENTRY   SETC  '&NAME'
&NAME    AMODE &AMODE
&NAME    RMODE &RMODE
&NAME    CSECT
          AIF   ('&ESA' NE '390').ESA370
&DER390   SETB  1
&DERESA   SETB  1
          BAKR  R14,0          Stack states
.E        USING &NAME,R15
          B     DER&SYSNDX
          DC    C'(C)1998 Ir. DERU SUDIBYO -'
          DC    C'&NAME &SYSDATE &SYSTIME'
DER&IX    DS   0D
          DROP  R15
          AIF   (T'&EP EQ 'O').E1
&ENTRY    SETC  '&EP'
          &BRLINK &BR1,0
&ENTRY    EQU   *
          AGO   .E2
.E1       LR    &BR1,R15       Copy base address
.E2       AIF   (&NBR EQ 1).E4
&BR2      SETC  '&BREG(2)'
          AIF   (&NBR EQ 2).E3
&BR3      SETC  '&BREG(3)'
          USING &ENTRY,&BR1,&BR2,&BR3
          LA    R15,4095
          LA    &BR2,1(R15,&BR1)
          LA    &BR3,1(R15,&BR2)
          AGO   .F
.E3       USING &ENTRY,&BR1,&BR2
          LA    R15,4095
          LA    &BR2,1(R15,&BR1)
          AGO   .F
.E4       USING &ENTRY,&BR1
.F        AGO   .SVA
.ESA370   AIF   ('&ESA' NE '370').NONESA
&DERESA   SETB  1
&BRLINK   SETC  'BASR'
&BRLINKS  SETC  'BAS'
          AGO   .SAVING
.NONESA   ANOP
&BRLINK   SETC  'BALR'
&BRLINK   SETC  'BAL'
.SAVING   STM   R14,R12,12(R13)
          AGO   .E
.SVA      AIF   (&DERRENT).STORAGE
          AIF   (&DER390).FINAL
          &BRLINKS R1,DER&IX.B
          DS    0D
DER&IX.A  DC    XL&DERSVSZ
DER&IX.B  EQU   *
          AGO   .HSKEEP
.STORAGE  AIF   (&DERESA).ESA
          GETMAIN R,LV=&DERSVSZ
          AGO   .HSKEEP
.ESA      STORAGE OBTAIN,COND=NO,LENGTH=&DERSVSZ
.HSKEEP   ST    R13,4(,R1)          Old in new
          L     R15,24(,R13)        Restore parmlist address
          ST    R1,8(,R13)          New in old
          LR    R13,R1              Chain
          LR    R1,R15              Keep parmlist address in GR 1
&DERSTOR  SETB  1
.FINAL    ANOP
&DERDSN   SETC  'DER&IX._DSN'
&DERDSNC  SETC  'DER&IX._DSN_COUNTER'
&DERDATE  SETC  'DER&IX._DATE'
&DERTIME  SETC  'DER&IX._TIME'
&DERYDAT  SETC  'DER&IX._YDATE'
&DERYTIM  SETC  'DER&IX._YTIME'
&DERSVGR  SETC  'DER&IX._SVGR'
&DERSVAR  SETC  'DER&IX._SVAR'
&DERWTOL  SETC  'DER&IX._WTO'
&DEROPNL  SETC  'DER&IX._OPEN'
&DERCLSL  SETC  'DER&IX._CLOSE'
&DERMSGL  SETC  'DER&IX._MSG'
&DERTMEL  SETC  'DER&IX._TIMEL'
&DEREDTL  SETC  'DER&IX._EDIT'
&DERWORD  SETC  'DER&IX._WORD'
&DERDBWD  SETC  'DER&IX._DWORD'
&DERWORK  SETC  'DER&IX._WORK'
          MEND
./ ADD NAME=@SYSOUT  0100-01324-01324-1756-00063-00063-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @SYSOUT  ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Sysout file definition
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   @SYSOUT &JESNAME=JES2,&DDNAME=JES2FILE
         COPY  DERGBLVR
ALSYSOUT @S99PARM ALLOC,                  Define SYSOUT alloc parm     +
               TYPE=DATA,                 Map type is memory data      +
               SSREQ=&JESNAME,            Request JES2 dataset         +
               EXTRB=YES,                 Request S99RBX               +
               PREFIX=A,                  Use prefix A --> ARBxxxx     +
               DISP=(OLD,DELETE),         Use disp. delete             +
               DD=&DDNAME,                and DD name is JES2FILE      +
               DSN='SYSOUT.DATA.SET'      DSN is just to init field
UNSYSOUT @S99PARM DEALLOC,                Define SYSOUT dealloc parm   +
               TYPE=DATA,                 Map type is memory data      +
               PREFIX=D,                  Use prefix D --> DRBxxx      +
               DISP=DELETE,               Override disposition DELETE  +
               EXTRB=YES,                 Request S99RBX               +
               DD=&DDNAME                 and DD name is JES2FILE
         MEND
./ ADD NAME=@VDATA   0100-01324-01324-1756-00057-00057-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ @VDATA ¦
.*                    +----------+
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @VDATA
         COPY  DERGBLVR
         LCLA  &I,&J
&I       SETA  1
&J       SETA  &DERCTR
.LOOP    AIF   (&J EQ 0).EXIT
&DERVLBL(&I) &DERVOPC(&I) &DERVDAT(&I)
&I       SETA  &I+1
&J       SETA  &J-1
         AGO   .LOOP
.EXIT    ANOP
         MEND
./ ADD NAME=@VGLOBAL 0100-01324-01324-1756-00068-00068-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ @VGLOBAL ¦
.*                    +----------+
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @VGLOBAL
         COPY  DERGBLVR
         DS    0D
&DERSVGR DC    XL80'00'
&DERSVAR DC    XL80'00'
&DERDBWD DC    D'0'
&DERWORD DC    F'0'
&DERTMEL TIME  LINKAGE=SYSTEM,MF=L
&DERWTOL WTO   TEXT=&DERWORK,MF=L
&DEROPNL OPEN  (,),MF=L
&DERCLSL CLOSE (,),MF=L
         DS    0D
&DERMSGL DC    XL160'00'
&DEREDTL DC    XL80'00'
*
&DERDSN  DC    CL44' '
&DERDSNC DC    F'0'
&DERDATE DC    CL8'YY/MM/DD'
&DERTIME DC    CL8'HH:MM:SS'
&DERYDAT DC    CL8' YYYYDDD'
&DERYTIM DC    CL8' HHMMSS'
&DERWORK DC    CL80' '
         MEND
./ ADD NAME=@WTO     0100-01324-01324-1756-00068-00068-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @WTO     ¦
.*                    +----------+
.*
.*
.*    Function -
.*               Issue WTO message
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/03/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    @WTO  &CODE=,&TFLAGS=WSOFLAGS,&TBIT=WSOFTRAC,&REG=R2,         +
               &PREFIX=WSMSG,&TRACE=CHECK
         COPY  DERGBLVR
         LCLC  &LMSG,&LBL
&LMSG    SETC  '&PREFIX&CODE'
&LBL     SETC  'DER&SYSNDX'
         AIF   (T'&CODE NE 'O').GO
         MNOTE 12,'DER001E Parameter message code missing.'
         MEXIT
.GO      AIF   ('&TRACE' EQ 'ALWAYS').TRACE
&NAME    TM    &TFLAGS,&TBIT
         BZ    &LBL.X
         ST    &REG,&DERSVGR
         AGO   .NSI
.TRACE   ANOP
&NAME    ST    &REG,&DERSVGR
.NSI     L     &REG,&LMSG
         MVC   4(6,&REG),=CL6'&DERMID'
         WTO   MF=(E,(&REG))
         L     &REG,&DERSVGR
&LBL.X   EQU   *
         MEND
./ ADD NAME=@XCOMJOB 0100-01324-01324-1756-00343-00343-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  | @XCOMJOB |
.*                    +----------+
.*
.*    Function -
.*            Define data structure, map or update an in-memory JCL
.*            to execute XCOMJOB program.
.*
.*    Syntax -
.*
.*     EXEC:
.*       Label @XCOMJOB EXEC,
.*                     BREG={2/<Any GR 2-12>},
.*                     LOC=<{XCJOB/<any label>/<(register)>},
.*                     RCPID=<Recipient-ID in (GR), string or label>,
.*                     RPTNAME=<Report-ID in (GR), string or label>,
.*                     JOBNUM=<Jobnumber in (GR), string or label>,
.*                     PREFIX={XC/<Any 1-2 alphameric>}
.*
.*     Map:
.*       Label &XCOMJOB {DSECT/CSECT/COM/DATA},
.*                     DISP=({OLD/SHR},{DELETE/KEEP}),
.*                     CLASS=<Any valid job class>,
.*                     MCLASS=<Any valid sysout class>,
.*                     MLEVEL=<Any valid (1/0,1/0)>,
.*                     PREFIX={XC/<Any 1-2 alphameric>}
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/16| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   @XCOMJOB &OP,&PREFIX=XC,&DISP=,&CLASS=A,                      +
               &MCLASS=X,&MLEVEL=(0,0),&JOBNUM=,&DSN=,&RCPID=,         +
               &LOC=*,&TIME=,&TYPE=,&SUBMIT=INTERNAL,&PCDRIVE='F',     +
               &STEPLIB=,&CAILIB=,&GLOBLIB=,&RESTLIB=,&CNTLLIB=,       +
               &RPTNAME=,&JOBPARM=,&BREG=2,&EXTTYPE=
         COPY  DERGBLVR
         LCLA  &L
         LCLB  &USING,&DS,&NOP,&NOTYPE,&BLD,&RUN
         LCLC  &RCP,&RPT,&P,&PBASE,&BASE,&Q,&OPER,mLBL,&PCDRV
&P       SETC  '&PREFIX'
&PBASE   SETC  '&P.JOB'
&BASE    SETC  '&BREG'
&Q       SETC  ''''
&LBL     SETC  'DER&SYSNDX'
&PCDRV   SETC  '&PCDRIVE'
         AIF   ('&PCDRIVE'(1,1) NE '&Q').A0
&PCDRV   SETC  '&PCDRIVE'(2,1)
.A0      AIF   (T'&OP NE 'O').A1
&NOP     SETB  1
.A1      AIF   (T'&TYPE NE 'O').A2
&NOTYPE  SETB  1
.A2      AIF   (&NOP AND &NOTYPE).EXEC
         AIF   (&NOP).T001
&OPER    SETC  '&OP'
.T001    AIF   (&NOTYPE).T002
&OPER    SETC  '&TYPE'
.T002    AIF   ((NOT &NOP) AND                                         +
               (('&OP' EQ 'EXEC') OR                                   +
               ('&OP' EQ 'BUILD') OR                                   +
               ('&OP' EQ 'UPDATE') OR                                  +
               ('&OP' EQ 'MODIFY'))).EXEC
         AIF   ((&NOP) AND                                             +
               (('&TYPE' EQ 'EXEC') OR                                 +
               ('&TYPE' EQ 'BUILD') OR                                 +
               ('&TYPE' EQ 'UPDATE') OR                                +
               ('&TYPE' EQ 'MODIFY'))).EXEC
&LABEL   DERXCJOB TYPE=&OPER,PREFIX=&PREFIX,DISP=&DISP,CLASS=&CLASS,   +
               MCLASS=&MCLASS,MLEVEL=&MLEVEL,PCDRIVE=&PCDRV,           +
               STEPLIB=&STEPLIB,CAILIB=&CAILIB,GLOBLIB=&GLOBLIB,       +
               RESTLIB=&RESTLIB,CNTLLIB=&CNTLLIB
         AGO   .FINISH
.EXEC    AIF   ('&TYPE' NE 'BUILD').EXECGO
&BLD     SETB  1
.EXECGO  ANOP
&RUN     SETB  1
&LABEL   DS    0H
         STM   R0,R15,&DERSVGR
         AIF   ('&LOC' EQ '0').START
         AIF   ('&LOC' EQ '*').START
         AIF   ('&LOC'(1,1) EQ '(').LOCREG
&PBASE   SETC  '&LOC'
         AGO   .USING
.LOCREG  ANOP
&BASE    SETC  '&LOC'
.USING   ANOP
         LA    &BASE,&PBASE
         USING &PBASE,&BASE
&USING   SETB  1
.START   AIF   (T'&DSN EQ 'O').START1
&DS      SETB  1
         MVI   &P.JDSN,C' '
         MVC   &P.JDSN+1(L'&P.JDSN-1),&P.JDSN
         AIF   ('&DSN'(1,1) NE '(').DS1
         MVC   &P.JDSN(L'&P.JDSN),0&DSN
         AGO   .START1
.DS1     AIF   ('&DSN'(1,1) NE '&Q').DS2
         MVC   &P.JDSN,=CL(L'&P.JDSN)&DSN
         AGO   .START1
.DS2     ANOP
         MVC   &P.JDSN(L'&P.JDSN),&DSN
.START1  AIF   (T'&RCPID NE 'O').CHK001
         AIF   (NOT &BLD).CONT001
.*       MNOTE 8,'DER005E Required parameter RCPID is missing'
         AGO   .CONT001
.CHK001  ANOP
         CLC   =C'GROUP=',&P.GROUP
         BNE   &LBL.A
         AIF   ('&RCPID'(1,1) NE '(').CHK002
         MVC   &P.JDEST,0&RCPID
&LBL.A   MVC   &P.JNAME,0&RCPID
         MVC   &P.JRECID,0&RCPID
         AIF   (&DS).CONT001
         MVC   &P.JDSQK,0&RCPID
         AGO   .CONT001
.CHK002  AIF   ('&RCPID'(1,1) NE '&Q').CHK003
         MVC   &P.JDEST,=C&RCPID
&LBL.A   MVC   &P.JNAME,=C&RCPID
         MVC   &P.JRECID,=C&RCPID
         AIF   (&DS).CONT001
         MVC   &P.JDSQK,=C&RCPID
         AGO   .CONT001
.CHK003  ANOP
         MVC   &P.JDEST,&RCPID
&LBL.A   MVC   &P.JNAME,&RCPID
         MVC   &P.JRECID,&RCPID
         AIF   (&DS).CONT001
         MVC   &P.JDSQK,&RCPID
.CONT001 AIF   (T'&RPTNAME NE 'O').CHK011
         AIF   (NOT &BLD).CONT002
.*       MNOTE 8,'DER005E Required parameter RPTNAME is missing'
         AGO   .CONT002
.CHK011  ANOP
         MVI   &P.JRNAME,C' '
         MVC   &P.JRNAME+1(L'&P.JRNAME-1),&P.JRNAME
         AIF   ('&RPTNAME'(1,1) NE '(').CHK012
         MVC   &P.JRNAME(8),0&RPTNAME
         MVC   &P.JPRGN,0&RPTNAME
         AIF   (&DS).CONT002
         MVC   &P.JDSQR,0&RPTNAME
         AGO   .CONT002
.CHK012  AIF   ('&RPTNAME'(1,1) NE '&Q').CHK013
         MVC   &P.JRNAME(8),=C&RPTNAME
         MVC   &P.JPRGN,=C&RPTNAME
         AIF   (&DS).CONT002
         MVC   &P.JDSQR,=C&RPTNAME
         AGO   .CONT002
.CHK013  ANOP
         MVC   &P.JRNAME(L'&RPTNAME),&RPTNAME
         MVC   &P.JPRGN,&RPTNAME
         AIF   (&DS).CONT002
         MVC   &P.JDSQR,&RPTNAME
.CONT002 AIF   (T'&JOBNUM NE 'O').CHK021
         AIF   (NOT &BLD).CONT003
         MVC   &P.JNUM,=CL6'OMJOB'
         AGO   .CONT003
.CHK021  AIF   ('&JOBNUM'(1,1) NE '(').CHK022
         MVC   &P.JNUM,0&JOBNUM
         AGO   .CONT003
.CHK022  AIF   ('&JOBNUM'(1,1) NE '&Q').CHK023
         MVC   &P.JNUM,=C&JOBNUM
         AGO   .CONT003
.CHK023  ANOP
         MVC   &P.JNUM,&JOBNUM
.CONT003 AIF   (&DS).STEPLIB
         AIF   (T'&TIME EQ 'O').GBLTIME
         AIF   ('&TIME' EQ 'INSTANT').IMMED
         AIF   ('&TIME' EQ 'IMMED').IMMED
         AIF   ('&TIME' EQ 'NOW').IMMED
.GBLTIME ANOP
         AIF   (NOT &BLD).STEPLIB
         MVC   &P.JDSQD,&DERYDAT
         MVI   &P.JDSQD,C'D'
         MVC   &P.JDSQT,&DERYDAT
         MVI   &P.JDSQT,C'T'
         AGO   .STEPLIB
.IMMED   ANOP
         XC    &P.TIME(16),&P.TIME
         TIME  DEC,&P.TIME,LINKAGE=SYSTEM,                             +
               DATETYPE=YYYYDDD,MF=(E,&DERTMEL)
         ST    2,&P.ZERO
         L     2,&P.TIME
         SRL   2,4
         ST    2,&P.TIME
         L     2,&P.DATE
         SLL   2,4
         ST    2,&P.DATE
         OI    &P.TIME+L'&P.TIME-1,X'0F'  Make sure sign is F
         OI    &P.DATE+L'&P.DATE-1,X'0F'   and also here
         UNPK  &P.JDSQT,&P.TIME           Unpack time and date
         UNPK  &P.JDSQD,&P.DATE            into EBCDIC characters
.STEPLIB AIF   (T'&STEPLIB EQ 'O').CAILIB
         MVI   &P.JSLIB,C' '
         MVC   &P.JSLIB+1(L'&P.JSLIB-1),&P.JSLIB
         AIF   ('&STEPLIB'(1,1) EQ '&Q').ST01
         AIF   ('&STEPLIB'(1,1) EQ '(').ST02
         MVC   &P.JSLIB(L'&STEPLIB),&STEPLIB
         AGO   .CAILIB
.ST01    MVC   &P.JSLIB(K'&STEPLIB-2),=C&STEPLIB
         AGO   .CAILIB
.ST02    MVC   &P.JSLIB,0&STEPLIB
.CAILIB  AIF   (T'&CAILIB EQ 'O').GLOBLIB
         MVI   &P.JSLIB1,C' '
         MVC   &P.JSLIB1+1(L'&P.JSLIB1-1),&P.JSLIB1
         AIF   ('&CAILIB'(1,1) EQ '&Q').CA01
         AIF   ('&CAILIB'(1,1) EQ '(').CA02
         MVC   &P.JSLIB1(L'&CAILIB),&CAILIB
         AGO   .GLOBLIB
.CA01    MVC   &P.JSLIB1(K'&CAILIB-2),=C&CAILIB
         AGO   .GLOBLIB
.CA02    MVC   &P.JSLIB1,0&CAILIB
.GLOBLIB AIF   (T'&GLOBLIB EQ 'O').CNTLLIB
         MVI   &P.JXGLOB,C' '
         MVC   &P.JXGLOB+1(L'&P.JXGLOB-1),&P.JXGLOB
         AIF   ('&GLOBLIB'(1,1) EQ '&Q').GL01
         AIF   ('&GLOBLIB'(1,1) EQ '(').GL02
         MVC   &P.JXGLOB(L'&GLOBLIB),&GLOBLIB
         AGO   .CNTLLIB
.GL01    MVC   &P.JXGLOB(K'&GLOBLIB-2),=C&GLOBLIB
         AGO   .CNTLLIB
.GL02    MVC   &P.JXGLOB,0&GLOBLIB
.CNTLLIB AIF   (T'&CNTLLIB EQ 'O').RESTLIB
         MVI   &P.JXCNTL,C' '
         MVC   &P.JXCNTL+1(L'&P.JXCNTL-1),&P.JXCNTL
         AIF   ('&CNTLLIB'(1,1) EQ '&Q').CN01
         AIF   ('&CNTLLIB'(1,1) EQ '(').CN02
         MVC   &P.JXCNTL(L'&CNTLLIB),&CNTLLIB
         AGO   .RESTLIB
.CN01    MVC   &P.JXCNTL(K'&CNTLLIB-2),=C&CNTLLIB
         AGO   .RESTLIB
.CN02    MVC   &P.JXCNTL,0&CNTLLIB
.RESTLIB AIF   (T'&RESTLIB EQ 'O').DISP
         MVI   &P.JXREST,C' '
         MVC   &P.JXREST+1(L'&P.JXREST-1),&P.JXREST
         AIF   ('&RESTLIB'(1,1) EQ '&Q').RS01
         AIF   ('&RESTLIB'(1,1) EQ '(').RS02
         MVC   &P.JXREST(L'&RESTLIB),&RESTLIB
         AGO   .DISP
.RS01    MVC   &P.JXREST(K'&RESTLIB-2),=C&RESTLIB
         AGO   .DISP
.RS02    MVC   &P.JXREST,0&RESTLIB
.DISP    AIF   (T'&DISP EQ 'O').SUBMIT
&L       SETA  K'&DISP
         MVI   &P.JDISP,C' '
         MVC   &P.JDISP+1(L'&P.JDISP-1),&P.JDISP
         AIF   ('&DISP'(1,1) EQ '&Q').DI01
         MVC   &P.JDISP(L'&DISP),&DISP
         MVI   &P.JDISP+L'&DISP,C','
         AGO   .SUBMIT
.DI01    MVC   &P.JDISP(&L-2),=C&DISP
         MVI   &P.JDISP+&L-2,C','
.SUBMIT  AIF   ('&SUBMIT' EQ 'INTERNAL').SUBI
         AIF   ('&SUBMIT' EQ 'EXTERNAL').SUBX
         AGO   .PARM
.SUBI    MVC   &P.JLFILE,&P.JDSN
         MVI   &P.J11,C'L'
         LA    R1,&P.PARM
         AGO   .PARM
.SUBX    MVI   &P.J11,C'*'
.PARM    AIF   (T'&JOBPARM EQ 'O').HDD
         MVI   &P.JPARM,C' '
         MVC   &P.JPARM+1(L'&P.JPARM-1),&P.JPARM
         AIF   ('&JOBPARM'(1,1) EQ '&Q').PARMQ
         AIF   ('&JOBPARM'(1,1) EQ '(').PARMR
         MVC   &P.JPARM,&JOBPARM
         AGO   .HDD
.PARMR   MVC   &P.JPARM,0&JOBPARM
         AGO   .HDD
.PARMQ   MVC   &P.JPARM,=C'''&JOBPARM'''
.HDD     AIF   ('&PCDRIVE'(1,1) EQ '&Q').HDDQ
         AIF   ('&PCDRIVE'(1,1) EQ '(').HDDR
         MVC   &P.JDRIVE,&PCDRIVE
         AGO   .EXT
.HDDQ    MVC   &P.JDRIVE,C&PCDRIVE
         AGO   .EXT
.HDDR    MVC   &P.JDRIVE,0&PCDRIVE
.EXT     AIF   (T'&EXTTYPE EQ 'O').FINISH
         LA    R2,&P.JRNAME
         LA    R3,L'&P.JRNAME
         LA    R4,9
&LBL.B   CLI   0(R2),C' '
         BE    &LBL.C
         LA    R2,1(R2)
         BCTR  R3,0
         BCT   R4,&LBL.B
&LBL.C   MVI   0(R2),C'.'
         LA    R2,1(R2)
         AIF   ('&EXTTYPE'(1,1) EQ '&Q').EXTQ
         AIF   ('&EXTTYPE'(1,1) EQ '(').EXTR
         LA    R4,&EXTTYPE
         LA    R3,L'&EXTTYPE
         AGO   .EXTGET
.EXTQ    LA    R4,=C&EXTTYPE
&L       SETA  K'&EXTTYPE-2
         LA    R3,&L
         AGO   .EXTGET
.EXTR    LR    R4,&EXTTYPE(1)
.EXTGET  ANOP
&LBL.D   CLI   0(R4),C' '
         BE    &LBL.E
         MVC   0(1,R2),0(R4)
         LA    R2,1(R2)
         LA    R4,1(R4)
         BCT   R3,&LBL.D
&LBL.E   EQU   *
.FINISH  AIF   (NOT &USING).RETURN
         DROP  &BASE
.RETURN  AIF   (NOT &RUN).EXIT
         L     R0,&DERSVGR
         LM    R2,R15,&DERSVGR+8
.EXIT    ANOP
         MEND
./ ADD NAME=@XDIREF  0100-01324-01324-1756-00129-00129-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ @XDIREF  ¦
.*                    +----------+
.*
.*
.*    Function -
.*             XDI Storage Reference
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   @XDIREF &ENTRY,&TYPE=CSECT,&AMODE=31,&RMODE=ANY,&PRINT=NOGEN, +
               &XJCLASS=T,&XMCLASS=T,&XMLEVEL=(1,1),&XDISP=(OLD,KEEP), +
               &DSPCODE=YYEDSPC10,&PCROOT=DISPATCH
         COPY  DERGBLVR
         GBLB  &WTXTYPE,&WTXSTRT
         AIF   (T'&ENTRY EQ 'O').NOENTRY
         AIF   ('&ENTRY' EQ 'PROLOG').PROLOG
         AIF   ('&ENTRY' EQ 'START').PROLOG
         AIF   ('&ENTRY' EQ 'BEGIN').PROLOG
         AIF   ('&ENTRY' EQ 'EPILOG').EPILOG
         AIF   ('&ENTRY' EQ 'END').EPILOG
         MNOTE 0,'DER901W &ENTRY is wrong ENTRY, NOENTRY is assumed.'
.NOENTRY AIF   (&WTXSTRT).EPILOG
.*
.*   XDIREF PROLOG
.*
.PROLOG  ANOP
&WTXSTRT SETB  1
DERWTX   &TYPE
         AIF   ('&TYPE' NE 'CSECT').BEGIN
&WTXTYPE SETB  1
DERWTX   AMODE &AMODE
DERWTX   RMODE &RMODE
.BEGIN   ANOP
         DC    CL8'DERWTX'
         @VGLOBAL
         EJECT ,
         MEXIT
.*
.*   XDIREF EPILOG
.*
.EPILOG  ANOP
PHEADER  @EDITHDR DATA,                                                +
               DSPCODE=&DSPCODE,                                       +
               LRECL=128,                                              +
               PREFIX=PH
         SPACE ,
         PRINT &PRINT
         DC    8D'0'
LMODESET MODESET MF=L
LMODSUPV MODESET MODE=SUP,MF=L
LMODSUPZ MODESET MODE=SUP,KEY=ZERO,MF=L
LMODPROB MODESET MODE=PROB,MF=L
LMODPRON MODESET MODE=PROB,KEY=NZERO,MF=L
LMODZERO MODESET KEY=ZERO,MF=L
LMODNZER MODESET KEY=NZERO,MF=L
LEXTRACT EXTRACT WTXEND,MF=L
LWTO     WTO   TEXT=,MF=L
LWTOR    WTOR  TEXT=WTXEND,MF=L
         DS    0D
LOPEN_PARMLIB  OPEN  (,),MODE=31,MF=L
LOPEN_INTRDR   OPEN  (,),MODE=31,MF=L
LOPEN_JES2FILE OPEN  (,),MODE=31,MF=L TYPE=J
LOPEN_LCLDS01  OPEN  (,),MODE=31,MF=L
LOPEN          OPEN  (,),MODE=31,MF=L
LCLOSE_JES2FILE CLOSE (,),MODE=31,MF=L
LCLOSE_LCLDS01 CLOSE (,),MODE=31,MF=L
LCLOSE         CLOSE (,),MODE=31,MF=L
LREAD    READ  XDIDECB,SF,MF=L
LBLDRCD  BUILDRCD ,,,,0,MF=L
LMGCRE   MGCRE MF=L
         DS    0D
XCJCL    @XCOMJOB DATA,                                                +
               CAILIB=CAI.CAILIB,                                      +
               STEPLIB=CAI.XCOM.CAILIB,                                +
               GLOBLIB=CAI.XCOM.NONQUEUE.GLOBAL,                       +
               RESTLIB=CAI.XCOM.NONQUEUE.RESTART,                      +
               CNTLLIB=CAI.XCOM.PARMLIB,                               +
               ROOTDIR=&PCROOT,                                        +
               DISP=&XDISP,                                            +
               CLASS=&XJCLASS,                                         +
               MCLASS=&XMCLASS,                                        +
               MLEVEL=&XMLEVEL,                                        +
               PREFIX=XC
         PRINT &PRINT
         @VDATA
WTXEND   EQU   *
         EJECT ,
         IEFZB4D2
         AIF   (NOT &WTXTYPE).EXIT
         END   DERWTX
.EXIT    ANOP
         MEND
./ ADD NAME=DERCIB   0100-01324-01324-1756-00084-00084-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERCIB   ¦
.*                    +----------+
.*
.*
.*    Function -
.*            Command Information Control Block
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DERCIB &TYPE=DSECT
         COPY  DERGBLVR
         AIF   ('&TYPE' EQ 'DSECT').DSECT
         AIF   ('&TYPE' EQ 'CSECT').CSECT
         AIF   ('&TYPE' EQ 'COM').COM
         AIF   ('&TYPE' EQ 'DATA').DATA
         MNOTE 8,'DER001E invalid TYPE.  Use DSECT, CSECT, COM or DATA'
         MEXIT
.DSECT   ANOP
CIB      DSECT
         AGO   .BEGIN
.CSECT   ANOP
CIB      CSECT
         AGO   .BEGIN
.COM     ANOP
CIB      COM
         AGO   .BEGIN
.DATA    ANOP
CIB      DS    0D
         AGO   .BEGIN
.BEGIN   ANOP
&NAME    DS    0D
CIBCIB   DS    F                  ADDRESS OF NEXT CIB IN CHAIN
CIBVERB  DS    C                  CIB VERB CODE
CIBSTART EQU   X'04' -  COMMAND CODE FOR START
CIBSTCOM EQU   X'08' -  COMMAND CODE FOR STC COMMUNICATION
CIBMODFY EQU   X'44' -  COMMAND CODE FOR MODIFY
CIBSTOP  EQU   X'40' -  COMMAND CODE FOR STOP
CIBMOUNT EQU   X'0C' -  COMMAND CODE FOR MOUNT
CIBSIZE  DS    C                  SIZE OF THE COMMAND INPUT BUFFER
CIBRSVD1 DS    H                  RESERVED
CIBRSVD2 DS    C                  RESERVED
CIBTSOID DS    CL3                TSO TERMINAL ID
CIBCONID DS    C                  CONSOLE ID OF STARTED TASK
CIBRSVD3 DS    C                  RESERVED
CIBDSIZE DS    H                  SIZE OF USER DATA WITHIN CIB
CIBDATA  DS    C                  COMMAND DATA AS ENTERED BY OPERATOR
         MEND
./ ADD NAME=DERDCB   0100-01324-01324-1756-00105-00105-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERDCB   ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Provide DCB skeleton of module extension
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERDCB &TYPE=CSECT,&AMODE=24,&RMODE=24,&PRINT=NOGEN
         COPY  DERGBLVR
DERDCB   &TYPE
         AIF   ('&TYPE' NE 'CSECT').BEGIN
DERDCB   AMODE &AMODE
DERDCB   RMODE &RMODE
.BEGIN   ANOP
         DC    CL8'DERDCB'
DCB_DIR  DS    0D
         DC    A(PARMLIB) DCB address of PARMLIB
         DC    A(JES2FILE) DCB address of JES2FILE
         DC    A(LCLDS01) DCB address of LCLDS01
         DC    A(LCLDS02) DCB address of LCLDS02
         DC    A(INTRDR) DCB address of INTRDR
         DC    A(SYSOUT) DCB address of INTRDR
DCB_DIRL EQU  *-DCB_DIR
         EJECT ,
         DS    0D
PARMLIB  DCB   DSORG=PO,MACRF=R,LRECL=80,                              +
               DDNAME=PARMLIB,DCBE=PARMDCBE
         DS    0D
PARMDCBE DCBE  RMODE31=BUFF,GETSIZE=NO,                                +
               EODAD=DCB_END
PARMSIZE EQU   *-PARMLIB
         DS    0D
LCLDS01  DCB   DSORG=PS,MACRF=PM,BUFNO=1, OPTCD=JU,                    +
               DDNAME=LCLDS01,DCBE=LCL1DCBE
         DS    0D
LCL1DCBE DCBE  RMODE31=BUFF,GETSIZE=NO
LCL1SIZE EQU   *-LCLDS01
         DS    0D
LCLDS02  DCB   DSORG=PS,MACRF=PL,BUFNO=1, FTEK=A,                      +
               DDNAME=LCLDS02,DCBE=LCL2DCBE
         DS    0D
LCL2DCBE DCBE  RMODE31=BUFF
LCL2SIZE EQU   *-LCLDS02
         DS    0D
JES2FILE DCB   DSORG=PS,MACRF=GL,BUFNO=1,EROPT=ACC,                    +
               DDNAME=JES2FILE,DCBE=JES2DCBE BFTEK=A,LRECL=16K
         DS    0D
JES2DCBE DCBE  RMODE31=BUFF,EODAD=DCB_END
JES2SIZE EQU   *-JES2FILE
         DS    0D
INTRDR   DCB   DSORG=PS,MACRF=PM,LRECL=80,BLKSIZE=80,RECFM=F,          +
               DDNAME=INTRDR,DCBE=INTRDCBE
         DS    0D
INTRDCBE DCBE  RMODE31=BUFF,GETSIZE=YES
INTRSIZE EQU   *-INTRDR
         DS    0D
SYSOUT   DCB   DSORG=PS,MACRF=GL,BUFNO=1,EROPT=SKP,                    +
               DDNAME=SYSOUTDS,DCBE=SYSODCBE
         DS    0D
SYSODCBE DCBE  RMODE31=BUFF,EODAD=DCB_END
DCB_END  EQU   *
         EJECT ,
         AIF   ('&TYPE' NE 'CSECT').EXIT
         END   DERDCB
.EXIT    ANOP
         MEND
./ ADD NAME=DERDETRC 0100-01324-01324-1756-00073-00073-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  | DEREDTRC |
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/20| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DEREDTRC &RC,&REG=15,&OUTREG=
         COPY  DERGBLVR
         LCLB  &OR
         LCLC  &WKAREA,&GR
&GR      SETC  '&REG'
         AIF   (T'&OUTREG EQ 'O').GO
&OR      SETB  1
&GR      SETC  '&OUTREG'
.GO      AIF   (T'&RC EQ 'O').NONE
         AIF   ('&RC' EQ '*').NONE
         AIF   ('&RC'(1,1) EQ '(').REG
         L     &GR,&RC
         CVD   &GR,&DERDBWD
         AGO   .EDIT
.REG     CVD   &RC(1),&DERDBWD
.EDIT    OI    &DERDBWD+7,X'0F'
         UNPK  &DERWORD,&DERDBWD
         AIF   (NOT &OR).EXIT
.EDITR   L     &OUTREG,&DERWORD
         MEXIT
.NONE    MVC   &DERWORD,=C'*N/A'
         AIF   (T'&OUTREG NE 'O').EDITR
         MEXIT
.EXIT    ANOP
         MEXIT
.ERRC    MNOTE 8,'DER030E Return code parameter missing.'
         MEND
./ ADD NAME=DERDSPHD 0100-01324-01324-1756-00116-00116-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERDSPHD ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Create storage structure of Dispatch/PC page header.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/19¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DERDSPHD &CODE=YYEDSPC10,                                     +
               &PREFIX=PH,                                             +
               &LRECL=132,                                             +
               &TYPE=DATA
         COPY  DERGBLVR
         LCLC  &P,&CDE,&LRL
         AIF   (T'&CODE NE 'O').A
&CDE     SETC  'YYEDSPC10'
         AGO   .B
.A       ANOP
&CDE     SETC  '&CODE'
.B       ANOP
         AIF   (T'&LRECL NE 'O').C
&LRL     SETC  '133'
         AGO   .D
.C       ANOP
&LRL     SETC  '&LRECL'
.D       ANOP
&P       SETC  '&PREFIX'
         AIF   ('&TYPE' EQ 'DSECT').DSECT
         AIF   ('&TYPE' EQ 'CSECT').CSECT
         AIF   ('&TYPE' EQ 'DATA').DATA
         AIF   ('&TYPE' EQ 'COM').COM
         MNOTE 8,'DER001E invalid TYPE. Use DSECT, CSECT, COM or DATA.'
         MEXIT
*
.DSECT   ANOP
&P.DR    DSECT
         AGO   .BEGIN
.CSECT   ANOP
&P.DR    CSECT
         AGO   .BEGIN
.COM     ANOP
&P.DR    COM
         AGO   .BEGIN
.DATA    ANOP
&P.DR    DS    0D
.BEGIN   ANOP
&NAME    DS    0D
&P.1     DC    CL&LRL' '
         ORG   &P.1
         DC    CL58'REPORT   DATE     TIME  DESCRIPTION'
         DC    CL53'PAGES RECIPIENT        JOB      JES #'
&P.1CODE DC    CL9'&CDE'
         ORG   ,
&P.2     DC    CL&LRL' '
         ORG   &P.2
&P.2RPTN DC    CL8' '
         DC    C' '
&P.2DATE DC    C'YY/MM/DD'
         DC    C' '
&P.2TIME DC    C'HH:MM'
         DC    CL32'ADS DIALOG REPORT WRITER'
&P.2PCNT DC    CL7'0000004'
         DC    C' '
&P.2RECP DC    CL8' '
         DC    CL9' '
&P.2JOBN DC    CL8' '
         DC    CL2' '
&P.2JESN DC    CL4' '
         ORG   &P.2+111
&P.2CODE DC    CL9'&CDE'
         ORG   ,
&P.3     DC    CL&LRL' '
         ORG   &P.3+32
         DC    C'_________________________>> PAGE '
&P.3PGN  DC    C'000001'
         DC    C' <<_________________________'
         ORG   ,
         MEND
./ ADD NAME=DEREDTMS 0100-01324-01324-1756-00301-00301-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  | DEREDTMS |
.*                    +----------+
.*
.*
.*    Function -
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/23| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DEREDTMS &PREF,&SUFF,&OBJECT=,&TYPE=,&RC=,&ROUTCDE=,&TEXT=
         COPY  DERGBLVR
         LCLA  &LOBJ,&L1,&L2,&LTX
         LCLB  &EC,&IC,&TXT
         LCLC  &C,&S,&MCODE,&OBJ,&Q,&TX1,&TX2,&X,&WORD,&RTX
         AIF   (T'&PREF EQ 'O').ERRPFX
         AIF   (T'&SUFF EQ 'O').ERRSUF
         AIF   (T'&OBJECT EQ 'O').ERROBJ
&C       SETC  '&PREF'(7,2)
&S       SETC  '&SUFF'
&Q       SETC  ''''
&X       SETC  'DER&SYSNDX'
&NAME    STM   R0,R15,&DERSVGR
         LA    R2,&DERMSGL+2
         AIF   ('&OBJECT'(1,1) NE '&Q').B
&LOBJ    SETA  K'&OBJECT-2
         LA    R3,&LOBJ
         LA    R1,=C&OBJECT
         AGO   .CONT
.B       AIF   ('&OBJECT'(1,1) NE '(').C
         LR    R1,&OBJECT(1)
         XR    R3,R3
         ICM   R3,B'0011',0(R1)
         LA    R1,2(,R1)
         AGO   .CONT
.C       LA    R1,&OBJECT
         LA    R3,L'&OBJECT
.CONT    AIF   ('&C' EQ '00').DER00
         AIF   ('&C' EQ '01').DER01
         AIF   ('&C' EQ '02').DER02
         AIF   ('&C' EQ '03').DER03
         AIF   ('&C' EQ '04').DER04
         AIF   ('&C' EQ '05').DER05
         AIF   ('&C' EQ '06').DER06
.*-------------------------------------------------------------------
.* DERWTR001I &OBJECT completed
.* DERWTR002W &OBJECT was not completed, RC=cccc
.* DERWTR003E &OBJECT error, RC=cccc
.*
.DER00   ANOP
         AIF   (T'&TYPE NE 'O').D000A
&TX1     SETC  ''
         AGO   .D000
.D000A   AIF   ('&TYPE' NE 'PARM').D000B
&TX1     SETC  'Parameter '
         AGO   .D000
.D000B   AIF   ('&TYPE' NE 'COMMAND').D000
&TX1     SETC  'Command '
         AGO   .D000
.D000    AIF   ('&S' NE 'I').D001
&MCODE   SETC  '&PREF.1I'
&TX2     SETC  ' was completed.'
         AGO   .D00X
.D001    AIF   ('&S' NE 'W').D002
&MCODE   SETC  '&PREF.2W'
&TX2     SETC  ' was not completed, RC='
&EC      SETB  1
         AGO   .D00X
.D002    AIF   ('&S' NE 'E').D00X
&MCODE   SETC  '&PREF.3E'
&TX2     SETC  ' was error, RC='
&EC      SETB  1
.D00X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR011I SVC 99 &TYPE of &OBJECT completed
.* DERWTR012W SVC 99 &TYPE of &OBJECT was not completed, EC=cc, IC=ii
.* DERWTR013E SVC 99 &TYPE of &OBJECT error, EC=cccc, IC=iiii
.*
.DER01   ANOP
&TX1     SETC  'SVC 99 '.'&TYPE'.' of '
         AIF   ('&S' NE 'I').D011
&MCODE   SETC  '&PREF.1I'
&TX2     SETC  ' was completed.'
         AGO   .D01X
.D011    AIF   ('&S' NE 'W').D012
&MCODE   SETC  '&PREF.2W'
&TX2     SETC  ' was not completed, EC='
&EC      SETB  1
&IC      SETB  1
         AGO   .D01X
.D012    AIF   ('&S' NE 'E').D01X
&MCODE   SETC  '&PREF.3E'
&TX2     SETC  ' was error, EC='
&EC      SETB  1
&IC      SETB  1
.D01X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR021I &TYPE &OBJECT found
.* DERWTR022W &TYPE &OBJECT can not be found
.* DERWTR023E &TYPE &OBJECT error, RC=cccc
.*
.DER02   ANOP
&TX1     SETC  '&TYPE '
         AIF   ('&S' NE 'I').D021
&MCODE   SETC  '&PREF.1I'
&TX2     SETC  ' was found.'
         AGO   .D02X
.D021    AIF   ('&S' NE 'W').D022
&MCODE   SETC  '&PREF.2W'
&TX2     SETC  ' was not found, RC='
&EC      SETB  1
         AGO   .D02X
.D022    AIF   ('&S' NE 'E').D02X
&MCODE   SETC  '&PREF.3E'
&TX2     SETC  ' was error, RC='
&EC      SETB  1
.D02X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR031I &TYPE of file &OBJECT completed
.* DERWTR032W Unable to &TYPE file &OBJECT, RC=cccc
.* DERWTR033E Error encountered during &TYPE file &OBJECT, RC=cccc
.*
.DER03   ANOP
         AIF   ('&S' NE 'I').D031
&MCODE   SETC  '&PREF.1I'
&TX1     SETC  '&TYPE'.' operation of file '
&TX2     SETC  ' was completed.'
         AGO   .D03X
.D031    AIF   ('&S' NE 'W').D032
&MCODE   SETC  '&PREF.2W'
&TX1     SETC  'Unable to '.'&TYPE'.' file '
&TX2     SETC  ', RC='
&EC      SETB  1
         AGO   .D03X
.D032    AIF   ('&S' NE 'E').D03X
&MCODE   SETC  '&PREF.3E'
&TX1     SETC  'Error encountered during '.'&TYPE'.' file '
&TX2     SETC  ', RC='
&EC      SETB  1
.D03X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR041I &OBJECT found. &TYPE subsystem request completed
.* DERWTR042W &OBJECT was not found. &TYPE subsystem returned RC=cccc
.* DERWTR043E Request rejected. &TYPE subsystem returned RC=cccc
.*
.*
.DER04   ANOP
         AIF   ('&S' NE 'I').D041
&MCODE   SETC  '&PREF.1I'
&TX1     SETC  ' '
&TX2     SETC ' was found.  '.'&TYPE'.' subsystem rqst was completed.'
         AGO   .D04X
.D041    AIF   ('&S' NE 'W').D042
&MCODE   SETC  '&PREF.2W'
&TX1     SETC  ' '
&TX2     SETC  ' was not found.  '.'&TYPE'.' subsystem returned RC='
&EC      SETB  1
         AGO   .D04X
.D042    AIF   ('&S' NE 'E').D04X
&MCODE   SETC  '&PREF.3E'
&TX1     SETC  'Request '
&TX2     SETC  ' rejected, '.'&TYPE'.' subsystem returned RC='
&EC      SETB  1
.D04X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR051I &TYPE is &OBJECT and is &TEXT
.*
.DER05   ANOP
&MCODE   SETC  '&PREF.1I'
&TX1     SETC  '&TYPE'.' is '
         AIF   (T'&TEXT EQ 'O').D051
&TXT     SETB  1
&TX2     SETC  ' and is '
         AGO   .D05X
.D051    ANOP
&TX2     SETC  ' '
.D05X    ANOP
         AGO   .EDIT
.*-------------------------------------------------------------------
.* DERWTR061I &TYPE &OBJECT &TEXT
.*
.DER06   ANOP
&MCODE   SETC  '&PREF.1I'
&TX1     SETC  '&TYPE '
         AIF   (T'&TEXT EQ 'O').D061
&TXT     SETB  1
.D061    ANOP
&TX2     SETC  ' '
         AGO   .EDIT
.*
.EDIT    ANOP
&TX1     SETC  '&MCODE &TX1'
&L1      SETA  K'&TX1
&L2      SETA  K'&TX2
         MVC   0(&L1,R2),=C'&TX1'
         BCTR  R3,0
         EX    R3,&X.M
         LA    R2,&L1+1(R3,R2)
         MVC   0(&L2,R2),=C'&TX2'
         LA    R2,&L2.(,R2)
         AIF   (NOT &TXT).EC
         AIF   ('&TEXT'(1,1) EQ '&Q').T01
         AIF   ('&TEXT'(1,1) EQ '(').T02
         MVC   0(L'&TEXT,R2),&TEXT
         LA    R2,L'&TEXT.(,R2)
         AGO   .EC
.T01     ANOP
&LTX     SETA  K'&TEXT-2
         MVC   0(&LTX,R2),=CL&LTX&TEXT
         LA    R2,&LTX.(,R2)
         AGO   .EC
.T02     ANOP
&RTX     SETC  '&TEXT(1)'
         XR    R1,R1
         ICM   R1,B'0011',0(&RTX)
         BCTR  R1,0
         EX    R1,*+4
         MVC   0(*-*,R2),2(&RTX)
         LA    R2,1(R1,R2)
.EC      AIF   (NOT &EC).FINISH
         AIF   (&IC).IC
         DEREDTRC &RC
         MVC   0(4,R2),&DERWORD
         MVI   4(R2),C'.'
         LA    R2,4(,R2)
         AGO   .FINISH
.IC      AIF   (T'&RC EQ 'O').FINISH
         AIF   ('&RC'(1,1) EQ '(').ICR
         L     R3,&RC
         AGO   .ICX
.ICR     ANOP
         LR    R3,&RC(1)
.ICX     ANOP
         LR    R0,R3
         SRL   R0,16
         SRL   R3,16
         DEREDTRC (R0)
         MVC   0(4,R2),&DERWORD
         MVC   4(5,R2),=C', IC='
         DEREDTRC (R3)
         MVC   9(4,R2),&DERWORD
         MVI   13(R2),C'.'
         LA    R2,14(,R2)
.FINISH  ANOP
         LA    R3,&DERMSGL+2
         SR    R2,R3
         STH   R2,&DERMSGL
         LA    R3,&DERMSGL
         WTO   TEXT=(R3),ROUTCDE=&ROUTCDE,MF=(E,&DERWTOL)
         B     &X.Z
&X.M     MVC   &L1.(*-*,R2),0(R1)
&X.Z     EQU   *
         LM    R0,R15,&DERSVGR
         MEXIT
.ERRPFX  MNOTE 8.'DER017E Invalid prefix'
         MEXIT
.ERRSUF  MNOTE 8.'DER017E Invalid prefix'
         MEXIT
.ERROBJ  MNOTE 8.'DER018E Invalid object'
         MEND
./ ADD NAME=DERFFREC 0100-01324-01324-1756-00077-00077-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERFFREC ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Map Area of Report Specification Line
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERFFREC &TYPE=DSECT
         AIF   ('&TYPE' EQ 'DSECT').DSECT
         AIF   ('&TYPE' EQ 'CSECT').CSECT
         AIF   ('&TYPE' EQ 'DATA').DATA
         AIF   ('&TYPE' EQ 'COM').COM
         MNOTE 'DER001E Invalid TYPE. Use DSECT, CSECT, COM or DATA.'
         MEXIT
*
* +--------------------------------------------------+
* ¦ Sysout SVC 99 Allocation Request Parameter Block ¦
* +--------------------------------------------------+
*
.DSECT   ANOP
&LABEL   DSECT
         AGO   .BEGIN
.CSECT   ANOP
&LABEL   CSECT
         AGO   .BEGIN
.COM     ANOP
&LABEL   COM
         AGO   .BEGIN
.DATA    ANOP
&LABEL   DS    0D
.BEGIN   ANOP
FFREC    DS    0D
FFRRDW   DC    A(0)
FFRDATA  DC    CL255' '
         ORG   FFRRDW
FFRECLEN DC    AL2(0)
         ORG
         MEND
./ ADD NAME=DERGBLVR 0100-01324-01324-1756-00075-00075-00000-DERU-S
.*
.*
.*                    +----------+
.*    MODULE NAME  -  ¦ DERGBLVR ¦
.*                    +----------+
.*
.*    Function -
.*            SOURCE COPY MODULE CONTAIN LIST OF GLOBAL VARIABLES
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/20¦ DERU S.    ¦ 1.0.0. ¦ FIRST DEVELOPMENT         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         GBLA  &DERSVSZ    Size of savearea
         GBLA  &DERCTR     Counter
         GBLB  &DEREQU     EQUATES INDICATOR
         GBLB  &DERESA     ESA INDICATOR
         GBLB  &DERRENT    REENTRANT INDICATOR
         GBLB  &DER390     S/390 INDICATOR
         GBLB  &DERCCTB    CC table INDICATOR
         GBLB  &DERSTOR    Storage indicator
         GBLC  &DERCLSL    CLOSE LIST FORM
         GBLC  &DERDATE
         GBLC  &DERDBWD
         GBLC  &DERDSN
         GBLC  &DERDSNC
         GBLC  &DEREDTL
         GBLC  &DERMSGL
         GBLC  &DERMID
         GBLC  &DEROPNL
         GBLC  &DERRDL
         GBLC  &DERSVAR
         GBLC  &DERSVGR
         GBLC  &DERTIME
         GBLC  &DERTMEL
         GBLC  &DERWORD
         GBLC  &DERWORK
         GBLC  &DERWRL
         GBLC  &DERWTOL
         GBLC  &DERYDAT
         GBLC  &DERYTIM
         GBLC  &DERVLBL(100)               Label
         GBLC  &DERVOPC(100)               OPcode
         GBLC  &DERVDAT(100)               Data / Operands
./ ADD NAME=DERMSG   0100-01324-01324-1756-00324-00324-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERMSG   ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Provide MSG skeleton of module extension
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERMSG &TYPE=CSECT,&AMODE=31,&RMODE=ANY,&PRINT=NOGEN
         COPY  DERGBLVR
DERMSG   &TYPE
         AIF   ('&TYPE' NE 'CSECT').BEGIN
DERMSG   AMODE &AMODE
DERMSG   RMODE &RMODE
.BEGIN   ANOP
         DC    CL8'DERMSG'
         SPACE ,
MSGDIR   DS    0F
         DC    A(XDI100)
         DC    A(XDI101)
         DC    A(XDI102)
         DC    A(XDI103)
         DC    A(XDI104)
         DC    A(XDI105)
         DC    A(XDI106)
         DC    A(XDI107)
         DC    A(XDI108)
         DC    A(XDI109)
         DC    A(XDI110)
         DC    A(XDI111)
         DC    A(XDI112)
         DC    A(XDI113)
         DC    A(XDI114)
         DC    A(XDI115)
         DC    A(XDI116)
         DC    A(XDI117)
         DC    A(XDI118)
         DC    A(XDI119)
         DC    A(XDI120)
         DC    A(XDI121)
         DC    A(XDI122)
         DC    A(XDI123)
         DC    A(XDI124)
         DC    A(XDI125)
         DC    A(XDI126)
         DC    A(XDI127)
         DC    A(XDI128)
         DC    A(XDI129)
         DC    A(WTR130)
         DC    A(WTR131)
         DC    A(WTR132)
         DC    A(WTR133)
         DC    A(WTR134)
         DC    A(XDP135)
         DC    A(XDP136)
         DC    A(XDI137)
         DC    A(XDI138)
         DC    A(XDI139)
         DC    A(XDI140)
         DC    A(XDI141)
         DC    A(XDI142)
         DC    A(XDI143)
         DC    A(XDI144)
         DC    A(XDI145)
         DC    A(XDI146)
         DC    A(WTR147)
         DC    A(WTR148)
         DC    A(WTR149)
         DC    A(WTR150)
         DC    A(WTR151)
         DC    A(WTR152)
         DC    A(WTR153)
         DC    A(WTR154)
         DC    A(WTR155)
         DC    A(WTR156)
         DC    A(WTR157)
         DC    A(WTR158)
         DC    A(WTR159)
         DC    A(WTR160)
         DC    A(WTR161)
         DC    A(WTR162)
         DC    A(WTR163)
         DC    A(WTR164)
         DC    A(WTR165)
         DC    A(WTR166)
         DC    A(WTR167)
         DC    A(XDS168)
         DC    A(XDS169)
         DC    A(XDI170)
         DC    A(XDI171)
         DC    A(XDI172)
         DC    A(XDI173)
         DC    A(XDI174)
         DC    A(XDI175)
         DC    A(XDI176)
         DC    A(XDI177)
         DC    A(XDI178)
         DC    A(XDI179)
         DC    A(XDI180)
         DC    A(XDI181)
         DC    A(XDI182)
         DC    A(XDI183)
         DC    A(XDI184)
         DC    A(XDI185)
         DC    A(XDI186)
         DC    A(XDI187)
         DC    A(XDI188)
MSGDIRL  EQU   *-MSGDIR
         DS    0D
XDI100   WTO   'DERXDI100I XDI initialization in progress.',           +
               MF=L
XDI101   WTO   'DERXDI101I XDI extension module (WTX) invalid, XDI star+
               t up canceled.',MF=L
XDI102   WTO   'DERXDI102I XDI start up parameter is being checked.',  +
               MF=L
XDI103   WTO   'DERXDP103I XDI parameter is being checked.',           +
               MF=L
XDI104   WTO  'DERXDI104I XDI console interface is being initialized.',+
               MF=L
XDI105   WTO  'DERXDI105I XDI initialization complete.',               +
               MF=L
XDI106   WTO  'DERXDI106I XDI-to-JES2 handshaking is being connected.',+
               MF=L
XDI107   WTO   'DERXDI107I PARMLIB file is being read.',               +
               MF=L
XDI108   WTO   'DERXDI108W Invalid XDI parameter ignored',             +
               MF=L
XDI109   WTO   'DERXDI109I XDI parameter accepted and existing one will+
                be overridden.',MF=L
XDI110   WTO   'DERXDI110I CMD parameter accepted and has been schedule+
               d.',MF=L
XDI111   WTO   'DERXDI111I Attempt to call XIO routine ...',           +
               MF=L
XDI112   WTO   'DERXDI112I WTR processing complete ...',               +
               MF=L
XDI113   WTO   'DERXDI113I Attempt to wait for next sysout arrival',   +
               MF=L
XDI114   WTO   'DERXDI114E No job found.',                             +
               MF=L
XDI115   WTO   'DERXDI115E Invalid search arguments.',                 +
               MF=L
XDI116   WTO   'DERXDI116E Unpredictable error occurs.',               +
               MF=L
XDI117   WTO   'DERXDI117E Duplicate job name.',                       +
               MF=L
XDI118   WTO   'DERXDI118E Invalid job name.',                         +
               MF=L
XDI119   WTO   'DERXDI119E Invalid destination name.',                 +
               MF=L
XDI120   WTO   'DERXDI120E Authorization failed.',                     +
               MF=L
XDI121   WTO   'DERXDI121E Token map failed.',                         +
               MF=L
XDI122   WTOR  'DERXDI122R Enter ''W'' to WAIT, ''R'' to RETRY, or anyt+
               hing else to EXIT',MF=L
XDI123   WTO   'DERXDI123W Unknown interaction.',                      +
               MF=L
XDI124   WTO   'DERXDI124I XDI stopped by operator.',                  +
               MF=L
XDI125   WTO   'DERXDI125I Attempt to close all opened datasets.',     +
               MF=L
XDI126   WTO   'DERXDI126I PARMLIB dataset closed.',                   +
               MF=L
XDI127   WTO   'DERXDI127I INTRDR closed.',                            +
               MF=L
XDI128   WTO   'DERXDI128I SSI handshaking to JES2 disconnected.',     +
               MF=L
XDI129   WTO   'DERXDI129I XCOM-to-DISPATCH is being shutted down.',   +
               MF=L
WTR130   WTO   'DERWTR130W DCB inform that sysout format neither ASA no+
               r MCC',MF=L
WTR131   WTO   'DERWTR131I DCB inform that sysout in ASA format',      +
               MF=L
WTR132   WTO   'DERWTR132I DCB inform that sysout in MCC format',      +
               MF=L
WTR133   WTO   'DERWTR133E Wrong format encountered.  Sysout is neither+
                ASA nor MCC format.',MF=L
WTR134   WTO   'DERWTR134W Sysout then enforced to use S/390 standard f+
               ormat.',MF=L
XDP135   WTO   'DERXDP135I Parameter is being initialized from parmlib +
               member.',MF=L
XDP136   WTO   'DERXDP136I Now reviewing all parameters .....',        +
               MF=L
XDI137   WTO   'DERXDI137I Request has been sent to JES2 ....',        +
               MF=L
XDI138   WTO   'DERXDI138I JES2 SSI response is being evaluated ...',  +
               MF=L
XDI139   WTO   'DERXDI139W JES2 SSI response is negative, RC > 4 ...', +
               MF=L
XDI140   WTO   'DERXDI140W Unable to access JES2 SSI ECB due to SSREQ e+
               rror ...',MF=L
XDI141   WTO   'DERXDI141W Command incomplete, execution aborted',     +
               MF=L
XDI142   WTO   'DERXDI142I Going to sleep ..., next command should pass+
               ed via MODIFY.',MF=L
XDI143   WTO   'DERXDI143I Intercepting IASXWR00 in progress ...',MF=L
XDI144   WTO   'DERXDI144E XDI failed, IASXWR00 was not intercepted',  +
               MF=L
XDI145   WTO   'DERXDI145E IASXWR00 successfully intercepted',         +
               MF=L
XDI146   WTO   'DERXDI146I Now is subsequent call, no reinitialization +
               needed.',MF=L
WTR147   WTO   'DERWTR147E Process terminated due to serious error .', +
               MF=L
WTR148   WTO   'DERWTR148E SYNAD of JES2FILE encountered, I/O terminate+
               d before EOF.',MF=L
WTR149   WTO   'DERWTR149W Bad sysout will be dumped out',MF=L
WTR150   WTO   'DERWTR150W Bad sysout has been dumped out',MF=L
WTR151   WTO   'DERWTR151W Bad sysout has been handled using JES2 PURGE+
                command.',MF=L
WTR152   WTO   'DERWTG152I Dump process of bad sysout begin ...',MF=L
WTR153   WTO   'DERWTG153I Dump process of bad sysout finish ...',MF=L
WTR154   WTO   'DERWTG154I Bad sysout allocation done ...',MF=L
WTR155   WTO   'DERWTG155I Begin to transfer a block of bad sysout...',+
               MF=L
WTR156   WTO   'DERWTG156I First block of bad sysout transferred ...', +
               MF=L
WTR157   WTO   'DERWTG157I Sysout processing begin ...',               +
               MF=L
WTR158   WTO   'DERWTG158I Sysout dataset has been allocated.',        +
               MF=L
WTR159   WTO   'DERWTG159I Sysout dataset has been opened.',           +
               MF=L
WTR160   WTO   'DERWTG160I Sysout is bieng processed.',                +
               MF=L
WTR161   WTO   'DERWTG161I Sysout processing is almost finish.',       +
               MF=L
WTR162   WTO   'DERWTG162I Sysout dataset has been closed.',           +
               MF=L
WTR163   WTO   'DERWTG163I Sysout dataset has been deallocated.',      +
               MF=L
WTR164   WTO   'DERWTG164I Sysout processing finish.',                 +
               MF=L
WTR165   WTO   'DERXDS165I Original SSOB captured.',                   +
               MF=L
WTR166   WTO   'DERXDS166I SSSO found contigous below SSOB.',          +
               MF=L
WTR167   WTO   'DERXDS167W Process routed to IEFSD087 due to SSOB error+
               .',MF=L
XDS168   WTO   'DERXDS168I IEFSSREQ returned RC=0, we can take over all+
               IASXWR00 efforts.',MF=L
XDS169   WTO   'DERXDS169I SSOB has been modified for next request..!',+
               MF=L
XDI170   WTO   'DERXDS170I Input accepted, parameter has been updated',+
               MF=L
XDI171   WTO   'DERXDS171I XDI parameter library has been refreshed.', +
               MF=L
XDI172   WTO   'DERXDS172I Destination table is being refreshed.',     +
               MF=L
XDI173   WTO   'DERXDS173I Destination table has been successfully refr+
               eshed.',MF=L
XDI174   WTO   'DERXDS174I Contact to SSI is being retried',           +
               MF=L
XDI175   WTO   'DERXDS175I SSOB is being refreshed.',                  +
               MF=L
XDI176   WTO   'DERXDS176W LRECL is more than 6233, process enforced to+
                use standard S/390 format.',MF=L
XDI177   WTO   'DERXDS177I I/O processing from sysout to flat dataset i+
               s in progress ...',MF=L
XDI178   WTO   'DERXDS178I I/O processing of ASA formatted sysout is us+
               ing PC/Dispatch format.',MF=L
XDI179   WTO   'DERXDS179I I/O processing of ASA formatted sysout is us+
               ing PC/Windows format.',MF=L
XDI180   WTO   'DERXDS180I I/O processing of MCC formatted sysout is us+
               ing PC/Dispatch format.',MF=L
XDI181   WTO   'DERXDS181I I/O processing of MCC formatted sysout is us+
               ing PC/Windows format.',MF=L
XDI182   WTO   'DERXDS182I I/O processing of sysout is using S/390 stan+
               dard format.',MF=L
XDI183   WTO   'DERXDS183I I/O processing from sysout to flat dataset i+
               s completed.',MF=L
XDI184   WTO   'DERXDS184W No OUTGRP provided, requeue canceled.',     +
               MF=L
XDI185   WTO   'DERXDS185W Writer name still not privided, use NONAME',+
               MF=L
XDI186   WTO   'DERXDS186W Requeue does not work, sysout lost.',       +
               MF=L
XDI187   WTO   'DERXDS187E SSREQ rejected by SSI, sysout lost.',       +
               MF=L
XDI188   WTO   'DERXDS188E SSREQ rejected by JES, sysout lost.',       +
               MF=L
         EJECT ,
         AIF   ('&TYPE' NE 'CSECT').EXIT
         END   DERMSG
.EXIT    ANOP
         MEND
./ ADD NAME=DERS99AL 0100-01324-01324-1756-00159-00159-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99AL ¦
.*                    +----------+
.*
.*    Function -
.*               Build an SVC 99 parameter list structure for
.*               dataset allocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*         USAGE -THIS MACRO MADE BE USED  MULTIPLE TIMES IN ONE
.*               PROGRAM AND GENERATE UNIQUE LABELS VIA THE 'UNQSUF'
.*               PARAMETER.  PRIOR TO ISSUING SVC 99 REGISTER 1 MUST
.*               CONTAIN THE ADDRESS OF   THIS PARAMETER LIST.
.*               EX. -  PARMLIB  DERS99AL DSN='SYS1.PARMLIB'
.*                                    ... ANY OTHER CODE
.*                                    LA  R1,PARMLIB
.*                                    SVC 99
.*                                    ... ANY OTHER CODE
.*         DEFAULTS -THERE ARE NO DEFAULTS FOR ANY PARM.    THE ONLY
.*               PARMETERS THAT WILL BE GENERATED FOR DYNAMIC
.*               ALLOCATION ARE THE ONES  THAT ARE SPECIFICALLY CODED.
.*               THE TYPE OF CALL TO DYNAMIC ALLOCATION DEFAULTS TO
.*               ALLOCATION.  BY CODING IN A VALUE FOR DEALLOC, THE
.*               PARAMETERS WILL DEALLOCATE THE RESOURCE INSTEAD OF
.*               ALLOCATING IT.
.*
.*         LABELS - LABELS HAVE BEEN PROVIDED FOR OFTEN USED FIELDS.
.*               SOME OF THESE ARE :
.*                       1. DAER    WHICH  POINTS TO THE ERROR CODE
.*                                        FROM SVC 99
.*                       2. DAIN    WHICH  POINTS TO THE INFORMATION
.*                                        CODE FROM SVC 99
.*               ALSO, EACH VALUE SUCH AS THE DSNAME TO ALLOCATE
.*               HAS A LABEL ASSOCIATED WITH IT FOR EASY REFERENCE.
.*
.*
.*
.*    Authors -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/17¦ Deru S.    ¦ 1.0.0. ¦ First developmentn        ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99AL &DSN=,           THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &GETDD=,            DDNAME TO ALLOCATE OR DEALLOCATE    +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &DISP=,             DISP IF NORMAL EOJ, DISP=(OLD,KEEP) +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &SPACE=,            SPACE, I.E SPACE=(TRK,(2,1,80),RLSE)+
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &PREFIX=A,          UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &DSORG=,            DATASET Organization                +
               &RECFM=,            Record format                       +
               &EXTRB=,            Reqst S99RBX                        +
               &RECBUF=,           Reqst record buffer allocation      +
               &TYPE=              Map definition type
         COPY  DERGBLVR
         LCLC  &STAT,&NDISP,&SPTYPE,&SPSIZE,&SPRLSE
         AIF   (N'&DISP LT 2).NOSTAT
&STAT    SETC  '&DISP(1)'
&NDISP   SETC  '&DISP(2)'
         AGO   .GO1
.NOSTAT  ANOP
&STAT    SETC  ''
&NDISP   SETC  '&DISP'
.GO1     AIF   (T'&SPACE EQ 'O').FINAL
         AIF   (N'&SPACE EQ 1).SPC1
         AIF   (N'&SPACE EQ 2).SPC2
         AIF   (N'&SPACE GE 3).SPC3
         AGO   .FINAL
.SPC1    ANOP
&SPTYPE  SETC  ''
&SPSIZE  SETC  '&SPACE'
&SPRLSE  SETC  ''
         AGO   .FINAL
.SPC2    ANOP
&SPTYPE  SETC  '&SPACE(1)'
&SPSIZE  SETC  '&SPACE(2)'
&SPRLSE  SETC  ''
         AGO   .FINAL
.SPC3    ANOP
&SPTYPE  SETC  '&SPACE(1)'
&SPSIZE  SETC  '&SPACE(2)'
&SPRLSE  SETC  'YES'
.FINAL   ANOP
&NAME    DERS99DA DSN=&DSN,                                            +
               DD=&DD,                                                 +
               GETDD=&GETDD,                                           +
               MEMBER=&MEMBER,                                         +
               DISP=&NDISP,                                            +
               STATUS=&STAT,                                           +
               CDISP=&CDISP,                                           +
               TYPSP=&SPTYPE,                                          +
               SPACE=&SPSIZE,                                          +
               RLSE=&SPRLSE,                                           +
               VOLSER=&VOLSER,                                         +
               UNIT=&UNIT,                                             +
               SYSOUT=&SYSOUT,                                         +
               FREE=&FREE,                                             +
               COPIES=&COPIES,                                         +
               LABEL=&LABEL,                                           +
               EXPDT=&EXPDT,                                           +
               RETPD=&RETPD,                                           +
               DUMMY=&DUMMY,                                           +
               BLKSIZE=&BLKSIZE,                                       +
               FUNC=&FUNC,                                             +
               FORM=&FORM,                                             +
               LRECL=&LRECL,                                           +
               PREFIX=&PREFIX,                                         +
               DCB=&DCB,                                               +
               SSREQ=&SSREQ,                                           +
               DSORG=&DSORG,                                           +
               RECFM=&RECFM,                                           +
               EXTRB=&EXTRB,                                           +
               RECBUF=&RECBUF,                                         +
               TYPE=&TYPE
         MEND
./ ADD NAME=DERS99CH 0100-01324-01324-1756-00564-00564-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99CH ¦
.*                    +----------+
.*
.*    Function -
.*               Build an SVC 99 parameter list structure for
.*               dataset allocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*         USAGE -THIS MACRO MADE BE USED  MULTIPLE TIMES IN ONE
.*               PROGRAM AND GENERATE UNIQUE LABELS VIA THE 'UNQSUF'
.*               PARAMETER.  PRIOR TO ISSUING SVC 99 REGISTER 1 MUST
.*               CONTAIN THE ADDRESS OF   THIS PARAMETER LIST.
.*               EX. -  PARMLIB  DERS99DA DSN='SYS1.PARMLIB'
.*                                    ... ANY OTHER CODE
.*                                    LA  R1,PARMLIB
.*                                    SVC 99
.*                                    ... ANY OTHER CODE
.*         DEFAULTS -THERE ARE NO DEFAULTS FOR ANY PARM.    THE ONLY
.*               PARMETERS THAT WILL BE GENERATED FOR DYNAMIC
.*               ALLOCATION ARE THE ONES  THAT ARE SPECIFICALLY CODED.
.*               THE TYPE OF CALL TO DYNAMIC ALLOCATION DEFAULTS TO
.*               ALLOCATION.  BY CODING IN A VALUE FOR DEALLOC, THE
.*               PARAMETERS WILL DEALLOCATE THE RESOURCE INSTEAD OF
.*               ALLOCATING IT.
.*
.*
.*
.*    Authors -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/17¦ Deru S.    ¦ 1.0.0. ¦ First developmentn        ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99CH &DSN=,           THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &GETDD=,            DDNAME returned after dynalloc      +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &CLASS=,            (For sysout only)                   +
               &STATUS=,           DISP status                         +
               &DISP=,             DISP IF NORMAL EOJ,                 +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &TYPSP=,            SPACE type blocked, TRK, or CYL     +
               &SPACE=,            SPACE size =(prim,sec,dirblock)     +
               &RLSE=,             SPACE RLSE to release unused space  +
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &PREFIX=,           UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &DSORG=,            SPECIFY DATASET ORGANIZATION        +
               &RECFM=,            SPECIFY RECORD FORMAT               +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &BREG=2,            SPECIFY BASE REGISTER               +
               &SVC99=,            SPECIFY EXECUTION OF SVC 99         +
               &TOLFAIL=,          SPECIFY tolerable error             +
               &ERRMSG=,           Display error msg                   +
               &LOC=               LOCATION of PARM
         COPY  DERGBLVR
         LCLB  &USING,&GDD
         LCLC  &SPRI,&SSEC,&DIR,
         LCLC  &X,&XX,&Q,&BASE,&XBASE,&REG,&LBL
&X       SETC  '&PREFIX.RB'
&XX      SETC  '&PREFIX.XRB'
&LBL     SETC  'DER&SYSNDX'
&XBASE   SETC  '&X.P'
&Q       SETC  ''''
         AIF   (T'&LOC NE 'O').GO
         MNOTE 8,'DER009E LOC must be specified to locate target area.'
         AGO   .FINISH
.GO      AIF   (T'&PREFIX NE 'O').CONT1
         MNOTE 8,'DER010E PREFIX must be specified.'
         AGO   .FINISH
.CONT1   AIF   (T'&SPACE EQ 'O').NOSPACE
         AIF   (N'&SPACE EQ 1).SPC1
         AIF   (N'&SPACE EQ 2).SPC2
         AIF   (N'&SPACE GE 3).SPC3
         AGO   .NOSPACE
.SPC1    ANOP
&SPRI    SETC  '&SPACE'
&SSEC    SETC  '0'
&DIR     SETC  '0'
         AGO   .BEGIN
.SPC2    ANOP
&SPRI    SETC  '&SPACE(1)'
&SSEC    SETC  '&SPACE(2)'
&DIR     SETC  '0'
         AGO   .BEGIN
.SPC3    ANOP
&SPRI    SETC  '&SPACE(1)'
&SSEC    SETC  '&SPACE(2)'
&DIR     SETC  '&SPACE(3)'
         AGO   .BEGIN
.NOSPACE ANOP
&SPRI    SETC  '0'
&SSEC    SETC  '0'
&DIR     SETC  '0'
.BEGIN   AIF   ('&LOC' EQ '0').C001
         AIF   ('&LOC' EQ '*').C001
&USING   SETB  1
&BASE    SETC  '&LOC'
         AIF   ('&LOC'(1,1) EQ '(').C000
&BASE    SETC  '&BREG'
         L     &BASE,&LOC
.C000    USING &XBASE,&BASE
.C001    AIF   (T'&DSN EQ 'O').C002
         MVI   &X.DSN,C' '
         MVC   &X.DSN+1(L'&X.DSN-1),&X.DSN
         AIF   ('&DSN'(1,1) EQ '(').C001R
         AIF   ('&DSN'(1,1) EQ '&Q').C001Q
         MVC   &X.DSN,&DSN
         AGO   .C001X
.C001R   MVC   &X.DSN,0&DSN
         AGO   .C001X
.C001Q   MVC   &X.DSN(K'&DSN-2),=C&DSN
.C001X   ANOP
         STM   R0,R2,&DERSVGR
         LA    R1,&X.DSN
         LR    R0,R1
         LA    R2,44
&LBL.A   CLI   0(R1),C' '
         BE    &LBL.B
         LA    R1,1(,R1)
         BCT   R2,&LBL.A
&LBL.B   SR    R1,R0
         STH   R1,&X.DSN-2
         LM    R0,R2,&DERSVGR
.C002    AIF   (T'&DD EQ 'O').C003
         AIF   (T'&GETDD EQ 'O').C002GO
         MNOTE 8,'DER022E DD and GETDD are muttually exclusive.'
         AGO   .C003
.C002GO  MVI   &X.DDN-1,L'&X.DDN
         MVC   &X.DDN+1(L'&X.DDN-1),&X.DDN
         MVC   &X.DDN-6(2),=X'0001'          Specify DDname
         AIF   ('&DD'(1,1) EQ '(').C002R
         AIF   ('&DD'(1,1) EQ '&Q').C002Q
         MVC   &X.DDN,&DD
         AGO   .C002X
.C002R   MVC   &X.DDN,0&DD
         AGO   .C002X
.C002Q   MVC   &X.DDN,=CL8&DD
.C002X   ANOP
         STM   R0,R2,&DERSVGR
         LA    R1,&X.DDN
         LR    R0,R1
         LA    R2,8
&LBL.C   CLI   0(R1),C' '
         BE    &LBL.D
         LA    R1,1(,R1)
         BCT   R2,&LBL.C
&LBL.D   SR    R1,R0
         STH   R1,&X.DDN-2
         LM    R0,R2,&DERSVGR
.C003    AIF   (T'&MEMBER EQ 'O').C004
         MVI   &X.MEM,C' '
         MVC   &X.MEM+1(L'&X.MEM-1),&X.MEM
         MVI   &X.MEM-1,L'&X.MEM
         AIF   ('&MEMBER'(1,1) EQ '(').C003R
         AIF   ('&MEMBER'(1,1) EQ '&Q').C003Q
         MVC   &X.MEM,&MEMBER
         AGO   .C003X
.C003R   MVC   &X.MEM,0&MEMBER
         AGO   .C003X
.C003Q   MVC   &X.MEM(K'&MEMBER-2),=C&MEMBER
.C003X   ANOP
         STM   R0,R2,&DERSVGR
         LA    R1,&X.MEM
         LR    R0,R1
         LA    R2,8
&LBL.E   CLI   0(R1),C' '
         BE    &LBL.F
         LA    R1,1(,R1)
         BCT   R2,&LBL.E
&LBL.F   SR    R1,R0
         STH   R1,&X.MEM-2
         LM    R0,R2,&DERSVGR
.C004    AIF   (T'&STATUS EQ 'O').C005
         AIF   ('&STATUS' EQ 'OLD').C004B1 OLD = X'01'
         AIF   ('&STATUS' EQ 'MOD').C004B2 MOD = X'02'
         AIF   ('&STATUS' EQ 'NEW').C004B3 NEW = X'04'
         AIF   ('&STATUS' EQ 'SHR').C004B4 SHR = X'08'
         MNOTE 8,'DER020E &STATUS INVALID FOR STATUS DISP PARAMETER'
         AGO   .C005
.C004B1  ANOP
         MVI   &X.STS,X'01'
         AGO   .C005
.C004B2  ANOP
         MVI   &X.STS,X'02'
         AGO   .C005
.C004B3  ANOP
         MVI   &X.STS,X'04'
         AGO   .C005
.C004B4  ANOP
         MVI   &X.STS,X'08'
         AGO   .C005
.C005    AIF   (T'&DISP EQ 'O').C006
         AIF   ('&DISP' EQ 'UNCATLG').C005C1 UNCATLG = X'01'
         AIF   ('&DISP' EQ 'CATLG').C005C2   CATLG   = X'02'
         AIF   ('&DISP' EQ 'DELETE').C005C3  DELETE  = X'04'
         AIF   ('&DISP' EQ 'KEEP').C005C4    KEEP    = X'08'
         MNOTE 8,'DER020E &DISP INVALID FOR DISP PARAMETER'
         AGO   .C006
.C005C1  ANOP
         MVI   &X.DSP,X'01'         CONSTANT FOR UNCATLG AT NORMAL EOJ
         AGO   .C006
.C005C2  ANOP
         MVI   &X.DSP,X'02'         CONSTANT FOR CATLG  AT NORMAL EOJ
         AGO   .C006
.C005C3  ANOP
         MVI   &X.DSP,X'04'         CONSTANT FOR DELETE AT NORMAL EOJ
         AGO   .C006
.C005C4  ANOP
         MVI   &X.DSP,X'08'         CONSTANT FOR KEEP   AT NORMAL EOJ
.C006    AIF   (T'&CDISP EQ 'O').C007
         AIF   ('&CDISP' EQ 'UNCATLG').C006D1 UNCATLG = X'01'
         AIF   ('&CDISP' EQ 'CATLG').C006D2   CATLG   = X'02'
         AIF   ('&CDISP' EQ 'DELETE').C006D3  DELETE  = X'04'
         AIF   ('&CDISP' EQ 'KEEP').C006D4    KEEP    = X'08'
         MNOTE 8,'DER020E &DISP INVALID FOR DISP PARAMETER'
         AGO   .C007
.C006D1  ANOP
         MVI   &X.CDS,X'01'         CONSTANT FOR UNCATLG AT NORMAL EOJ
         AGO   .C007
.C006D2  ANOP
         MVI   &X.CDS,X'02'         CONSTANT FOR CATLG  AT NORMAL EOJ
         AGO   .C007
.C006D3  ANOP
         MVI   &X.CDS,X'04'         CONSTANT FOR DELETE AT NORMAL EOJ
         AGO   .C007
.C006D4  ANOP
         MVI   &X.CDS,X'08'         CONSTANT FOR KEEP   AT NORMAL EOJ
.C007    AIF   (T'&SPACE EQ 'O').C008
         AIF   (T'&TYPSP EQ 'O').C007B
         AIF   ('&TYPSP' EQ 'TRK').C007A2
         AIF   ('&TYPSP' EQ 'CYL').C007A3
         AIF   ('&TYPSP'(1,1) EQ '(').C007A
         MVC   &X.SPT,=AL3(&TYPSP)
         AGO   .C007A1
.C007A   STCM  &TYPSP,B'0111',&X.SPT
.C007A1  MVC   &X.SPT-4(4),=XL4'00090103'   BLOCKS
         AGO   .C007B
.C007A2  MVC   &X.SPT-4(4),=XL4'00070000'   TRKS
         AGO   .C007B
.C007A3  MVC   &X.SPT-4(4),=XL4'00080000'   CYLS
.C007B   AIF   ('&SPRI'(1,1) EQ '(').C007B1
         MVC   &X.SPP,=AL3(&SPRI)
         AGO   .C007C
.C007B1  STCM  &SPRI,B'0111',&X.SPP
.C007C   AIF   ('&SSEC'(1,1) EQ '(').C007C1
         MVC   &X.SPS,=AL3(&SSEC)
         AGO   .C007D
.C007C1  STCM  &SSEC,B'0111',&X.SPS
.C007D   AIF   ('&DIR'(1,1) EQ '(').C007D1
         MVC   &X.SPD,=AL3(&DIR)
         AGO   .C008
.C007D1  STCM  &DIR,B'0111',&X.SPD
.C008    AIF   (T'&VOLSER EQ 'O').C009
         MVI   &X.VOL,C' '
         MVC   &X.VOL+1(L'&X.VOL-1),&X.VOL
         MVI   &X.VOL-1,L'&X.VOL
         AIF   ('&VOLSER'(1,1) EQ '(').C008R
         AIF   ('&VOLSER'(1,1) EQ '&Q').C008Q
         MVC   &X.VOL,&VOLSER
         AGO   .C009
.C008R   MVC   &X.VOL,0&VOLSER
         AGO   .C009
.C008Q   MVC   &X.VOL(K'&VOLSER-2),=C&VOLSER
.C009    AIF   (T'&UNIT EQ 'O').C010
         MVI   &X.UNT,C' '
         MVC   &X.UNT+1(L'&X.UNT-1),&X.UNT
         MVI   &X.UNT-1,L'&X.UNT
         AIF   ('&UNIT'(1,1) EQ '(').C009R
         AIF   ('&UNIT'(1,1) EQ '&Q').C009Q
         MVC   &X.UNT,&UNIT
         AGO   .C010
.C009R   MVC   &X.UNT,0&UNIT
         AGO   .C010
.C009Q   MVC   &X.UNT(K'&UNIT-2),=C&UNIT
.C010    AIF   (T'&SYSOUT EQ 'O').C011
         MVI   &X.SO,C' '
         MVC   &X.SO+1(L'&X.SO-1),&X.SO
         MVI   &X.SO-1,L'&X.SO
         AIF   ('&SYSOUT'(1,1) EQ '(').C010R
         AIF   ('&SYSOUT'(1,1) EQ '&Q').C010Q
         MVC   &X.SO,&SYSOUT
         AGO   .C011
.C010R   MVC   &X.SO,0&SYSOUT
         AGO   .C011
.C010Q   MVC   &X.SO(K'&SYSOUT-2),=C&SYSOUT
.C011    AIF   (T'&BLKSIZE EQ 'O').C012
         AIF   ('&BLKSIZE'(1,1) EQ '(').C011A
         MVC   &X.BSZ,=AL2(&BLKSIZE)
         AGO   .C012
.C011A   STH   &BLKSIZE,&X.BSZ
.C012    AIF   (T'&LRECL EQ 'O').C013
         AIF   ('&LRECL'(1,1) EQ '(').C012A
         MVC   &X.LRL,=AL2(&LRECL)
         AGO   .C013
.C012A   STH   &LRECL,&X.LRL
.C013    AIF   (T'&RECFM EQ 'O').C014
         AIF   ('&RECFM' EQ 'M').C013A1
         AIF   ('&RECFM' EQ 'A').C013A2
         AIF   ('&RECFM' EQ 'S').C013A3
         AIF   ('&RECFM' EQ 'B').C013A4
         AIF   ('&RECFM' EQ 'D').C013A5
         AIF   ('&RECFM' EQ 'V').C013A6
         AIF   ('&RECFM' EQ 'F').C013A7
         AIF   ('&RECFM' EQ 'U').C013A8
         AIF   ('&RECFM' EQ 'FB').C013A9
         AIF   ('&RECFM' EQ 'FBM').C013A10
         AIF   ('&RECFM' EQ 'FBA').C013A11
         AIF   ('&RECFM' EQ 'VB').C013A12
         AIF   ('&RECFM' EQ 'VBM').C013A13
         AIF   ('&RECFM' EQ 'VBA').C013A14
         MNOTE 8,'DER020E &RECFM invalid for RECFM parameter.'
         AGO   .C014
.C013A1  ANOP
         MVI   &X.RCF,X'02'      RECFM=M INDICATOR MACHINE CC
         AGO   .C014
.C013A2  ANOP
         MVI   &X.RCF,X'04'      RECFM=A INDICATOR FOR ASA PRINTER
         AGO   .C014
.C013A3  ANOP
         MVI   &X.RCF,X'08'      RECFM=S INDICATOR
         AGO   .C014
.C013A4  ANOP
         MVI   &X.RCF,X'10'      RECFM=B INDICATOR
         AGO   .C014
.C013A5  ANOP
         MVI   &X.RCF,X'20'      RECFM=D INDICATOR
         AGO   .C014
.C013A6  ANOP
         MVI   &X.RCF,X'40'      RECFM=V INDICATOR
         AGO   .C014
.C013A7  ANOP
         MVI   &X.RCF,X'80'      RECFM=F INDICATOR
         AGO   .C014
.C013A8  ANOP
         MVI   &X.RCF,X'C0'      RECFM=U INDICATOR
         AGO   .C014
.C013A9  ANOP
         MVI   &X.RCF,X'90'      RECFM=FB INDICATOR
         AGO   .C014
.C013A10 ANOP
         MVI   &X.RCF,X'92'      RECFM=FBM INDICATOR
         AGO   .C014
.C013A11 ANOP
         MVI   &X.RCF,X'94'      RECFM=FBA INDICATOR
         AGO   .C014
.C013A12 ANOP
         MVI   &X.RCF,X'50'      RECFM=VB INDICATOR
         AGO   .C014
.C013A13 ANOP
         MVI   &X.RCF,X'52'      RECFM=VBM INDICATOR
         AGO   .C014
.C013A14 ANOP
         MVI   &X.RCF,X'54'      RECFM=VBA INDICATOR
.C014    AIF   (T'&DSORG EQ 'O').C015
         AIF   ('&DSORG' EQ 'DA').C014Y1
         AIF   ('&DSORG' EQ 'DAU').C014Y2
         AIF   ('&DSORG' EQ 'PS').C014Y3
         AIF   ('&DSORG' EQ 'PSU').C014Y4
         AIF   ('&DSORG' EQ 'PO').C014Y5
         AIF   ('&DSORG' EQ 'POU').C014Y6
         MNOTE 8,'DER020E &DSORG invalid for DSORD parameter'
         AGO   .Z
.C014Y1  ANOP
         MVI   &X.ORG,X'20'      DSORG=DA INDICATOR
         AGO   .C015
.C014Y2  ANOP
         MVI   &X.ORG,X'21'      DSORG=DAU INDICATOR
         AGO   .C015
.C014Y3  ANOP
         MVI   &X.ORG,X'40'      DSORG=PS INDICATOR
         AGO   .C015
.C014Y4  ANOP
         MVI   &X.ORG,X'41'      DSORG=PSU INDICATOR
         AGO   .C015
.C014Y5  ANOP
         MVI   &X.ORG,X'02'      DSORG=PO INDICATOR
         AGO   .C015
.C014Y6  ANOP
         MVI   &X.ORG,X'03'      DSORG=POU INDICATOR
.C015    AIF   (T'&FORM EQ 'O').C016
         MVI   &X.FRM,C' '
         MVC   &X.FRM+1(L'&X.FRM-1),&X.FRM
         MVI   &X.FRM-1,L'&X.FRM
         AIF   ('&FORM'(1,1) EQ '(').C015R
         AIF   ('&FORM'(1,1) EQ '&Q').C015Q
         MVC   &X.FRM,&FORM
         AGO   .C016
.C015R   MVC   &X.FRM,0&FORM
         AGO   .C016
.C015Q   MVC   &X.FRM(K'&FORM-2),=C&FORM
.C016    AIF   (T'&DCB EQ 'O').C017
         MVI   &X.DCB,C' '
         MVC   &X.DCB+1(L'&X.DCB-1),&X.DCB
         MVI   &X.DCB-1,L'&X.DCB
         AIF   ('&DCB'(1,1) EQ '(').C016R
         AIF   ('&DCB'(1,1) EQ '&Q').C016Q
         MVC   &X.DCB,&DCB
         AGO   .C017
.C016R   MVC   &X.DCB,0&DCB
         AGO   .C017
.C016Q   MVC   &X.DCB(K'&DCB-2),=C&DCB
.C017    AIF   (T'&SSREQ EQ 'O').C018
         MVI   &X.SSR,C' '
         MVC   &X.SSR+1(L'&X.SSR-1),&X.SSR
         MVI   &X.SSR-1,L'&X.SSR
         AIF   ('&SSREQ'(1,1) EQ '(').C017R
         AIF   ('&SSREQ'(1,1) EQ '&Q').C017Q
         MVC   &X.SSR,&SSREQ
         AGO   .C018
.C017R   MVC   &X.SSR,0&SSREQ
         AGO   .C018
.C017Q   MVC   &X.SSR(K'&SSREQ-2),=C&SSREQ
.C018    AIF   (T'&LABEL EQ 'O').C019
         AIF   ('&LABEL' EQ 'NL').C018A1   NL  = X'01'
         AIF   ('&LABEL' EQ 'SL').C018A2   SL  = X'02'
         AIF   ('&LABEL' EQ 'NSL').C018A3  NSL = X'04'
         AIF   ('&LABEL' EQ 'SUL').C018A4  SUL = X'08'
         AIF   ('&LABEL' EQ 'BLP').C018A5  BLP = X'10'
         AIF   ('&LABEL' EQ 'LTM').C018A6  LTM = X'21'
         AIF   ('&LABEL' EQ 'AL').C018A7   AL  = X'40'
         AIF   ('&LABEL' EQ 'AUL').C018A8  AUL = X'48'
         MNOTE 8,'DER020E &LABEL INVALID FOR LABEL PARAMETER.'
         AGO   .C019
.C018A1  ANOP
         MVI   &X.LBL,X'01'        LABEL = NL
         AGO   .C019
.C018A2  ANOP
         MVI   &X.LBL,X'02'        LABEL = SL
         AGO   .C019
.C018A3  ANOP
         MVI   &X.LBL,X'04'        LABEL = NSL
         AGO   .C019
.C018A4  ANOP
         MVI   &X.LBL,X'08'        LABEL = SUL
         AGO   .C019
.C018A5  ANOP
         MVI   &X.LBL,X'10'        LABEL = BLP
         AGO   .C019
.C018A6  ANOP
         MVI   &X.LBL,X'21'        LABEL = LTM
         AGO   .C019
.C018A7  ANOP
         MVI   &X.LBL,X'40'        LABEL = AL
         AGO   .C019
.C018A8  ANOP
         MVI   &X.LBL,X'48'        LABEL = AUL
.C019    AIF   (T'&CLASS EQ 'O').C020
         MVI   &X.CLS,C' '
         MVC   &X.CLS+1(L'&X.CLS-1),&X.CLS
         MVI   &X.CLS-1,L'&X.CLS
         AIF   ('&CLASS'(1,1) EQ '(').C019R
         AIF   ('&CLASS'(1,1) EQ '&Q').C019Q
         MVC   &X.CLS,&CLASS
         AGO   .C020
.C019R   MVC   &X.CLS,0&CLASS
         AGO   .C020
.C019Q   MVI   &X.CLS(K'&CLASS-2),C&CLASS
.C020    ANOP
         AIF   (T'&GETDD EQ 'O').C022
         AIF   (T'&DD EQ 'O').C020GO
         MNOTE 8,'DER022E DD and GETDD are muttually exclusive.'
         AGO   .C022
.C020GO  AIF   ('&GETDD' EQ 'YES').C020Y
         AIF   ('&GETDD' EQ 'Y').C020Y
         AIF   ('&GETDD' EQ 'NO').C022
         AIF   ('&GETDD' EQ 'N').C022
         AIF   ('&GETDD'(1,1) EQ '&Q').C020ER
         AGO   .C021
.C020Y   MVC   &X.DDN-6(2),=X'0055'          Req to return DDname
         MVC   &X.DDN-4(4),=X'00010008'      num & length of DDname
         AGO   .C022
.C020ER  MNOTE 8,'DER021E &GETDD invalid output address'
         AGO   .C022
.C021    ANOP
         MVC   &X.DDN-6(2),=X'0055'          Req to return DDname
         MVC   &X.DDN-4(4),=X'00010008'      num & length of DDname
&GDD     SETB  1
.C022    AIF   (T'&ERRMSG EQ 'O').C023
         AIF   ('&ERRMSG' EQ 'NO').C023
         L     R1,&XX.P               S99RBX address
         USING S99RBX,R1
         OI    S99EOPTS,S99EIMSG      Issue msg before return
         AIF   ('&ERRMSG' EQ 'YES').C022X
         AIF   ('&ERRMSG' NE 'WTO').C022X
         OI    S99EOPTS,S99EWTP       Use WTO intead
.C022X   ANOP
         DROP  R1
.C023    ANOP
.FINISH  AIF   (NOT &USING).GETPLST
         LA    1,&XBASE            Set GR 1 as parm pointer
         DROP  &BASE
         AGO   .CHKSVC
.GETPLST ANOP
         LA    1,&XBASE            Set GR 1 as parm pointer
.CHKSVC  AIF   (T'&SVC99 EQ 'O').EXIT
         AIF   ('&SVC99' EQ 'Y').SVC99
         AIF   ('&SVC99' NE 'YES').EXIT
.SVC99   SVC   99
         AIF   (&GDD).COPYDD
         AIF   (T'&TOLFAIL EQ 'O').EXIT
.COPYDD  ANOP
         LTR   R15,R15
         BZ    &LBL.X
         AIF   (T'&TOLFAIL EQ 'O').CONTCPY
         XR    R1,R1
         ICM   R1,B'0011',&X.ERR            Get error code
         X     R1,=A(&TOLFAIL)
         BNZ   &LBL.Z                       If not 0, skip
         LR    R15,R1                       Set new RC
.CONTCPY ANOP
         B     &LBL.Z
&LBL.X   EQU   *
         AIF   (NOT &GDD).SVC99OK
         AIF   ('&GETDD'(1,1) EQ '(').GDDR
         MVC   &GETDD,&X.DDN
         AGO   .SVC99OK
.GDDR    ANOP
&REG     SETC  '&GETDD(1)'
         LA    &REG,&X.DDN
.SVC99OK ANOP
&LBL.Z   EQU   *
.EXIT    ANOP
         MEND
./ ADD NAME=DERS99DA 0100-01324-01324-1756-00158-00158-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99DA ¦
.*                    +----------+
.*
.*    Function -
.*               Build an SVC 99 parameter list structure for
.*               dataset allocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*         USAGE -THIS MACRO MADE BE USED  MULTIPLE TIMES IN ONE
.*               PROGRAM AND GENERATE UNIQUE LABELS VIA THE 'UNQSUF'
.*               PARAMETER.  PRIOR TO ISSUING SVC 99 REGISTER 1 MUST
.*               CONTAIN THE ADDRESS OF   THIS PARAMETER LIST.
.*               EX. -  PARMLIB  DERS99DA DSN='SYS1.PARMLIB'
.*                                    ... ANY OTHER CODE
.*                                    LA  R1,PARMLIB
.*                                    SVC 99
.*                                    ... ANY OTHER CODE
.*         DEFAULTS -THERE ARE NO DEFAULTS FOR ANY PARM.    THE ONLY
.*               PARMETERS THAT WILL BE GENERATED FOR DYNAMIC
.*               ALLOCATION ARE THE ONES  THAT ARE SPECIFICALLY CODED.
.*               THE TYPE OF CALL TO DYNAMIC ALLOCATION DEFAULTS TO
.*               ALLOCATION.  BY CODING IN A VALUE FOR DEALLOC, THE
.*               PARAMETERS WILL DEALLOCATE THE RESOURCE INSTEAD OF
.*               ALLOCATING IT.
.*
.*
.*
.*    Authors -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/17¦ Deru S.    ¦ 1.0.0. ¦ First developmentn        ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99DA &DSN=,           THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &GETDD=,            DDNAME TO ALLOCATE OR DEALLOCATE    +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &STATUS=,           DISP status                         +
               &DISP=,             DISP IF NORMAL EOJ,                 +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &TYPSP=,            SPACE type blocked, TRK, or CYL     +
               &SPACE=,            SPACE size =(prim,sec,dirblock)     +
               &RLSE=,             SPACE RLSE to release unused space  +
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &PREFIX=,           UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &DSORG=,            SPECIFY DATASET ORGANIZATION        +
               &RECFM=,            SPECIFY RECORD FORMAT               +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &TYPE=,             SPECIFY MAP TYPE                    +
               &NOHOLD=,           (For sysout only)                   +
               &CLASS=,            (For sysout only)                   +
               &EXTRB=,            Req S99 RBX                         +
               &RECBUF=,           Req record buffer                   +
               &DEALLOC=           DEALLOCATION REQUEST
         COPY  DERGBLVR
         LCLC  &SPRI,&SSEC,&DIR,&DDVAR
         AIF   (T'&DD EQ 'O').DD
&DDVAR   SETC  '&DD'
         AGO   .SPC
         AIF   (T'&GETDD EQ 'O').SPC
&DDVAR   SETC  '*'
.SPC     AIF   (T'&SPACE EQ 'O').FINAL
&SPRI    SETC  '0'
&SSEC    SETC  '0'
&DIR     SETC  '0'
         AIF   (N'&SPACE EQ 1).SPC1
         AIF   (N'&SPACE EQ 2).SPC2
         AIF   (N'&SPACE GE 3).SPC3
         AGO   .FINAL
.SPC1    ANOP
&SPRI    SETC  '&SPACE'
         AGO   .FINAL
.SPC2    ANOP
&SPRI    SETC  '&SPACE(1)'
&SSEC    SETC  '&SPACE(2)'
         AGO   .FINAL
.SPC3    ANOP
&SPRI    SETC  '&SPACE(1)'
&SSEC    SETC  '&SPACE(2)'
&DIR     SETC  '&SPACE(3)'
.FINAL   ANOP
&NAME    DERS99PL DSN=&DSN,                                            +
               DDN=&DDVAR,                                             +
               MEM=&MEMBER,                                            +
               STATUS=&STATUS,                                         +
               DISP=&DISP,                                             +
               CDISP=&CDISP,                                           +
               TYPSP=&TYPSP,                                           +
               SPACE=&SPRI,                                            +
               SECSP=&SSEC,                                            +
               DIRSP=&DIR,                                             +
               RLSE=&RLSE,                                             +
               VOLSER=&VOLSER,                                         +
               UNIT=&UNIT,                                             +
               SYSOUT=&SYSOUT,                                         +
               FREE=&FREE,                                             +
               COPIES=&COPIES,                                         +
               LABEL=&LABEL,                                           +
               EXPDT=&EXPDT,                                           +
               RETPD=&RETPD,                                           +
               DUMMY=&DUMMY,                                           +
               BLKSIZE=&BLKSIZE,                                       +
               FUNC=&FUNC,                                             +
               FORM=&FORM,                                             +
               LRECL=&LRECL,                                           +
               PREFIX=&PREFIX,                                         +
               DCB=&DCB,                                               +
               RECFM=&RECFM,                                           +
               DSORG=&DSORG,                                           +
               SSREQ=&SSREQ,                                           +
               DEALLOC=&DEALLOC,                                       +
               NOHOLD=&NOHOLD,            (For sysout only)            +
               CLASS=&CLASS,              (For sysout only)            +
               EXTRB=&EXTRB,       Req S99 RBX                         +
               RECBUF=&RECBUF,     Req record buffer                   +
               TYPE=&TYPE
         MEND
./ ADD NAME=DERS99FR 0100-01324-01324-1756-00081-00081-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99FR ¦
.*                    +----------+
.*
.*    Function -
.*               Build an SVC 99 parameter list structure for
.*               dataset deallocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*         USAGE -THIS MACRO MADE BE USED  MULTIPLE TIMES IN ONE
.*               PROGRAM AND GENERATE UNIQUE LABELS VIA THE 'UNQSUF'
.*               PARAMETER.  PRIOR TO ISSUING SVC 99 REGISTER 1 MUST
.*               CONTAIN THE ADDRESS OF   THIS PARAMETER LIST.
.*               EX. -  PARMLIB  DERS99FR DD=LCLDS01
.*                                    ... ANY OTHER CODE
.*                                    LA  R1,PARMLIB
.*                                    SVC 99
.*                                    ... ANY OTHER CODE
.*         DEFAULTS -THERE ARE NO DEFAULTS FOR ANY PARM.    THE ONLY
.*               PARMETERS THAT WILL BE GENERATED FOR DYNAMIC
.*               ALLOCATION ARE THE ONES  THAT ARE SPECIFICALLY CODED.
.*               THE TYPE OF CALL TO DYNAMIC ALLOCATION DEFAULTS TO
.*               ALLOCATION.  BY CODING IN A VALUE FOR DEALLOC, THE
.*               PARAMETERS WILL DEALLOCATE THE RESOURCE INSTEAD OF
.*               ALLOCATING IT.
.*
.*
.*    Authors -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/17¦ Deru S.    ¦ 1.0.0. ¦ First developmentn        ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99FR &DSN=,           THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &NOHOLD=,           (For sysout only)                   +
               &CLASS=,            (For sysout only)                   +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &DISP=,             DISP IF NORMAL EOJ, DISP=(OLD,KEEP) +
               &EXTRB=,            Reqst S99RBX                        +
               &PREFIX=D,          UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &TYPE=              MAP definition type
         COPY  DERGBLVR
&NAME    DERS99DA DSN=&DSN,                                            +
               DD=&DD,                                                 +
               NOHOLD=&NOHOLD,            (For sysout only)            +
               CLASS=&CLASS,              (For sysout only)            +
               MEMBER=&MEMBER,                                         +
               DISP=&DISP,                                             +
               PREFIX=&PREFIX,                                         +
               EXTRB=&EXTRB,                                           +
               DEALLOC=YES,                                            +
               TYPE=&TYPE
         MEND
./ ADD NAME=DERS99MD 0100-01324-01324-1756-00137-00137-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99MD ¦
.*                    +----------+
.*
.*    Function -
.*               Update an existing SVC 99 parameter list structure
.*               for dataset allocation/deallocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Authors -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/17¦ Deru S.    ¦ 1.0.0. ¦ First developmentn        ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99MD &LOC=,           PARM location (labelled location)   +
               &DSN=,              THE DATASET NAME                    +
               &DD=,               DDNAME TO ALLOCATE OR DEALLOCATE    +
               &GETDD=,            DDNAME returned after dynalloc      +
               &CLASS=,                   (For sysout only)            +
               &MEMBER=,           MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &DISP=,             DISP IF NORMAL EOJ, DISP=(OLD,KEEP) +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &SPACE=,            SPACE, I.E SPACE=(TRK,(2,1,80),RLSE)+
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &PREFIX=A,          UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &DSORG=,            DATASET Organization                +
               &RECFM=,            Record format                       +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &SVC99=,            Specify wether SVC 99 executed here +
               &TOLFAIL=,          Specify tolairable error            +
               &ERRMSG=            Display error msg
         COPY  DERGBLVR
         LCLC  &STAT,&NDISP,&SPTYPE,&SPSIZE,&SPRLSE
         AIF   (N'&DISP LT 2).NOSTAT
&STAT    SETC  '&DISP(1)'
&NDISP   SETC  '&DISP(2)'
         AGO   .GO1
.NOSTAT  ANOP
&STAT    SETC  ''
&NDISP   SETC  '&DISP'
.GO1     AIF   (T'&SPACE EQ 'O').FINAL
         AIF   (N'&SPACE EQ 1).SPC1
         AIF   (N'&SPACE EQ 2).SPC2
         AIF   (N'&SPACE GE 3).SPC3
         AGO   .FINAL
.SPC1    ANOP
&SPTYPE  SETC  ''
&SPSIZE  SETC  '&SPACE'
&SPRLSE  SETC  ''
         AGO   .FINAL
.SPC2    ANOP
&SPTYPE  SETC  '&SPACE(1)'
&SPSIZE  SETC  '&SPACE(2)'
&SPRLSE  SETC  ''
         AGO   .FINAL
.SPC3    ANOP
&SPTYPE  SETC  '&SPACE(1)'
&SPSIZE  SETC  '&SPACE(2)'
&SPRLSE  SETC  'YES'
.FINAL   ANOP
&NAME    DERS99CH DSN=&DSN,                                            +
               DD=&DD,                                                 +
               GETDD=&GETDD,                                           +
               CLASS=&CLASS,              (For sysout only)            +
               MEMBER=&MEMBER,                                         +
               DISP=&NDISP,                                            +
               STATUS=&STAT,                                           +
               CDISP=&CDISP,                                           +
               TYPSP=&SPTYPE,                                          +
               SPACE=&SPSIZE,                                          +
               RLSE=&SPRLSE,                                           +
               VOLSER=&VOLSER,                                         +
               UNIT=&UNIT,                                             +
               SYSOUT=&SYSOUT,                                         +
               FREE=&FREE,                                             +
               COPIES=&COPIES,                                         +
               LABEL=&LABEL,                                           +
               EXPDT=&EXPDT,                                           +
               RETPD=&RETPD,                                           +
               DUMMY=&DUMMY,                                           +
               BLKSIZE=&BLKSIZE,                                       +
               FUNC=&FUNC,                                             +
               FORM=&FORM,                                             +
               LRECL=&LRECL,                                           +
               PREFIX=&PREFIX,                                         +
               DCB=&DCB,                                               +
               SSREQ=&SSREQ,                                           +
               DSORG=&DSORG,                                           +
               RECFM=&RECFM,                                           +
               SVC99=&SVC99,                                           +
               TOLFAIL=&TOLFAIL,                                       +
               ERRMSG=&ERRMSG,                                         +
               LOC=&LOC
         MEND
./ ADD NAME=DERS99PL 0100-01324-01324-1756-00664-00664-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERS99PL ¦
.*                    +----------+
.*
.*    Function -
.*               Build an SVC 99 parameter list structure for
.*               dataset allocation function.
.*
.*    Syntax -
.*
.*
.*    Operation -
.*         USAGE -THIS MACRO MADE BE USED  MULTIPLE TIMES IN ONE
.*               PROGRAM AND GENERATE UNIQUE LABELS VIA THE 'UNQSUF'
.*               PARAMETER.  PRIOR TO ISSUING SVC 99 REGISTER 1 MUST
.*               CONTAIN THE ADDRESS OF   THIS PARAMETER LIST.
.*               EX. -  PARMLIB  DERS99PL DSN='SYS1.PARMLIB'
.*                                    ... ANY OTHER CODE
.*                                    LA  R1,PARMLIB
.*                                    SVC 99
.*                                    ... ANY OTHER CODE
.*         DEFAULTS -THERE ARE NO DEFAULTS FOR ANY PARM.    THE ONLY
.*               PARMETERS THAT WILL BE GENERATED FOR DYNAMIC
.*               ALLOCATION ARE THE ONES  THAT ARE SPECIFICALLY CODED.
.*               THE TYPE OF CALL TO DYNAMIC ALLOCATION DEFAULTS TO
.*               ALLOCATION.  BY CODING IN A VALUE FOR DEALLOC, THE
.*               PARAMETERS WILL DEALLOCATE THE RESOURCE INSTEAD OF
.*               ALLOCATING IT.
.*
.*
.*
.*    Authors -
.*         Name (1) :  K. P. Lim
.*                     Unknown MVS expert
.*         Name (2) :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1987 K. P. Lim
.*                     (C)1998 K. P. Lim & D. Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦78/05/17¦ K. P. Lim  ¦ 1.1.6  ¦ Last level of the original¦
.*    ¦        ¦            ¦        ¦ version declared          ¦
.*    ¦98/02/12¦ Deru S.    ¦ 2.0.0. ¦ First modification from   ¦
.*    ¦        ¦            ¦        ¦ macro named DA;           ¦
.*    ¦        ¦            ¦        ¦ - Add SSREQ TU option     ¦
.*    ¦        ¦            ¦        ¦ - Add DSORG TU option     ¦
.*    ¦        ¦            ¦        ¦ - Add RECFM TU option     ¦
.*    ¦        ¦            ¦        ¦ - Set BLKSIZE as default  ¦
.*    ¦        ¦            ¦        ¦   blocked SPACE           ¦
.*    ¦        ¦            ¦        ¦ - Put Mnote codes         ¦
.*    ¦        ¦            ¦        ¦ - Make it as an inner of  ¦
.*    ¦        ¦            ¦        ¦   @S99PARM                ¦
.*    ¦        ¦            ¦        ¦ - Change logic path for   ¦
.*    ¦        ¦            ¦        ¦   DEALLOC option          ¦
.*    ¦        ¦            ¦        ¦ - Change unique label     ¦
.*    ¦        ¦            ¦        ¦   suffix to prefix        ¦
.*    ¦        ¦            ¦        ¦ - Add map definition      ¦
.*    ¦        ¦            ¦        ¦ - Make more flexible for  ¦
.*    ¦        ¦            ¦        ¦   each entry typing       ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
.*
.*********************************************************************
         MACRO
&NAME    DERS99PL &DSN=,           THE DATASET NAME                    +
               &DDN=,              DDNAME TO ALLOCATE OR DEALLOCATE    +
               &MEM=,              MEMBER NAME FOR PDS OR BIAS FOR GDG +
               &NOHOLD=,           (For sysout only)                   +
               &CLASS=,            (For sysout only)                   +
               &STATUS=,           PRIMARY DISPOSITION                 +
               &DISP=,             DISPOSITION IF NORMAL EOJ           +
               &CDISP=,            DISPOSITION IF ABNORMAL EOJ         +
               &SPACE=,            PRIMARY SPACE REQUIREMENT           +
               &TYPSP=,            TYPE OF SPACE TO ALLOCATE           +
               &SECSP=,            SECONDARY SPACE REQUIREMENT         +
               &VOLSER=,           VOLUME SERIAL #                     +
               &UNIT=,             UNIT DESIGNATION                    +
               &SYSOUT=,           CLASS SPECIFICATION FOR SYSOUT      +
               &FREE=,             DEALLOCATE AT CLOSE                 +
               &COPIES=,           COPIES OF YOUR SYSOUT               +
               &LABEL=,            TYPE LABEL - SL,NL,ETC.             +
               &EXPDT=,            EXPIDATION DATE                     +
               &RETPD=,            RETENTION PERIOD                    +
               &DUMMY=,            ALLOCATE A DUMMY DATA SET           +
               &BLKSIZE=,          BLOCK SIZE                          +
               &FUNC=,             FOR PUNCH OUTPUT INTERPRETING       +
               &FORM=,             FORM NAME SPECIFICATION.            +
               &LRECL=,            LOGICAL RECORD LENGTH               +
               &DIRSP=,            # OF DIRECTORY BLOCKS OR INDEX SPACE+
               &RLSE=,             TO REQUEST THE RELEASE OF UNUSED SP +
               &PREFIX=A,          UNIQUE PREFIX FOR LABEL NAMES (1-2) +
               &DCB=,              SPECIFY A DSNAME TO COPY DCB FROM   +
               &SSREQ=,            SPECIFY REQUEST TO NAMED SUBSYSTEM  +
               &DSORG=,            SPECIFY dataset organization        +
               &RECFM=,            SPECIFY record format               +
               &DEALLOC=,          Set this RB for deallocation        +
               &EXTRB=,            Request extension block             +
               &RECBUF=,           Request record buffer               +
               &TYPE=DATA          (DATA, DSECT, CSECT or COM)
         COPY  DERGBLVR
         LCLA  &A,&K,&I,&LDD
         LCLB  &UNALLOC,&XRB,&RBUF
         LCLC  &X,&DDCODE
         AIF   (T'&LRECL EQ 'O').NORBUF
         AIF   (T'&RECBUF EQ 'O').NORBUF
         AIF   ('&RECBUF' NE 'YES').NORBUF
&RBUF    SETB  1
.NORBUF  ANOP
&X       SETC  '&PREFIX'
         AIF   ('&TYPE' EQ 'DATA').TDATA
         AIF   ('&TYPE' EQ 'DSECT').TDSECT
         AIF   ('&TYPE' EQ 'CSECT').TCSECT
         AIF   ('&TYPE' EQ 'COM').TCOM
         MNOTE 4,'DER022W TYPE=&TYPE invalid, TYPE=DATA assumed.'
.TDATA   ANOP
&NAME    DS    0D
         AGO   .BEGIN
.TDSECT  ANOP
&NAME    DSECT
         AGO   .BEGIN
.TCSECT  ANOP
&NAME    CSECT
         AGO   .BEGIN
.TCOM    ANOP
&NAME    COM
.BEGIN   ANOP
&DDCODE  SETC  '0001'
&LDD     SETA  K'&DDN
         AIF   ('&DDN' NE '*').GOHEAD
&DDCODE  SETC  '0055'
&LDD     SETA  8
.GOHEAD  ANOP
&X.RBP   DS    0D
         DC    X'80'
         DC    AL3(&X.RB)
&X.RB    DS    0F
         DC    AL1(20)
         AIF   (T'&DEALLOC EQ 'O').ALLOC
         DC    AL1(02)             THIS CONTROL BLOCK IS FOR DEALLOCATE
&UNALLOC SETB  1
         AGO   .PAST
.ALLOC   DC    AL1(01)             THIS CONTROL IS FOR ALLOCATION
.PAST    ANOP
&X.RBFL1 DC    X'00'             Flag 1 bit 0-7
&X.RBFL1X DC    X'00'                   bit 8-9
&X.RBERR DC    AL2(0)              ERROR CODE FROM DYNAMIC ALLOCATION
&X.RBINF DC    AL2(0)              INFORMATION CODE FROM DYNALLOC
         DC    A(&X.RBTU)          POINTER TO CALL LIST FOR SVC 99
         AIF   (T'&EXTRB EQ 'O').CONT01
         AIF   ('&EXTRB' NE 'YES').CONT01
&X.XRBP  DC    A(&X.XRB)           S99RBX address
&XRB     SETB  1
         AGO   .CONT02
.CONT01  DC    A(0)
.CONT02  ANOP
&X.RBFL2 DC   X'00'              Flag 2 bit 0-7
&X.RBFL2X DC   X'00'                    bit 8-11
         DC    AL2(0)
&A       SETA  1
         DS    0F                  FULLWORD ALIGNED
&X.RBTU&A DC   X'&DDCODE'          KEY FOR DDNAME SPECIFICATION
         DC    XL2'1'
         DC    AL2(&LDD)           LENGTH OF DDNAME SPECIFIED
&X.RBDDN DC    CL8'&DDN'             DDNAME PLUGGED IN HERE
&A       SETA  &A+1
.*<<
         AIF   (T'&DSN EQ 'O').A
         DS    0F
&X.RBTU&A DC   X'0002'             KEY FOR DSNAME SPECIFICATION
         DC    XL2'1'
         DC    AL2(44)             LENGTH OF DSNAME MAX IS 44
&K       SETA  K'&DSN
         AIF   ('&DSN'(1,1) EQ '''').QDSN
&X.RBDSN DC    CL44'&DSN'          DSNAME IS PLUGGED IN HERE
         AGO   .OKDSN
.QDSN    ANOP
&X.RBDSN DC    CL44&DSN            DSNAME IS PLUGGED IN HERE
.OKDSN   ANOP
&A       SETA  &A+1
.*<<
.A       AIF   (T'&MEM EQ 'O').B
         DS    0F
&X.RBTU&A DC   X'0003'             KEY FOR MEMBER OR GDG SPECIFICATION
         DC    XL2'1'
&K       SETA  K'&MEM
         DC    XL2'&K'             LENGTH OF SPECFIED MEMBER NAME
&X.RBMEM DC    CL8'&MEM'           THE MEMBER NAME IS PLUGGED IN HERE
&A       SETA  &A+1
.*<<
.B       AIF   (&UNALLOC OR (T'&STATUS EQ 'O')).C
         DS    0F
&X.RBTU&A DC   X'0004'             KEY FOR PRIMARY DISPOSITION OF DDN
         DC    XL2'1'
         DC    XL2'1'              THIS IS ALWAYS A ONE BYTE CODE
&A       SETA  &A+1
         AIF   ('&STATUS' EQ 'OLD').B1       OLD = X'01'
         AIF   ('&STATUS' EQ 'MOD').B2       MOD = X'02'
         AIF   ('&STATUS' EQ 'NEW').B3       NEW = X'04'
         AIF   ('&STATUS' EQ 'SHR').B4       SHR = X'08'
         MNOTE 8,'DER020E &STATUS Invalid for STATUS DISP parameter'
         AGO   .C
.B1      ANOP
&X.RBSTS DC    X'01'                CONSTANT FOR DISP=OLD
         AGO   .C
.B2      ANOP
&X.RBSTS DC    X'02'                CONSTANT FOR DISP=MOD
         AGO   .C
.B3      ANOP
&X.RBSTS DC    X'04'                CONSTANT FOR DISP=NEW
         AGO   .C
.B4      ANOP
&X.RBSTS DC    X'08'                CONSTANT FOR DISP=SHR
         AGO   .C
.*<<
.C       AIF   (T'&DISP EQ 'O').D
         DS    0F
&X.RBTU&A DC   X'0005'             KEY FOR NORMAL EOJ SPECIFICATION
&A       SETA  &A+1
         DC    XL2'1'
         DC    XL2'1'              THIS WILL ALWAYS BE A ONE BYTE KEY
         AIF   ('&DISP' EQ 'UNCATLG').C1     UNCATLG = X'01'
         AIF   ('&DISP' EQ 'CATLG').C2       CATLG   = X'02'
         AIF   ('&DISP' EQ 'DELETE').C3      DELETE  = X'04'
         AIF   ('&DISP' EQ 'KEEP').C4        KEEP    = X'08'
         MNOTE 8,'DER020E &DISP invalid for DISP parameter'
         AGO   .D
.C1      ANOP
&X.RBDSP DC    X'01'                CONSTANT FOR UNCATLG AT NORMAL EOJ
         AGO   .D
.C2      ANOP
&X.RBDSP DC    X'02'                CONSTANT FOR CATLG  AT NORMAL EOJ
         AGO   .D
.C3      ANOP
&X.RBDSP DC    X'04'                CONSTANT FOR DELETE AT NORMAL EOJ
         AGO   .D
.C4      ANOP
&X.RBDSP DC    X'08'                CONSTANT FOR KEEP   AT NORMAL EOJ
         AGO   .D
.*<<
.D       AIF   (&UNALLOC OR (T'&CDISP EQ 'O')).E
         DS    0F
&X.RBTU&A DC   X'0006'             KEY FOR ABNORMAL EOJ DISPOSITION
&A       SETA  &A+1
         DC    XL2'1'
         DC    XL2'1'              THIS IS ALWAYS A ONE BYTE KEY
         AIF   ('&CDISP' EQ 'UNCATLG').D1      UNCATLG = X'01'
         AIF   ('&CDISP' EQ 'CATLG').D2        CATLG   = X'02'
         AIF   ('&CDISP' EQ 'DELETE').D3       DELETE  = X'04'
         AIF   ('&CDISP' EQ 'KEEP').D4         KEEP    = X'08'
         MNOTE 8,'DER020E &CDISP invalid for DISP parameter'
         AGO   .E
.D1      ANOP
&X.RBCDS DC    X'01'               CONSTANT FOR UNCATLG IF ABEND
         AGO   .E
.D2      ANOP
&X.RBCDS DC    X'02'               CONSTANT FOR CATLG  IF ABEND
         AGO   .E
.D3      ANOP
&X.RBCDS DC    X'04'               CONSTANT FOR DELETE IF ABEND
         AGO   .E
.D4      ANOP
&X.RBCDS DC    X'08'               CONSTANT FOR KEEP   IF ABEND
         AGO   .E
.*<<
.E       AIF   (&UNALLOC).K
         AIF   (T'&TYPSP NE 'O').E0
         AIF   (T'&BLKSIZE EQ 'O').I
&X.RBTU&A DC   X'0009'                 IT MUST BE IN BLOCKS
         DC    XL1'1'
         DC    XL1'3'
&X.RBSPT DC    AL3(&BLKSIZE)
         AGO   .EE
.E0      DS    0F
         AIF   ('&TYPSP' EQ 'TRK').E1  IF TYPE OF SPACE SPECIFICATION
         AIF   ('&TYPSP' EQ 'CYL').E2  IS NOT TRACKS OR CYLINDERS THEN
&X.RBTU&A DC   X'0009'                 IT MUST BE IN BLOCKS
         DC    XL1'1'
         DC    XL1'3'
&X.RBSPT DC    AL3(&TYPSP)
         AGO   .EE
.E1      ANOP
&X.RBTU&A DC   X'0007'             SPACE IS TO BE ALLOCATED IN TRKS
         DC    XL5'0'
         AGO   .EE
.E2      ANOP
&X.RBTU&A DC   X'0008'             SPACE IS TO BE ALLOCATED IN CYLS
         DC    XL5'0'
.EE      DC    XL1'0'
&A       SETA  &A+1
.*<<
.F       AIF   (T'&SPACE EQ 'O').I
         DS    0F
&X.RBTU&A DC   X'000A'             KEY TO SPECIFY PRIMARY SPACE
         DC    XL2'1'
         DC    XL2'3'              MAXIMUM LENGTH IS THREE
&X.RBSPP DC    AL3(&SPACE)
&A       SETA  &A+1
         AGO   .G
.*<<
.G       AIF   (T'&SECSP EQ 'O').H
         DS    0F
&X.RBTU&A DC   X'000B'             KEY TO SPECIFY SECONDARY SPACE
         DC    XL2'1'
         DC    XL2'3'              MAXIMUM LENGTH IS THREE
&X.RBSPS DC    AL3(&SECSP)
&A       SETA  &A+1
.*<<
.H       AIF   (T'&DIRSP EQ 'O').I
         DS    0F
&X.RBTU&A DC   X'000C'             KEY TO SPECIFY DIRECTORY SPACE
         DC    XL2'1'
         DC    XL2'3'              MAXIMUM LENGTH IS THREE
&X.RBSPD DC    AL3(&DIRSP)
&A       SETA  &A+1
.*<<
.I       AIF   (T'&VOLSER EQ 'O').J
         DS    0F
&X.RBTU&A DC   X'0010'             KEY TO SPECIFY A PARTICULAR VOLSER
         DC    XL2'1'
&K       SETA  K'&VOLSER           PICK UP LENGTH OF NAME SPECIFIED
         DC    XL2'&K'             AND USE THAT LENGTH
&X.RBVOL DC    CL6'&VOLSER'          AND NAME
&A       SETA  &A+1
.*<<
.J       AIF   (T'&UNIT EQ 'O').K
         DS    0F
&X.RBTU&A DC   X'0015'             KEY FOR UNIT SPECIFICATION
         DC    XL2'1'
&K       SETA  K'&UNIT             PICK UP LENGTH OF UNIT NAME GIVEN
         DC    AL2(&K)             THEN USE THAT LENGTH
&X.RBUNT DC    CL8'&UNIT'            AND NAME
&A       SETA  &A+1
.*<<
.K       AIF   (T'&SYSOUT EQ 'O').L
         DS    0F
&X.RBTU&A DC   X'0018'             KEY FOR SYSOUT CLASS SPECIFICATION
         DC    XL2'1'
&K       SETA  K'&SYSOUT
         DC    AL2(&K)
&X.RBSO  DC    CL32'&SYSOUT'
&A       SETA  &A+1
.*<<
.L       AIF   (T'&FORM EQ 'O').M
         DS    0F
&X.RBTU&A DC   X'001A'             KEY FOR FORMS ID SPECIFICATION
         DC    XL2'1'
&K       SETA  K'&FORM             PICK UP LENGTH OF FORMS ID
         DC    AL2(&K)             AND USE THAT LENGTH
&X.RBFRM DC    CL8'&FORM'            AND THAT FORM NUMBER
&A       SETA  &A+1
.*<<
.M       AIF   (T'&FREE EQ 'O').N
         AIF   ('&FREE' NE 'CLOSE').M2
         DS    0F
&X.RBTU&A DC   X'001C'             KEY TO SPECIFY FREE=CLOSE
&X.RBFRE DC    XL2'0'              MUST BE CODED FREE=CLOSE
&A       SETA  &A+1                ALL ELSE WILL GENERATE MNOTE
         AGO   .N
.M2      MNOTE 8,'DER020E &FREE invalid for FREE parameter'
.*<<
.N       AIF   (T'&COPIES EQ 'O').O
         DS    0F
&X.RBTU&A DC   X'001D'             KEY TO SPECIFY MULTIPLE COPIES
         DC    XL2'1'              OF OUTPUT.
         DC    XL2'1'
&X.RBCPY DC    AL1(&COPIES)        NUMBER OF COPIES REQUESTED
&A       SETA  &A+1
.*<<
.O       AIF   (&UNALLOC OR (T'&LABEL EQ 'O')).P
         DS    0F
&X.RBTU&A DC   X'001E'             KEY TO SPECIFY TYPE LABEL
         DC    XL2'1'
         DC    XL2'1'              LENGTH OF THIS FIELD IS ALWAYS ONE
&A       SETA  &A+1
         AIF   ('&LABEL' EQ 'NL').O1     NL  = X'01'
         AIF   ('&LABEL' EQ 'SL').O2     SL  = X'02'
         AIF   ('&LABEL' EQ 'NSL').O3    NSL = X'04'
         AIF   ('&LABEL' EQ 'SUL').O4    SUL = X'08'
         AIF   ('&LABEL' EQ 'BLP').O5    BLP = X'10'
         AIF   ('&LABEL' EQ 'LTM').O6    LTM = X'21'
         AIF   ('&LABEL' EQ 'AL').O7     AL  = X'40'
         AIF   ('&LABEL' EQ 'AUL').O8    AUL = X'48'
         MNOTE 8,'DER020E &LABEL invalid for LABEL parameter'
         AGO   .P
.O1      ANOP
&X.RBLBL DC    X'01'               LABEL = NL
         AGO   .P
.O2      ANOP
&X.RBLBL DC    X'02'               LABEL = SL
         AGO   .P
.O3      ANOP
&X.RBLBL DC    X'04'               LABEL = NSL
         AGO   .P
.O4      ANOP
&X.RBLBL DC    X'08'               LABEL = SUL
         AGO   .P
.O5      ANOP
&X.RBLBL DC    X'10'               LABEL = BLP
         AGO   .P
.O6      ANOP
&X.RBLBL DC    X'21'               LABEL = LTM
         AGO   .P
.O7      ANOP
&X.RBLBL DC    X'40'               LABEL = AL
         AGO   .P
.O8      ANOP
&X.RBLBL DC    X'48'               LABEL = AUL
         AGO   .P
.*<<
.P       AIF   (T'&EXPDT EQ 'O').Q
         DS    0F
&X.RBTU&A DC   X'0022'             KEY TO SPECIFY EXPIRATION DATE
         DC    XL2'1'
         DC    XL2'5'              FIELD IS FIVE NUMERICS
&X.RBEXP DC    CL5'&EXPDT'         AND IS PUT IN HERE
&A       SETA  &A+1
.*<<
.Q       AIF   (T'&RETPD EQ 'O').R
         DS    0F
&X.RBTU&A DC   X'0023'             KEY TO SPECIFY A RETENTION PERIOD
         DC    XL2'1'
         DC    XL2'2'              MAXIMUM LENGTH IS TWO
&X.RBRET DC    AL2(&RETPD)         AND IS PLACED HERE.
&A       SETA  &A+1
.*<<
.R       AIF   (T'&DUMMY EQ 'O').S
         DS    0F
&X.RBTU&A DC   X'0024'             KEY TO ALLOCATE A DUMMY DATA SET
         DC    XL2'0'
         DC    XL2'0'
         DC    X'0'
&A       SETA  &A+1
.*<<
.S       AIF   (&UNALLOC OR (T'&BLKSIZE EQ 'O')).T
         DS    0F
&X.RBTU&A DC   X'0030'             KEY TO SPECIFY THE BLOCKSIZE
         DC    XL2'1'
         DC    XL2'2'
&X.RBBSZ DC    AL2(&BLKSIZE)
&A       SETA  &A+1
.*<<
.T       AIF   (&UNALLOC OR (T'&FUNC EQ 'O')).U
         DS    0F
         AIF   ('&FUNC' EQ 'I').T2
         MNOTE 8,'DER020E &FUNC invalid for FUNC parameter'
         AGO   .U
.T2      ANOP
&X.RBTU&A DC   X'005A'
         DC    XL2'1'
         DC    XL2'1'
         DC    X'80'
&A       SETA  &A+1
.*<<
.U       AIF   (&UNALLOC OR (T'&LRECL EQ 'O')).V
         DS    0F
&X.RBTU&A DC   X'0042'             KEY TO SPECIFY THE LRECL
         DC    XL2'1'
         DC    XL2'2'
&X.RBLRL DC    AL2(&LRECL)
&A       SETA  &A+1
.*<<
.V       AIF   (T'&RLSE EQ 'O').W
         DS    0F
&X.RBTU&A DC   X'000D'             KEY  TO SPECIFY RELEASE SPACE
         DC    XL2'0'
&A       SETA  &A+1
.*<<
.W       AIF   (&UNALLOC OR (T'&DCB EQ 'O')).X
         DS    0F
&X.RBTU&A DC   X'002C' KEY TO SPECIFY DCB REFERENCE NAME
         DC    XL2'1'
&K       SETA  K'&DCB
         DC    XL2'&K'             LENGTH OF DSN SPECIFIED
&X.RBDCB DC    CL44'&DCB'             DSNAME TO COPY DCB FROM
&A       SETA  &A+1
.*<<
.X       AIF   (T'&SSREQ EQ 'O').Y
         DS    0F
&X.RBTU&A DC   X'005C' KEY TO SPECIFY SUBSYSTEM REQUEST
         DC    XL2'1'
&K       SETA  K'&SSREQ
         DC    XL2'&K'             LENGTH OF SUBSYSTEM NAME SPECIFIED
&X.RBSSR DC    CL8'&SSREQ'           SUBSYSTEM NAME TARGETED
&A       SETA  &A+1
.*<<
.Y       AIF   (&UNALLOC OR (T'&DSORG EQ 'O')).Z
         DS    0F
&X.RBTU&A DC   X'003C' KEY TO DATASET ORGANIZATION REQUEST
         DC    XL2'1'
         DC    XL2'2'              LENGTH OF ORG INDICATOR SPECIFIED
         AIF   ('&DSORG' EQ 'DA').Y1
         AIF   ('&DSORG' EQ 'DAU').Y2
         AIF   ('&DSORG' EQ 'PS').Y3
         AIF   ('&DSORG' EQ 'PSU').Y4
         AIF   ('&DSORG' EQ 'PO').Y5
         AIF   ('&DSORG' EQ 'POU').Y6
         MNOTE 8,'DER020E &DSORG invalid for DSORD parameter'
         AGO   .Z
.Y1      ANOP
&X.RBORG DC    X'20'             DSORG=DA INDICATOR
         AGO   .YY
.Y2      ANOP
&X.RBORG DC    X'21'             DSORG=DAU INDICATOR
         AGO   .YY
.Y3      ANOP
&X.RBORG DC    X'40'             DSORG=PS INDICATOR
         AGO   .YY
.Y4      ANOP
&X.RBORG DC    X'41'             DSORG=PSU INDICATOR
         AGO   .YY
.Y5      ANOP
&X.RBORG DC    X'02'             DSORG=PO INDICATOR
         AGO   .YY
.Y6      ANOP
&X.RBORG DC    X'03'             DSORG=POU INDICATOR
.YY      ANOP
         DC    X'00'
&A       SETA  &A+1
.*<<
.Z       AIF   (&UNALLOC OR (T'&RECFM EQ 'O')).XA
         DS    0F
&X.RBTU&A DC   X'0049' KEY TO RECORD FORMAT REQUEST
         DC    XL2'1'
         DC    XL2'1'              LENGTH OF ORG INDICATOR SPECIFIED
         AIF   ('&RECFM' EQ 'M').Z1
         AIF   ('&RECFM' EQ 'A').Z2
         AIF   ('&RECFM' EQ 'S').Z3
         AIF   ('&RECFM' EQ 'B').Z4
         AIF   ('&RECFM' EQ 'D').Z5
         AIF   ('&RECFM' EQ 'V').Z6
         AIF   ('&RECFM' EQ 'F').Z7
         AIF   ('&RECFM' EQ 'U').Z8
         AIF   ('&RECFM' EQ 'FB').Z9
         AIF   ('&RECFM' EQ 'FBM').Z10
         AIF   ('&RECFM' EQ 'FBA').Z11
         AIF   ('&RECFM' EQ 'VB').Z12
         AIF   ('&RECFM' EQ 'VBM').Z13
         AIF   ('&RECFM' EQ 'VBA').Z14
         MNOTE 8,'DER020E &RECFM invalid for RECFM parameter'
         AGO   .FINAL
.Z1      ANOP
&X.RBRCF DC    X'02'             RECFM=M INDICATOR MACHINE CC
         AGO   .ZZ
.Z2      ANOP
&X.RBRCF DC    X'04'             RECFM=A INDICATOR FOR ASA PRINTER
         AGO   .ZZ
.Z3      ANOP
&X.RBRCF DC    X'08'             RECFM=S INDICATOR
         AGO   .ZZ
.Z4      ANOP
&X.RBRCF DC    X'10'             RECFM=B INDICATOR
         AGO   .ZZ
.Z5      ANOP
&X.RBRCF DC    X'20'             RECFM=D INDICATOR
         AGO   .ZZ
.Z6      ANOP
&X.RBRCF DC    X'40'             RECFM=V INDICATOR
         AGO   .ZZ
.Z7      ANOP
&X.RBRCF DC    X'80'             RECFM=F INDICATOR
         AGO   .ZZ
.Z8      ANOP
&X.RBRCF DC    X'C0'             RECFM=U INDICATOR
         AGO   .ZZ
.Z9      ANOP
&X.RBRCF DC    X'90'             RECFM=FB INDICATOR
         AGO   .ZZ
.Z10     ANOP
&X.RBRCF DC    X'92'             RECFM=FBM INDICATOR
         AGO   .ZZ
.Z11     ANOP
&X.RBRCF DC    X'94'             RECFM=FBA INDICATOR
         AGO   .ZZ
.Z12     ANOP
&X.RBRCF DC    X'50'             RECFM=VB INDICATOR
         AGO   .ZZ
.Z13     ANOP
&X.RBRCF DC    X'52'             RECFM=VBM INDICATOR
         AGO   .ZZ
.Z14     ANOP
&X.RBRCF DC    X'54'             RECFM=VBA INDICATOR
         AGO   .ZZ
.*<<
.ZZ      ANOP
&A       SETA  &A+1
.XA      AIF   (NOT &UNALLOC).FINAL
         AIF   (T'&NOHOLD EQ 'O').XB
         AIF   ('&NOHOLD' NE 'YES').XB
         DS    0F
&X.RBTU&A DC   X'000A' KEY TO RECORD NOHOLD spool
         DC    XL2'0'
&A       SETA  &A+1
.XB      AIF   (T'&CLASS EQ 'O').FINAL
         DS    0F
&X.RBTU&A DC   X'0018' KEY TO RECORD alternate class
         DC    XL2'1'
         DC    XL2'1'              LENGTH OF ORG INDICATOR SPECIFIED
&X.RBCLS DC    CL1'0'
&A       SETA  &A+1
.FINAL   ANOP
.*
&I       SETA  1
&A       SETA  &A-1
         AIF   (&A LT 1).EXIT
&X.RBTU  DS    0D
.LOOP    AIF   (&I EQ &A).END
         DC    A(&X.RBTU&I)
&I       SETA  &I+1
         AGO   .LOOP
.END     DC    X'80'
         DC    AL3(&X.RBTU&I)
         AIF   (NOT &XRB).LEAVE
&DERCTR  SETA  &DERCTR+1
&I       SETA  &DERCTR
&DERVLBL(&I)  SETC  ' '
&DERVOPC(&I)  SETC  'DS'
&DERVDAT(&I)  SETC  '0D'
&I       SETA  &I+1
&DERVLBL(&I)  SETC  '&X.XRB'
&DERVOPC(&I)  SETC  'DC'
&DERVDAT(&I)  SETC  'XL36''00'''
&I       SETA  &I+1
&DERVLBL(&I)  SETC  ' '
&DERVOPC(&I)  SETC  'ORG'
&DERVDAT(&I)  SETC  '&X.XRB'
&I       SETA  &I+1
&DERVLBL(&I)  SETC  ' '
&DERVOPC(&I)  SETC  'DC'
&DERVDAT(&I)  SETC  'CL6''S99RBX'',X''01'''
&I       SETA  &I+1
&DERVLBL(&I)  SETC  ' '
&DERVOPC(&I)  SETC  'ORG'
&DERVDAT(&I)  SETC  ','
&DERCTR  SETA  &I
.LEAVE   AIF   (NOT &RBUF).EXIT
&DERCTR  SETA  &DERCTR+1
&I       SETA  &DERCTR
&DERVLBL(&I)  SETC  ' '
&DERVOPC(&I)  SETC  'DS'
&DERVDAT(&I)  SETC  '0F'
&I       SETA  &I+1
&DERVLBL(&I)  SETC  '&X.RDRBUF'
&DERVOPC(&I)  SETC  'DC'
&DERVDAT(&I)  SETC  'CL&LRECL'' '''
&DERCTR  SETA  &I
.EXIT    ANOP
         MEND
./ ADD NAME=DERTABCC 0100-01324-01324-1756-00110-00110-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERTABCC ¦
.*                    +----------+
.*
.*
.*    Function -
.*           Build equates for printer control characters set
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/25¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERTABCC
         COPY  DERGBLVR
         AIF   (&DERCCTB).END
.*
.*  ASA Code CC
.*  -----------
$ASA_SP0 EQU  C'+'      Suppress space
$ASA_SP1 EQU  C' '      Space 1 line
$ASA_SP2 EQU  C'0'      Space 2 lines
$ASA_SP3 EQU  C'-'      Space 3 lines
$ASA_C01 EQU  C'1'      Skip to channel 1
$ASA_C02 EQU  C'2'      Skip to channel 2
$ASA_C03 EQU  C'3'      Skip to channel 3
$ASA_C04 EQU  C'4'      Skip to channel 4
$ASA_C05 EQU  C'5'      Skip to channel 5
$ASA_C06 EQU  C'6'      Skip to channel 6
$ASA_C07 EQU  C'7'      Skip to channel 7
$ASA_C08 EQU  C'8'      Skip to channel 8
$ASA_C09 EQU  C'9'      Skip to channel 9
$ASA_C10 EQU  C'A'      Skip to channel 10
$ASA_C11 EQU  C'B'      Skip to channel 11
$ASA_C12 EQU  C'C'      Skip to channel 12
.*
.*  Machine Code CC - Print then act
.*  ---------------
$MCC_SP0 EQU  X'01'      Suppress space
$MCC_SP1 EQU  X'09'      Space 1 line
$MCC_SP2 EQU  X'11'      Space 2 lines
$MCC_SP3 EQU  X'19'      Space 3 lines
$MCC_CPM EQU  X'5A'      Change to page mode
$MCC_C01 EQU  X'89'      Skip to channel 1
$MCC_C02 EQU  X'91'      Skip to channel 2
$MCC_C03 EQU  X'99'      Skip to channel 3
$MCC_C04 EQU  X'A1'      Skip to channel 4
$MCC_C05 EQU  X'A9'      Skip to channel 5
$MCC_C06 EQU  X'B1'      Skip to channel 6
$MCC_C07 EQU  X'B9'      Skip to channel 7
$MCC_C08 EQU  X'C1'      Skip to channel 8
$MCC_C09 EQU  X'C9'      Skip to channel 9
$MCC_C10 EQU  X'D1'      Skip to channel 10
$MCC_C11 EQU  X'D9'      Skip to channel 11
$MCC_C12 EQU  X'E1'      Skip to channel 12
.*
.*  Machine Code CC - Act immediate w/o print
.*  ---------------
$MCC_SP1I EQU  X'0B'      Space 1 line
$MCC_SP2I EQU  X'13'      Space 2 lines
$MCC_SP3I EQU  X'1B'      Space 3 lines
$MCC_C01I EQU  X'8B'      Skip to channel 1
$MCC_C02I EQU  X'93'      Skip to channel 2
$MCC_C03I EQU  X'9B'      Skip to channel 3
$MCC_C04I EQU  X'A3'      Skip to channel 4
$MCC_C05I EQU  X'AB'      Skip to channel 5
$MCC_C06I EQU  X'B3'      Skip to channel 6
$MCC_C07I EQU  X'BB'      Skip to channel 7
$MCC_C08I EQU  X'C3'      Skip to channel 8
$MCC_C09I EQU  X'CB'      Skip to channel 9
$MCC_C10I EQU  X'D3'      Skip to channel 10
$MCC_C11I EQU  X'DB'      Skip to channel 11
$MCC_C12I EQU  X'E3'      Skip to channel 12
.*
&DERCCTB SETB  1
.END     ANOP
         MEND
./ ADD NAME=DERTODUF 0100-01324-01324-1756-00074-00074-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERTODUF ¦
.*                    +----------+
.*
.*
.*    Function -
.*          EDIT TOD DATE AND CLOCK IN UNIVERSAL FORMAT
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DERTODUF
         COPY  DERGBLVR
&NAME    XC    &DERWORK.(16),&DERWORK
         TIME  DEC,&DERWORK,LINKAGE=SYSTEM,                            +
               DATETYPE=YYYYMMDD,MF=(E,&DERTMEL)
         L     R1,&DERWORK
         SRL   R1,4
         ST    R1,&DERWORD
         OI    &DERWORD+3,X'0F'
         UNPK  &DERDBWD,&DERWORD
         MVC   &DERTIME.(2),&DERDBWD+2
         MVI   &DERTIME+2,C':'
         MVC   &DERTIME+3(2),&DERDBWD+4
         MVI   &DERTIME+5,C':'
         MVC   &DERTIME+6(2),&DERDBWD+6
         L     R1,&DERWORK+8
         SLL   R1,8
         SRL   R1,4
         ST    R1,&DERWORD
         OI    &DERWORD+3,X'0F'
         UNPK  &DERDBWD,&DERWORD
         MVC   &DERDATE.(2),&DERDBWD+2
         MVI   &DERDATE+2,C'/'
         MVC   &DERDATE+3(2),&DERDBWD+4
         MVI   &DERDATE+5,C'/'
         MVC   &DERDATE+6(2),&DERDBWD+6
.*       LA    R1,&DERDATE
         MEND
./ ADD NAME=DERTODYF 0100-01324-01324-1756-00067-00067-00000-DERU-S
.*
.*
.*                    +----------+
.*    MACRO NAME   -  ¦ DERTODYF ¦
.*                    +----------+
.*
.*    Function -
.*          Edit TOD date and clock in Julian format
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&NAME    DERTODYF
         COPY  DERGBLVR
         XC    &DERWORK.(16),&DERWORK
         TIME  DEC,&DERWORK,LINKAGE=SYSTEM,                            +
               DATETYPE=YYYYDDD,MF=(E,&DERTMEL)
         L     R0,&DERWORK            hhmmsstt
         ST    R0,&DERWORD
         OI    &DERWORD+3,X'0F'
         UNPK  &DERDBWD,&DERWORD
         MVC   &DERYTIM,&DERDBWD
         MVI   &DERYTIM,C'T'
.*
         L     R1,&DERWORK+8
         SLL   R1,4
         ST    R1,&DERWORD
         OI    &DERWORD+3,X'0F'
         UNPK  &DERDBWD,&DERWORD
         MVC   &DERYDAT,&DERDBWD
         MVI   &DERYDAT,C'D'
.*
.*       LA    R1,&DERYDAT
         MEND
./ ADD NAME=DERWSA   0100-01324-01324-1756-00441-00441-00000-DERU-S
*
*
*                     +----------+
*     Module Name  -  ¦ DERWSA   ¦
*                     +----------+
*
*
*     Function -
*               Map of working storage area used by
*               DERXWR and DERWTR modules
*
*     Operating Environment -
*        Type              MVS System Program
*        Min. Auth.        Supervisor state
*        Dsp.unit mode     Task
*        AMODE             24-bit or 31-bit
*        XM                PASN=HASN=SASN
*        ASC mode          Primary
*        Interrupt status  Enabled for I/O and Ext. interrupts
*        Locks             No locks held
*        Control Parm      The SSOB and SSSO control blocks can
*                          reside in storage above 16 megabytes.
*        Recovery          Program should provide an ESTAE-type
*                          recovery environment. See MVS/ESA SP V5
*                          Auth Assembler Services Guide for more info
*                          an ESTAE-type recovery environment.
*
*
*
*
*
*     Syntax -
*
*
*     Operation -
*
*
*     Author -
*          Name     :  Deru Sudibyo
*                      Technical Consultant
*                      Computer Associates
*                      Indonesia Office
*                      Wisma BNI-46 34th floor, BNI-46 City
*                      Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
*          Copyright:  (C)1998 Deru Sudibyo
*
*     Disclaimer -
*         This module is developed as a personal support, and is
*         not a part of CA support matterials.  The purpose is as
*         a temporary solution or even just a sample.  Therefor,
*         further modifications and maintenance are client's
*         responsibilities.
*
*     Modification Log -
*     +--------+------------+--------+---------------------------+
*     ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
*     +--------+------------+--------+---------------------------+
*     ¦98/02/23¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     ¦        ¦            ¦        ¦                           ¦
*     +--------+------------+--------+---------------------------+
*
         MACRO
&LABEL   DERWSA &TYPE=DSECT,&AMODE=31,&RMODE=ANY,&PRINT=NOGEN
         COPY  DERGBLVR
DERWSA   &TYPE
         AIF   ('&TYPE' NE 'CSECT').BEGIN
DERWSA   AMODE &AMODE
DERWSA   RMODE &RMODE
.BEGIN   ANOP
WSA      EQU   *
         DC    CL8'DERWSA'
*
*
*   +-------------------------------+
*   ¦  Save Areas                   ¦
*   +-------------------------------+
*
WSSAVEGR DC    9D'0'              Save area for GR 0-15
WSPARMM  DC    D'0'               Parameter parmlib member name
WSPARM   DC    A(*-*)             Pointer to XWTR parameter list
WSPARMX  DC    A(*-*)             Pointer to XDP parameter list
WSCOMPRM DC    A(WSCOMBUF)        Pointer to command parameter list
WSALEN   DC    AL2(WSASIZE)       Length of this WSA
         DC    XL2'00'            Reserved
WSSVA    DC    A(*-*)             Pointer to XWTR savearea
WSREG14  DC    A(*-*)             Pointer to return
*
*
*   +------------------------------------------+
*   ¦  Service Routine Modules Directory Table ¦
*   +------------------------------------------+
*
WSMODXDP DC    A(*-*,*-*)         Pointer to DERXDP module
WSMODXDS DC    A(*-*,*-*)         Pointer to DERXDS module
WSMODCOM DC    A(*-*,*-*)         Pointer to DERCOM module
WSMODXIO DC    A(*-*,*-*)         Pointer to DERXIO module
WSMODXWR DC    A(*-*,*-*)         Pointer to DERXWR module
WSMODWTR DC    A(*-*,*-*)         Pointer to DERWTR module
WSMODWTB DC    A(*-*,*-*)         Pointer to DERWTB module
WSMODWTX DC    A(*-*,*-*)         Pointer to DERWTX module
WSMODDCB DC    A(*-*,*-*)         Pointer to DERDCB module
WSMODXSF DC    A(*-*,*-*)         Pointer to DERXSF module
WSMODWTG DC    A(*-*,*-*)         Pointer to DERWTG module
WSMODIBM DC    A(*-*,*-*)         Pointer to IEFSD087 module
WSIOBUF  DC    A(*-*,*-*)         Pointer to I/O buffer (and size)
WSIOREC  DC    A(*-*,*-*)         Pointer to record address
WSDESTP  DC    A(*-*,*-*)         Pointer and # of destination
WSDESTP1 DC    A(*-*,*-*)         Hot Pointer and # of destination
WSEOPARM DC    A(*-*)             Pointer to EOD Parmlib
*
*
*   +-------------------------------+
*   ¦  DCB Directory Table          ¦
*   +-------------------------------+
*
WSDCBDIR DS    0F
ADDR_PARMLIB  DC A(*-*)       DCB address of PARMLIB
ADDR_JES2FILE DC A(*-*)       DCB address of JES2FILE
ADDR_LCLDS01  DC A(*-*)       DCB address of LCLDS01
ADDR_LCLDS02  DC A(*-*)       DCB address of LCLDS02
ADDR_INTRDR   DC A(*-*)       DCB address of INTRDR
ADDR_SYSOUT   DC A(*-*)       DCB address of SYSOUT
WSDCBDSZ EQU  *-WSDCBDIR
ADDR_IEFRDER  DC A(*-*)       DCB address of IEFRDER
*
*   +-------------------------------+
*   ¦ Buffer and Record Areas as    ¦
*   ¦ Constructed by BUILDRCD       ¦
*   +-------------------------------+
*
WSRCBUFA DC    A(*-*,*-*)
WSRCAREA DC    A(*-*,*-*)
WSBLKPTR DC    A(*-*)                 Block buffer pointer
WSRECPTR DC    A(*-*)                 Record buffer pointer
*
*   +-------------------------------+
*   ¦ SYNAD and EODAD Save Areas    ¦
*   +-------------------------------+
*
         DC    X'00'
WSISYNA  DC    AL3(*-*)
         DC    X'00'
WSIEODA  DC    AL3(*-*)
WSISYNAX DC    A(*-*)
WSIEODAX DC    A(*-*)
         DC    X'00'
WSOSYNA  DC    AL3(*-*)
         DC    X'00'
WSOEODA  DC    AL3(*-*)
WSOSYNAX DC    A(*-*)
WSOEODAX DC    A(*-*)
*
*
*   +-------------------------------+
*   ¦  ECB and ECB List             ¦
*   +-------------------------------+
*
WSECB    DC    F'0'               ECB
WSREPLY  DC    F'0'               Reply buffer
WSCOMM   DC    F'0'               Command buffer address
WSRCODE  DC    F'0'               RC save area
WSECBLST DS    0F
WSECBJES DC    A(*-*)             Address of JES ECB
WSECBCOM DC    A(*-*)             Address of command ECB
*
*
*   +-------------------------------+
*   ¦  SSREQ Input Variables        ¦
*   +-------------------------------+
*
WSSSOBP  DC    A(*-*)             Pointer to SSOB parameter list
WSSSOB   DC    A(*-*,*-*)         Pointer to SSOB parameter area
WSSSOB1  DC    A(*-*,*-*)         Copy pointer to SSOB parameter area
WSSSSO   DC    A(*-*,*-*)         Copy pointer to SSSO
WSSAVEQ  DC    F'0'
WSCLASSL DC    CL8' '             Class list for sysout selection
WSLCLASS DC    CL8' '             Class list for sysout selection
WSFORM   DC    CL8' '             Form for xfer target file
WSTABLE  DC    CL8' '             Form for xfer target file
         ORG   WSLCLASS
WSQCLASS DC    CL1'9'             Class list for sysout selection
         ORG   ,
*
*   +-------------------------------+
*   ¦  Parameter Indicator Flags    ¦
*   +-------------------------------+
*
WSPFLAGS DC    X'00'              Parameter indicators
WSPFCLAS EQU   X'80'               - CLASS indicated
WSPFOVER EQU   X'40'               - Override default parm indicated
WSPFFILE EQU   X'20'               - Parmlib member indicated
WSPFOPEN EQU   X'10'               - Parmlib successfully opened
WSPFCMND EQU   X'08'               - Parm entered from CMD indicated
WSPFSSRQ EQU   X'04'               - Parm entered related to SSREQ
WSPFTABL EQU   X'02'               - Parm table indicated
WSPFFORC EQU   X'01'               - Parm force to normal form used
*
*
*   +-------------------------------+
*   ¦  PC File Form Indicator Flags ¦
*   +-------------------------------+
*
WSFFLAGS DC    X'00'              FORM flag indicators
WSFFDISP EQU   C'D'                - FORM = DISPATCH
WSFFWIND EQU   C'W'                - FORM = WINDOWS
WSFFS390 EQU   C'S'                - FORM = S/390
*
*
*   +-------------------------------+
*   ¦ Operation Indicator Flags     ¦
*   +-------------------------------+
*
WSOFLAGS DC    X'00'              Operation indicators
WSOFKEEP EQU   X'80'               - KEEP sysout at close
WSOFTRAC EQU   X'40'               - TRACE XDI logic flow
WSOFXCOM EQU   X'20'               - XCOM internal indicated
WSOFFORC EQU   X'10'               - FORCE to use simple lrecl
WSOFCOMM EQU   X'08'               - Command entered indicated
WSOFXKEP EQU   X'04'               - Xcomjob KEEP indicated
WSOFHOLD EQU   X'02'               - Process HELD sysout indicated
WSOFSSRQ EQU   X'01'               - SSREQ has been processed
*
*
*   +-------------------------------+
*   ¦  Override Indicators Flags    ¦
*   +-------------------------------+
*
WSOVFLGS DC    X'00'              Override indicators (use WSOFxxxx)
*
WSOVFORM DC    X'00'              Override form (use WSFFxxxx)
*
*
*   +-------------------------------+
*   ¦  Error Indicator Flags        ¦
*   +-------------------------------+
*
WSEFLAGS DC    X'00'              Error indicator
WSEFSSRQ EQU   X'80'                SSREQ error
WSEFNODS EQU   X'40'                Dest error (unexpected DEST)
WSEFPURG EQU   X'20'                Sysout purge error
WSEFIOER EQU   X'04'                I/O error
WSEFSSOB EQU   X'02'                SSOB error
WSEFERRP EQU   X'01'                Error occured during main process
*
*
*   +-------------------------------+
*   ¦  Process Switch Flags         ¦
*   +-------------------------------+
*
WSSFLAGS DC    X'00'              Switch indicator indicator
WSSFSFIL EQU   X'80'                Send file >< spool
WSSFWAIT EQU   X'40'                Wait ECB
WSSFXIBM EQU   X'20'                IBM's external writer intercepted
WSSFINIT EQU   X'10'                Initialization switch
WSSFSSEC EQU   X'08'                Subsequent call
WSSFAJES EQU   X'04'                JES2FILE allocated
WSSFAFFL EQU   X'02'                LCLDS01 allocated
WSSFSSOB EQU   X'01'                Original SSOB captured
WSSFOJOB EQU   WSSFSSOB             Continue retrieve the same job
WSSFRNEW EQU   WSSFXIBM             SSOB has been refreshed
*
WSHDRSIZ EQU   *-WSA
*
*
*   +--------------------------------+
*   ¦  System Command Parameter List ¦
*   +--------------------------------+
*
WSCMDPRM DC    F'0'               REG 0 FOR SVC 34
         DC    A(WSSVCCIB)        REG 1 FOR SVC 34
WSSVCCIB DC    AL2(118)           MAXIMUM LENGHT OF COMMAND
         DC    H'0'               SVC 34 PADDING
WSCMDBUF DC    CL120' '           COMMAND BUFFER
*
*
*   +-------------------------------+
*   ¦  Working Variables            ¦
*   +-------------------------------+
*
WSLRECL  DC    H'0'               Lrecl
WSBYTE   DC    X'00'              Byte for work
WSJNUM   DC    CL6'000000'        Execution counter
WSCOUNT  DC    PL6'0'             Execution counter in decimal packed
WSPGNUM  DC    PL5'0'
WSPGTOT  DC    PL7'0'
WSFFDSN  DC    CL44' '            Flat file
WSBUDSN  DC    CL44' '            Copy DSN
WSSTPLIB DC    CL44'CAI.XCOM.CAILIB'
WSCAILIB DC    CL44'CAI.XCOM.CAILIB'
WSGLBLIB DC    CL44'CAI.XCOM.CAILIB'
WSRSTLIB DC    CL44'CAI.XCOM.CAILIB'
WSCTLLIB DC    CL44'CAI.XCOM.CAILIB'
WSBUWRTR DC    CL8' '             Writer name copy
WSCTIME  DC    CL16' '
WSCDATE  DC    CL8' '
WSTIME   DC    PL8'0'           TOD in dec format: HHMMSSthmiju0000
WSDATE   DC    PL4'0'           Date in dec format: YYYYMMDD
         DS    CL4
WSXCJPRM DC    CL56'(''ACBNAME=XCOMAPPL,TYPE=SCHEDULE'')'
WSPCDRV  DC    CL8'HDD of'
         ORG   WSPCDRV+7
WSPCHDD  DC    CL1'F'
         ORG   ,
WSOVHDD  DC    CL1'C'
WSPCDRVE DC    CL1'F'
*
*   +-------------------------------+
*   ¦  Copy of SSSO Informations    ¦
*   +-------------------------------+
*
WSSOMLRL DC    H'0'
WSSOJOBN DC    CL8' '
WSSOJOBI DC    CL8' '
WSSODSN  DC    CL44' '
WSSOWRTR DC    CL8' '
WSSODEST DC    CL8' '
WSSOGRNM DC    CL26' '          Output group name
WSSOFORM DC    CL4' '
WSSOCLAS DC    C' '
*
*   +-------------------------------+
*   ¦  Output CC Format Indicator   ¦
*   +-------------------------------+
*
WSCC     DC    X'00'            Carriage Control indicator
WSCC_MCC EQU   C'M'               - Machine CC
WSCC_ASA EQU   C'A'               - ASA CC
WSDWORD  DC    D'0'               DoubleWord for general purposes
WSWORD   DC    F'0'               Word for general purposes
*
*
*   +-------------------------------+
*   ¦  Message Directory Table      ¦
*   +-------------------------------+
*
         DS    0D
WSCARD   DC    CL80' '
WSMSGDIR DS    0F
WSMSG100 DC    A(*-*)
WSMSG101 DC    A(*-*)
WSMSG102 DC    A(*-*)
WSMSG103 DC    A(*-*)
WSMSG104 DC    A(*-*)
WSMSG105 DC    A(*-*)
WSMSG106 DC    A(*-*)
WSMSG107 DC    A(*-*)
WSMSG108 DC    A(*-*)
WSMSG109 DC    A(*-*)
WSMSG110 DC    A(*-*)
WSMSG111 DC    A(*-*)
WSMSG112 DC    A(*-*)
WSMSG113 DC    A(*-*)
WSMSG114 DC    A(*-*)
WSMSG115 DC    A(*-*)
WSMSG116 DC    A(*-*)
WSMSG117 DC    A(*-*)
WSMSG118 DC    A(*-*)
WSMSG119 DC    A(*-*)
WSMSG120 DC    A(*-*)
WSMSG121 DC    A(*-*)
WSMSG122 DC    A(*-*)
WSMSG123 DC    A(*-*)
WSMSG124 DC    A(*-*)
WSMSG125 DC    A(*-*)
WSMSG126 DC    A(*-*)
WSMSG127 DC    A(*-*)
WSMSG128 DC    A(*-*)
WSMSG129 DC    A(*-*)
WSMSG130 DC    A(*-*)
WSMSG131 DC    A(*-*)
WSMSG132 DC    A(*-*)
WSMSG133 DC    A(*-*)
WSMSG134 DC    A(*-*)
WSMSG135 DC    A(*-*)
WSMSG136 DC    A(*-*)
WSMSG137 DC    A(*-*)
WSMSG138 DC    A(*-*)
WSMSG139 DC    A(*-*)
WSMSG140 DC    A(*-*)
WSMSG141 DC    A(*-*)
WSMSG142 DC    A(*-*)
WSMSG143 DC    A(*-*)
WSMSG144 DC    A(*-*)
WSMSG145 DC    A(*-*)
WSMSG146 DC    A(*-*)
WSMSG147 DC    A(*-*)
WSMSG148 DC    A(*-*)
WSMSG149 DC    A(*-*)
WSMSG150 DC    A(*-*)
WSMSG151 DC    A(*-*)
WSMSG152 DC    A(*-*)
WSMSG153 DC    A(*-*)
WSMSG154 DC    A(*-*)
WSMSG155 DC    A(*-*)
WSMSG156 DC    A(*-*)
WSMSG157 DC    A(*-*)
WSMSG158 DC    A(*-*)
WSMSG159 DC    A(*-*)
WSMSG160 DC    A(*-*)
WSMSG161 DC    A(*-*)
WSMSG162 DC    A(*-*)
WSMSG163 DC    A(*-*)
WSMSG164 DC    A(*-*)
WSMSG165 DC    A(*-*)
WSMSG166 DC    A(*-*)
WSMSG167 DC    A(*-*)
WSMSG168 DC    A(*-*)
WSMSG169 DC    A(*-*)
WSMSG170 DC    A(*-*)
WSMSG171 DC    A(*-*)
WSMSG172 DC    A(*-*)
WSMSG173 DC    A(*-*)
WSMSG174 DC    A(*-*)
WSMSG175 DC    A(*-*)
WSMSG176 DC    A(*-*)
WSMSG177 DC    A(*-*)
WSMSG178 DC    A(*-*)
WSMSG179 DC    A(*-*)
WSMSG180 DC    A(*-*)
WSMSG181 DC    A(*-*)
WSMSG182 DC    A(*-*)
WSMSG183 DC    A(*-*)
WSMSG184 DC    A(*-*)
WSMSG185 DC    A(*-*)
WSMSG186 DC    A(*-*)
WSMSG187 DC    A(*-*)
WSMSG188 DC    A(*-*)
WSMSGDSZ EQU   *-WSMSGDIR
WSWORK   DC    CL256' '
WSCOMBUF DC    CL256' '
WSASIZE  EQU   *-WSA
         EJECT ,
         AIF   ('&TYPE' NE 'CSECT').EXIT
         END   DERWSA
.EXIT    ANOP
         MEND
./ ADD NAME=DERWTX   0100-01324-01324-1756-00138-00138-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  ¦ DERWTX   ¦
.*                    +----------+
.*
.*
.*    Function -
.*             Provide skeleton of common module extension
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    ¦ Date   ¦ Engineer   ¦ V.R.L. ¦ Description               ¦
.*    +--------+------------+--------+---------------------------+
.*    ¦98/02/12¦ Deru S.    ¦ 1.0.0. ¦ First development         ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    ¦        ¦            ¦        ¦                           ¦
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERWTX &TYPE=CSECT,&AMODE=31,&RMODE=ANY,&PRINT=NOGEN
         COPY  DERGBLVR
DERWTX   &TYPE
         AIF   ('&TYPE' NE 'CSECT').BEGIN
DERWTX   AMODE &AMODE
DERWTX   RMODE &RMODE
.BEGIN   ANOP
         DC    CL8'DERWTX'
         @VGLOBAL
         EJECT ,
ALSYSOUT @S99PARM ALLOC,                  Define SYSOUT alloc parm     +
               TYPE=DATA,                 Map type is memory data      +
               SSREQ=JES2,                Request JES2 dataset         +
               EXTRB=YES,                 Request S99RBX               +
               PREFIX=A,                  Use prefix A --> ARBxxxx     +
               DISP=(OLD,DELETE),         Use disp. delete             +
               DD=JES2FILE,               and DD name is JES2FILE      +
               DSN='SYSOUT.DATA.SET'      DSN is just to init field
UNSYSOUT @S99PARM DEALLOC,                Define SYSOUT dealloc parm   +
               TYPE=DATA,                 Map type is memory data      +
               PREFIX=D,                  Use prefix D --> DRBxxx      +
               DISP=DELETE,               Override disposition DELETE  +
               EXTRB=YES,                 Request S99RBX               +
               DD=JES2FILE                and DD name is JES2FILE
ALFLATDS @S99PARM ALLOC,                  Define Flat file alloc parm  +
               TYPE=DATA,                 Map type is memory data      +
               PREFIX=F,                  Use prefix F --> FRBxxxx     +
               EXTRB=YES,                 Request S99RBX               +
               DD=LCLDS01,                DD name is LCLDS01           +
               DSN='CADS.XCOM.SAMPLE.DATA',  Predefine DSN             +
               DSORG=PS,RECFM=VB,            DCB:                      +
               BLKSIZE=6233,LRECL=150,                                 +
               SPACE=(CYL,(50,5),RLSE),      Specify space for new     +
               UNIT=3390,                     dataset in this unit of  +
               DISP=(NEW,CATLG),          Use this disposition and     +
               RECBUF=YES,                Generate record buffer       +
               FREE=CLOSE,                Deallocate at close          +
               CDISP=KEEP                 delete dataset if job abend
UNFLATDS @S99PARM FREE,                   Define Flatfile dealloc parm +
               TYPE=DATA,                 Map type is memory data      +
               EXTRB=YES,                 Request S99RBX               +
               PREFIX=U,                  Use prefix U --> URBxxxx     +
               DD=LCLDS01                 DD name is LCLDS01
PHEADER  @EDITHDR DATA,                                                +
               LRECL=128,                                              +
               PREFIX=PH
         SPACE ,
         PRINT &PRINT
         DC    8D'0'
LMODESET MODESET MF=L
LMODSUPV MODESET MODE=SUP,MF=L
LMODSUPZ MODESET MODE=SUP,KEY=ZERO,MF=L
LMODPROB MODESET MODE=PROB,MF=L
LMODPRON MODESET MODE=PROB,KEY=NZERO,MF=L
LMODZERO MODESET KEY=ZERO,MF=L
LMODNZER MODESET KEY=NZERO,MF=L
LEXTRACT EXTRACT WTXEND,MF=L
LWTO     WTO   TEXT=,MF=L
LWTOR    WTOR  TEXT=WTXEND,MF=L
         DS    0D
LOPEN_PARMLIB  OPEN  (,),MODE=31,MF=L
LOPEN_INTRDR   OPEN  (,),MODE=31,MF=L
LOPEN_JES2FILE OPEN  (,),MODE=31,MF=L TYPE=J
LOPEN_LCLDS01  OPEN  (,),MODE=31,MF=L
LOPEN          OPEN  (,),MODE=31,MF=L
LCLOSE_JES2FILE CLOSE (,),MODE=31,MF=L
LCLOSE_LCLDS01 CLOSE (,),MODE=31,MF=L
LCLOSE         CLOSE (,),MODE=31,MF=L
LREAD    READ  XDIDECB,SF,MF=L
LBLDRCD  BUILDRCD ,,,,0,MF=L
LMGCRE   MGCRE MF=L
         DS    0D
XCJCL    @XCOMJOB DATA,                                                +
               CAILIB=CAI.CAILIB,                                      +
               STEPLIB=CAI.XCOM.CAILIB,                                +
               GLOBLIB=CAI.XCOM.NONQUEUE.GLOBAL,                       +
               RESTLIB=CAI.XCOM.NONQUEUE.RESTART,                      +
               CNTLLIB=CAI.XCOM.PARMLIB,                               +
               DISP=(OLD,KEEP),                                        +
               CLASS=T,                                                +
               MCLASS=T,                                               +
               MLEVEL=(1,1),                                           +
               PREFIX=XC
         PRINT &PRINT
         @VDATA
WTXEND   EQU   *
         EJECT ,
         IEFZB4D2
         AIF   ('&TYPE' NE 'CSECT').EXIT
         END   DERWTX
.EXIT    ANOP
         MEND
./ ADD NAME=DERXCJOB 0100-01324-01324-1756-00174-00174-00000-DERU-S
.*
.*
.*                    +----------+
.*    Macro Name   -  | DERXCJOB |
.*                    +----------+
.*
.*
.*    Function - XCOM batch job
.*
.*
.*    Syntax -
.*
.*
.*    Operation -
.*
.*
.*    Author -
.*         Name     :  Deru Sudibyo
.*                     Technical Consultant
.*                     Computer Associates
.*                     Indonesia Office
.*                     Wisma BNI-46 34th floor, BNI-46 City
.*                     Jl. Jend. Sudirman, Kav 1, Jakarta Pusat
.*         Copyright:  (C)1998 Deru Sudibyo
.*
.*    Disclaimer -
.*        This macro is developed as a personal support, and is
.*        not a part of CA support matterials.  The purpose is as
.*        a temporary solution or even just a sample.  Therefor,
.*        further modifications and maintenance are client's
.*        responsibilities.
.*
.*    Modification Log -
.*    +--------+------------+--------+---------------------------+
.*    | Date   | Engineer   | V.R.L. | Description               |
.*    +--------+------------+--------+---------------------------+
.*    |98/02/16| Deru S.    | 1.0.0. | First development         |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    |        |            |        |                           |
.*    +--------+------------+--------+---------------------------+
.*
         MACRO
&LABEL   DERXCJOB &TYPE=DSECT,&PREFIX=XC,&DISP=(OLD,DELETE),&CLASS=A,  +
               &MCLASS=X,&MLEVEL=(0,0),                                +
               &RCPID=,&RPTNAME=,&PCDRIVE=F,                           +
               &STEPLIB=CAI.XCOM.R30.CAILIB,                           +
               &CAILIB=CAI.CAILIB,                                     +
               &CNTLLIB=CAI.XCOM.R30.DESTLIB,                          +
               &GLOBLIB=CAI.XCOM.R30.NONQUEUE.GLOBAL,                  +
               &RESTLIB=CAI.XCOM.R30.NONQUEUE.RESTART
         COPY  DERGBLVR
         LCLC  &C,&MC,&M1,&M2,&P,&Q
&P       SETC  '&PREFIX'
&Q       SETC  ''''
&C       SETC  '&CLASS'
&MC      SETC  '&MCLASS'
&M1      SETC  '&MLEVEL(1)'
&M2      SETC  '&MLEVEL(2)'
         AIF   ('&TYPE' EQ 'DSECT').DSECT
         AIF   ('&TYPE' EQ 'CSECT').CSECT
         AIF   ('&TYPE' EQ 'COM').COM
         AIF   ('&TYPE' EQ 'DATA').DATA
         MNOTE 8,'DER001E Invalid TYPE.  Use DSECT, CSECT, COM or DATA'
         MEXIT
.DSECT   ANOP
&P.JOB   DSECT
         AGO   .BEGIN
.CSECT   ANOP
&P.JOB   CSECT
         AGO   .BEGIN
.COM     ANOP
&P.JOB   COM
         AGO   .BEGIN
.DATA    ANOP
&P.JOB   DS    0D
         AGO   .BEGIN
.BEGIN   ANOP
&LABEL   DS    0D
&P.J1    DC    CL80'//XCKCxnnn JOB (XC9612),''TRANSFER xxxxxxxx   '','
         DC    CL80'//    CLASS=&C,MSGCLASS=&MC,MSGLEVEL=(&M1,&M2)'
&P.J2    DC    CL80'//XC123456 EXEC PGM=XCOMJOB,TIME=1440,'
&P.J2A   DC    CL80'//    PARM='
         DC    CL80'//STEPLIB  DD DISP=SHR,'
&P.J3    DC    CL80'//         DSN=&STEPLIB'
         DC    CL80'//         DD DISP=SHR,'
&P.J4    DC    CL80'//         DSN=&CAILIB'
&P.J5    DC    CL80'//LCLDS01  DD DISP=(OLD,DELETE),'
&P.J6    DC    CL80'//    DSN=CADS.XCOM.KCxnnn.Dyyyyddd.Thhmmss.Rptid'
*                   ----+----1----+----2----+----3----+----4----+----5-
*              ---+----6----+----7-X--+----8
         DC    CL80'//SYSPRINT DD SYSOUT=(&MC,XDI$JOB)'
         DC    CL80'//SYSTERM  DD SYSOUT=*'
         DC    CL80'//XCOMCNTL DD DISP=SHR,'
&P.J7    DC    CL80'//         DSN=&CNTLLIB'
         DC    CL80'//XCOMGLOB DD DISP=SHR,'
&P.J8    DC    CL80'//         DSN=&GLOBLIB'
         DC    CL80'//XCOMREST DD DISP=SHR,'
&P.J9    DC    CL80'//         DSN=&RESTLIB'
         DC    CL80'//SYSIN01  DD *'
&P.PARM  DC    CL80'TYPE=SEND '
         DC    CL80'FILETYPE=FILE '
&P.J10   DC    CL80'GROUP=KCxnnn '
&P.J11   DC    CL80'LFILE=CADS.XCOM.KCxnnn.Dyyyyddd.Thhmmss.Rptid'
&P.J12   DC    CL80'FILE=C:\Dispatch\KCxnnn\Rptid.VXC '
&P.PARMV EQU   *
         DC    CL80'DROPSESS=YES '
         DC    CL80'CODE=ASCII '
         DC    CL80'TRUNCATE=NO '
         DC    CL80'COMPRESS=YES   '
         DC    CL80'PACK=CRLF '
         DC    CL80'CKPT=100 '
         DC    CL80'RNOTIFY=LOG '
         DC    CL80'FILEOPT=CREATE '
         DC    70CL80'*'
&P.PARML EQU   *-&P.PARM
         DC    CL80'/*'
         DC    CL80'/*EOF'
&P.TIME  DC    D'0'                P'HHMMSSnn nnnn0000'
&P.DATE  DC    F'0'                P'0yyyyddd'
&P.ZERO  DC    F'0'
&P.JEND  EQU   *
&P.JSIZE EQU   *-&P.JOB
&P.JCARDS EQU   &P.JSIZE/80          Number of cards
         ORG   &P.J1+4
&P.JNAME DC    CL6' '              Job name
         ORG   &P.J1+34
&P.JPRGN DC    CL8' '              Report name in programmer name
         ORG   &P.J2+4
&P.JNUM  DC    CL6' '              Jobid number
         ORG   &P.J2A+11
&P.JPARM DC    CL56'''ACBNAME=XCOMAPPL '' ' Job PARM
         ORG   &P.J2A+20
&P.JACB  DC    CL8'XCOMAPPL'             ACBname
         ORG   &P.J3+15
&P.JSLIB DC    CL44'&STEPLIB'     Steplib dataset name
         ORG   &P.J4+15
&P.JSLIB1 DC   CL44'&CAILIB'      Steplib concatenated 1 dataset name
         ORG   &P.J5+19
&P.JDISP DC   CL16'&DISP,'         Disposition
         ORG   &P.J6+10
&P.JDSN  DC    CL44' '
         ORG   &P.J6+20
&P.JDSQK DC    CL6' '
         DC    C'.D'
&P.JDSQD DC    CL7' '
         DC    C'.T'
&P.JDSQT DC    CL6' '
         DC    C'.'
&P.JDSQR DC    CL8' '
         ORG   &P.J7+15
&P.JXCNTL DC   CL44'&CNTLLIB'     XCOMCNTL dataset name
         ORG   &P.J8+15
&P.JXGLOB DC   CL44'&GLOBLIB'     XCOMGLOB dataset name
         ORG   &P.J9+15
&P.JXREST DC   CL44'&RESTLIB'     XCOMREST dataset name
         ORG   &P.J10
&P.GROUP DC    CL80'GROUP='
         ORG   &P.J10+6
&P.JDEST DC    CL6' '
         ORG   &P.J11+6
&P.JLFILE DC    CL44' '
         ORG   &P.J12+5
&P.JDRIVE DC    CL1'&PCDRIVE'
         DC    C':\Dispatch\'
&P.JRECID DC    C'KCxnnn'
         DC    C'\'
&P.JRNAME DC    CL14' '
         ORG   ,
.*       ORG   &P.JEND
         MEND
